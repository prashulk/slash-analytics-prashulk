[0m19:34:11.291308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a38980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104877b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104877c50>]}


============================== 19:34:11.311592 | 3af596c2-d370-4869-9e81-f0dc54d875f0 ==============================
[0m19:34:11.311592 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:34:11.311911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:34:11.343113 [info ] [MainThread]: dbt version: 1.9.2
[0m19:34:11.343330 [info ] [MainThread]: python version: 3.13.2
[0m19:34:11.343468 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m19:34:11.343595 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m19:34:11.343725 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m19:34:11.343842 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m19:34:11.343960 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m19:34:11.384094 [info ] [MainThread]: Configuration:
[0m19:34:11.384335 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m19:34:11.384574 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:34:11.384728 [info ] [MainThread]: Required dependencies:
[0m19:34:11.384939 [debug] [MainThread]: Executing "git --help"
[0m19:34:11.400342 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:34:11.400816 [debug] [MainThread]: STDERR: "b''"
[0m19:34:11.400974 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:34:11.401152 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:34:11.401393 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:34:11.401547 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/prashulkumar/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m19:34:11.402033 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.18625042, "process_in_blocks": "0", "process_kernel_time": 0.131015, "process_mem_max_rss": "119504896", "process_out_blocks": "0", "process_user_time": 0.598643}
[0m19:34:11.402270 [debug] [MainThread]: Command `dbt debug` failed at 19:34:11.402221 after 0.19 seconds
[0m19:34:11.402526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d68770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049828d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2b350>]}
[0m19:34:11.402747 [debug] [MainThread]: Flushing usage events
[0m19:34:11.641959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:34.840285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876fc50>]}


============================== 19:39:34.842852 | fa48b119-607e-4c0b-8f9a-d0e3a7fef74b ==============================
[0m19:39:34.842852 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:39:34.843147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '.', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'send_anonymous_usage_stats': 'True'}
[0m19:39:34.844594 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'slash_analytics_take_home'
[0m19:39:34.844899 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.039528124, "process_in_blocks": "0", "process_kernel_time": 0.10973, "process_mem_max_rss": "94814208", "process_out_blocks": "0", "process_user_time": 0.507337}
[0m19:39:34.845105 [debug] [MainThread]: Command `dbt seed` failed at 19:39:34.845064 after 0.04 seconds
[0m19:39:34.845266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108789480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c3ac0>]}
[0m19:39:34.845421 [debug] [MainThread]: Flushing usage events
[0m19:39:35.073032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:06.774972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11944c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af47b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af47c50>]}


============================== 19:40:06.777640 | f67825eb-b1ba-4e9d-8018-b9899298a530 ==============================
[0m19:40:06.777640 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:40:06.777951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:40:06.786337 [info ] [MainThread]: dbt version: 1.9.2
[0m19:40:06.786531 [info ] [MainThread]: python version: 3.13.2
[0m19:40:06.786666 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m19:40:06.786796 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m19:40:06.786925 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m19:40:06.787039 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m19:40:06.787153 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m19:40:06.829028 [info ] [MainThread]: Configuration:
[0m19:40:06.829277 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m19:40:06.829431 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:40:06.829565 [info ] [MainThread]: Required dependencies:
[0m19:40:06.829766 [debug] [MainThread]: Executing "git --help"
[0m19:40:06.844199 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:40:06.844649 [debug] [MainThread]: STDERR: "b''"
[0m19:40:06.844814 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:40:06.844972 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:40:06.845112 [info ] [MainThread]: [31m1 check failed:[0m
[0m19:40:06.845232 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/prashulkumar/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m19:40:06.845673 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.10708509, "process_in_blocks": "0", "process_kernel_time": 0.113099, "process_mem_max_rss": "98484224", "process_out_blocks": "0", "process_user_time": 0.573695}
[0m19:40:06.845893 [debug] [MainThread]: Command `dbt debug` failed at 19:40:06.845848 after 0.11 seconds
[0m19:40:06.846138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119874770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1a2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afd7790>]}
[0m19:40:06.846335 [debug] [MainThread]: Flushing usage events
[0m19:40:06.990866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:43:56.756855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d84980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbfc50>]}


============================== 19:43:56.759625 | a70bf417-4d94-431c-abcb-138146cd7626 ==============================
[0m19:43:56.759625 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:43:56.759947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:43:56.768220 [info ] [MainThread]: dbt version: 1.9.2
[0m19:43:56.768431 [info ] [MainThread]: python version: 3.13.2
[0m19:43:56.768600 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m19:43:56.768729 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m19:43:57.979892 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m19:43:57.980136 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m19:43:57.980293 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m19:43:57.982133 [info ] [MainThread]: adapter type: duckdb
[0m19:43:57.982308 [info ] [MainThread]: adapter version: 1.9.1
[0m19:43:58.021517 [info ] [MainThread]: Configuration:
[0m19:43:58.021742 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:43:58.021900 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:43:58.022041 [info ] [MainThread]: Required dependencies:
[0m19:43:58.022231 [debug] [MainThread]: Executing "git --help"
[0m19:43:58.028284 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:43:58.028746 [debug] [MainThread]: STDERR: "b''"
[0m19:43:58.028906 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:43:58.029068 [info ] [MainThread]: Connection:
[0m19:43:58.029231 [info ] [MainThread]:   database: dev
[0m19:43:58.029365 [info ] [MainThread]:   schema: main
[0m19:43:58.029493 [info ] [MainThread]:   path: dev.duckdb
[0m19:43:58.029620 [info ] [MainThread]:   config_options: None
[0m19:43:58.029743 [info ] [MainThread]:   extensions: None
[0m19:43:58.029870 [info ] [MainThread]:   settings: {}
[0m19:43:58.029993 [info ] [MainThread]:   external_root: .
[0m19:43:58.030111 [info ] [MainThread]:   use_credential_provider: None
[0m19:43:58.030238 [info ] [MainThread]:   attach: None
[0m19:43:58.030371 [info ] [MainThread]:   filesystems: None
[0m19:43:58.030487 [info ] [MainThread]:   remote: None
[0m19:43:58.030604 [info ] [MainThread]:   plugins: None
[0m19:43:58.030726 [info ] [MainThread]:   disable_transactions: False
[0m19:43:58.031020 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:43:58.076956 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m19:43:58.123091 [debug] [MainThread]: Using duckdb connection "debug"
[0m19:43:58.123279 [debug] [MainThread]: On debug: select 1 as id
[0m19:43:58.123410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:43:58.129530 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m19:43:58.130007 [debug] [MainThread]: On debug: Close
[0m19:43:58.130803 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:43:58.131003 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:43:58.131346 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4109138, "process_in_blocks": "0", "process_kernel_time": 0.171883, "process_mem_max_rss": "125665280", "process_out_blocks": "0", "process_user_time": 0.668047}
[0m19:43:58.131551 [debug] [MainThread]: Command `dbt debug` succeeded at 19:43:58.131503 after 1.41 seconds
[0m19:43:58.131705 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:43:58.131863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e4fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4f9b0>]}
[0m19:43:58.132054 [debug] [MainThread]: Flushing usage events
[0m19:43:58.375775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:45:37.064310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105704980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106543b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106543c50>]}


============================== 19:45:37.067073 | efe45745-dc2f-4dad-9cba-033d3b3dbb3f ==============================
[0m19:45:37.067073 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:45:37.067377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m19:45:37.226858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067548a0>]}
[0m19:45:37.249509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106639bf0>]}
[0m19:45:37.250971 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:45:37.305432 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:45:37.305858 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:45:37.306047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106607150>]}
[0m19:45:37.842407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7a70>]}
[0m19:45:37.875454 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:45:37.876696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:45:37.899687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106663850>]}
[0m19:45:37.899908 [info ] [MainThread]: Found 2 models, 3 seeds, 4 data tests, 424 macros
[0m19:45:37.900066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106981640>]}
[0m19:45:37.900879 [info ] [MainThread]: 
[0m19:45:37.901049 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:45:37.901173 [info ] [MainThread]: 
[0m19:45:37.901375 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:45:37.903274 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:45:37.937699 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:45:37.937894 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:45:37.938022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:37.949190 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m19:45:37.950034 [debug] [ThreadPool]: On list_dev: Close
[0m19:45:37.951312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:45:37.951550 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:45:37.954257 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:45:37.954401 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:45:37.954517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:37.957695 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:45:37.958294 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:45:37.958421 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:45:37.958601 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:45:37.958717 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:45:37.958835 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:45:37.959654 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:45:37.960034 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:45:37.960166 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:45:37.960276 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:45:37.960449 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:45:37.960568 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:45:37.961749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m19:45:37.964219 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:45:37.964353 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:45:37.964461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:37.967207 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:45:37.967352 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:45:37.967484 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:45:37.983269 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m19:45:37.983797 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:45:37.984469 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:45:37.984618 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:45:37.985756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2d9d0>]}
[0m19:45:37.985963 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:37.986084 [debug] [MainThread]: On master: BEGIN
[0m19:45:37.986189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:37.988861 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:45:37.989008 [debug] [MainThread]: On master: COMMIT
[0m19:45:37.989132 [debug] [MainThread]: Using duckdb connection "master"
[0m19:45:37.989246 [debug] [MainThread]: On master: COMMIT
[0m19:45:37.989408 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:45:37.989525 [debug] [MainThread]: On master: Close
[0m19:45:37.990576 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.card_transactions
[0m19:45:37.990756 [debug] [Thread-1 (]: Began running node seed.slash_analytics_take_home.card_events
[0m19:45:37.990972 [info ] [Thread-2 (]: 2 of 3 START seed file main.card_transactions .................................. [RUN]
[0m19:45:37.991219 [info ] [Thread-1 (]: 1 of 3 START seed file main.card_events ........................................ [RUN]
[0m19:45:37.991475 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.slash_analytics_take_home.card_transactions'
[0m19:45:37.991660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.slash_analytics_take_home.card_events)
[0m19:45:37.991820 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.card_transactions
[0m19:45:37.991966 [debug] [Thread-1 (]: Began compiling node seed.slash_analytics_take_home.card_events
[0m19:45:37.992110 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.card_transactions
[0m19:45:37.992249 [debug] [Thread-1 (]: Began executing node seed.slash_analytics_take_home.card_events
[0m19:46:03.526833 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m19:46:03.534252 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: BEGIN
[0m19:46:03.540799 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:46:03.578526 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m19:46:03.584671 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m19:46:03.590939 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.card_transactions"} */

    create table "dev"."main"."card_transactions" ("TRANSACTION_ID" varchar,"SUBACCOUNT_ID" varchar,"CARD_ID" varchar,"ACCOUNT_TYPE" varchar,"TRANSACTION_AMOUNT" float,"ORIGINAL_CURRENCY_CODE" varchar,"MERCHANT_DESCRIPTION" varchar,"MERCHANT_CATEGORY_CODE" varchar,"MERCHANT_COUNTRY" varchar,"TIMESTAMP" timestamp)
  
[0m19:46:03.616249 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m19:46:03.628738 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m19:46:03.635219 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: 
          COPY "dev"."main"."card_transactions" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/card_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:46:05.022983 [debug] [Thread-2 (]: SQL status: OK in 1.381 seconds
[0m19:46:05.035654 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.card_transactions"
[0m19:46:05.199654 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: COMMIT
[0m19:46:05.206339 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m19:46:05.212750 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: COMMIT
[0m19:46:05.244321 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m19:46:05.267009 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: Close
[0m19:46:05.404969 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106972200>]}
[0m19:46:05.412160 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main.card_transactions .............................. [[32mINSERT 909419[0m in 27.31s]
[0m19:46:05.426078 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.card_transactions
[0m19:46:05.426508 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.entity
[0m19:46:05.427111 [info ] [Thread-2 (]: 3 of 3 START seed file main.entity ............................................. [RUN]
[0m19:46:05.441874 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.card_transactions, now seed.slash_analytics_take_home.entity)
[0m19:46:05.448728 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.entity
[0m19:46:05.455584 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.entity
[0m19:46:05.523890 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m19:46:05.530521 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: BEGIN
[0m19:46:05.537086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:46:05.580074 [debug] [Thread-2 (]: SQL status: OK in 0.043 seconds
[0m19:46:05.585705 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m19:46:05.592351 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.entity"} */

    create table "dev"."main"."entity" ("ENTITY_ID" varchar,"SUBACCOUNT_ID" varchar,"ACCOUNT_CREATION_DATE" timestamp)
  
[0m19:46:05.631014 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m19:46:05.631919 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m19:46:05.638527 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: 
          COPY "dev"."main"."entity" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/entity.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:46:05.707894 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m19:46:05.719207 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.entity"
[0m19:46:05.747883 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: COMMIT
[0m19:46:05.761006 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m19:46:05.767559 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: COMMIT
[0m19:46:05.799192 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m19:46:05.805720 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: Close
[0m19:46:10.712946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a04550>]}
[0m19:46:10.727300 [info ] [Thread-2 (]: 3 of 3 OK loaded seed file main.entity ......................................... [[32mINSERT 1811[0m in 5.27s]
[0m19:46:10.740470 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.entity
[0m19:46:27.627745 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m19:46:27.630038 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: BEGIN
[0m19:46:27.630353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:27.638038 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m19:46:27.638264 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m19:46:27.638418 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.card_events"} */

    create table "dev"."main"."card_events" ("SLASH_ACCOUNT_ID" varchar,"CARD_EVENT_ID" varchar,"CARD_ID" varchar,"EVENT_TYPE" varchar,"CARD_STATUS" varchar,"TIMESTAMP" timestamp)
  
[0m19:46:27.638723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:46:27.639830 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m19:46:27.639980 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: 
          COPY "dev"."main"."card_events" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/card_events.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m19:46:30.300761 [debug] [Thread-1 (]: SQL status: OK in 2.660 seconds
[0m19:46:30.301854 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.card_events"
[0m19:46:30.303482 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: COMMIT
[0m19:46:30.303672 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m19:46:30.303817 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: COMMIT
[0m19:46:30.309896 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m19:46:30.310495 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: Close
[0m19:46:30.319515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe45745-dc2f-4dad-9cba-033d3b3dbb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f98dd0>]}
[0m19:46:30.319962 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.card_events .................................... [[32mINSERT 3499969[0m in 52.33s]
[0m19:46:30.320299 [debug] [Thread-1 (]: Finished running node seed.slash_analytics_take_home.card_events
[0m19:46:30.322679 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:30.322856 [debug] [MainThread]: On master: BEGIN
[0m19:46:30.322988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:30.326817 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m19:46:30.326967 [debug] [MainThread]: On master: COMMIT
[0m19:46:30.327089 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:30.327205 [debug] [MainThread]: On master: COMMIT
[0m19:46:30.327419 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:46:30.327547 [debug] [MainThread]: On master: Close
[0m19:46:30.328556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:30.328727 [debug] [MainThread]: Connection 'seed.slash_analytics_take_home.card_events' was properly closed.
[0m19:46:30.328866 [debug] [MainThread]: Connection 'seed.slash_analytics_take_home.entity' was properly closed.
[0m19:46:30.329310 [info ] [MainThread]: 
[0m19:46:30.329547 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 52.43 seconds (52.43s).
[0m19:46:30.330517 [debug] [MainThread]: Command end result
[0m19:46:30.604160 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:46:30.606901 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:46:30.610134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m19:46:30.610313 [info ] [MainThread]: 
[0m19:46:30.610534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:30.610674 [info ] [MainThread]: 
[0m19:46:30.611078 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:46:30.611893 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 53.581184, "process_in_blocks": "0", "process_kernel_time": 19.440954, "process_mem_max_rss": "2798534656", "process_out_blocks": "0", "process_user_time": 33.11637}
[0m19:46:30.612111 [debug] [MainThread]: Command `dbt seed` succeeded at 19:46:30.612071 after 53.58 seconds
[0m19:46:30.612369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658cf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10260a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7b4d0>]}
[0m19:46:30.612523 [debug] [MainThread]: Flushing usage events
[0m19:46:30.826851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:32.445808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104548980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734fc50>]}


============================== 19:46:32.448795 | e40d3cf3-6271-47b5-97dd-ca2e5c448225 ==============================
[0m19:46:32.448795 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:46:32.449106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:46:32.574510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e40d3cf3-6271-47b5-97dd-ca2e5c448225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079588a0>]}
[0m19:46:32.597705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e40d3cf3-6271-47b5-97dd-ca2e5c448225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753dbf0>]}
[0m19:46:32.599360 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:46:32.653046 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:46:32.720596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:32.720795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:32.741573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e40d3cf3-6271-47b5-97dd-ca2e5c448225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c51250>]}
[0m19:46:32.777881 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:46:32.779143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:46:32.791134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e40d3cf3-6271-47b5-97dd-ca2e5c448225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ebc50>]}
[0m19:46:32.791377 [info ] [MainThread]: Found 2 models, 3 seeds, 4 data tests, 424 macros
[0m19:46:32.791537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e40d3cf3-6271-47b5-97dd-ca2e5c448225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756d1d0>]}
[0m19:46:32.792435 [info ] [MainThread]: 
[0m19:46:32.792607 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:46:32.792732 [info ] [MainThread]: 
[0m19:46:32.792966 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:46:32.795099 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m19:46:32.831318 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:46:32.831553 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:46:32.831705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:32.835881 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:46:32.836071 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:46:32.836220 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:46:32.857762 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m19:46:32.858575 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:46:32.859472 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:46:32.859648 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:46:32.861257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e40d3cf3-6271-47b5-97dd-ca2e5c448225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6a9c0>]}
[0m19:46:32.862518 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.card_transactions
[0m19:46:32.862702 [debug] [Thread-1 (]: Began running node seed.slash_analytics_take_home.card_events
[0m19:46:32.862928 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.slash_analytics_take_home.card_transactions'
[0m19:46:32.863127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.slash_analytics_take_home.card_events)
[0m19:46:32.863284 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.card_transactions
[0m19:46:32.863436 [debug] [Thread-1 (]: Began compiling node seed.slash_analytics_take_home.card_events
[0m19:46:32.866289 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.card_transactions
[0m19:46:32.867205 [debug] [Thread-1 (]: Began executing node seed.slash_analytics_take_home.card_events
[0m19:46:32.867523 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.card_transactions
[0m19:46:32.867795 [debug] [Thread-1 (]: Finished running node seed.slash_analytics_take_home.card_events
[0m19:46:32.867960 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.entity
[0m19:46:32.868185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.card_transactions, now seed.slash_analytics_take_home.entity)
[0m19:46:32.868351 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.entity
[0m19:46:32.868528 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.my_first_dbt_model
[0m19:46:32.869199 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.entity
[0m19:46:32.869371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.card_events, now model.slash_analytics_take_home.my_first_dbt_model)
[0m19:46:32.869638 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.entity
[0m19:46:32.869792 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.my_first_dbt_model
[0m19:46:32.870963 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:46:32.871464 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.my_first_dbt_model
[0m19:46:32.871733 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.my_first_dbt_model
[0m19:46:32.872020 [debug] [Thread-1 (]: Began running node test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:46:32.872216 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.my_second_dbt_model
[0m19:46:32.872374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.my_first_dbt_model, now test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710)
[0m19:46:32.872548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.entity, now model.slash_analytics_take_home.my_second_dbt_model)
[0m19:46:32.872693 [debug] [Thread-1 (]: Began compiling node test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:46:32.872835 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.my_second_dbt_model
[0m19:46:32.877972 [debug] [Thread-1 (]: Writing injected SQL for node "test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:46:32.878956 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:46:32.879309 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.my_second_dbt_model
[0m19:46:32.879572 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.my_second_dbt_model
[0m19:46:32.879720 [debug] [Thread-1 (]: Began executing node test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:46:32.879889 [debug] [Thread-2 (]: Began running node test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321
[0m19:46:32.880175 [debug] [Thread-1 (]: Finished running node test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:46:32.880361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.my_second_dbt_model, now test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321)
[0m19:46:32.880521 [debug] [Thread-1 (]: Began running node test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778
[0m19:46:32.880676 [debug] [Thread-2 (]: Began compiling node test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321
[0m19:46:32.880834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710, now test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778)
[0m19:46:32.883269 [debug] [Thread-2 (]: Writing injected SQL for node "test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321"
[0m19:46:32.883442 [debug] [Thread-1 (]: Began compiling node test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778
[0m19:46:32.885220 [debug] [Thread-1 (]: Writing injected SQL for node "test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778"
[0m19:46:32.885614 [debug] [Thread-1 (]: Began executing node test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778
[0m19:46:32.885765 [debug] [Thread-2 (]: Began executing node test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321
[0m19:46:32.886019 [debug] [Thread-1 (]: Finished running node test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778
[0m19:46:32.886282 [debug] [Thread-2 (]: Finished running node test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321
[0m19:46:32.886443 [debug] [Thread-1 (]: Began running node test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493
[0m19:46:32.886634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778, now test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:46:32.886777 [debug] [Thread-1 (]: Began compiling node test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493
[0m19:46:32.888304 [debug] [Thread-1 (]: Writing injected SQL for node "test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:46:32.888579 [debug] [Thread-1 (]: Began executing node test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493
[0m19:46:32.888841 [debug] [Thread-1 (]: Finished running node test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493
[0m19:46:32.889261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:32.889390 [debug] [MainThread]: Connection 'test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:46:32.889515 [debug] [MainThread]: Connection 'test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:46:32.890144 [debug] [MainThread]: Command end result
[0m19:46:32.899273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:46:32.899951 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:46:32.903049 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m19:46:32.903362 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.4933652, "process_in_blocks": "0", "process_kernel_time": 0.156184, "process_mem_max_rss": "131301376", "process_out_blocks": "0", "process_user_time": 0.860514}
[0m19:46:32.903551 [debug] [MainThread]: Command `dbt compile` succeeded at 19:46:32.903512 after 0.49 seconds
[0m19:46:32.903725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ac410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcdd30>]}
[0m19:46:32.903889 [debug] [MainThread]: Flushing usage events
[0m19:46:33.061276 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:46:33.746700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0fc50>]}


============================== 19:46:33.748689 | c265b1e7-4551-4e79-9297-3595d0f2e60b ==============================
[0m19:46:33.748689 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:46:33.749011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:46:33.841924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c265b1e7-4551-4e79-9297-3595d0f2e60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e188a0>]}
[0m19:46:33.865507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c265b1e7-4551-4e79-9297-3595d0f2e60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d05bf0>]}
[0m19:46:33.867059 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:46:33.913961 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:46:33.964830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:46:33.965022 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:46:33.985473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c265b1e7-4551-4e79-9297-3595d0f2e60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700d250>]}
[0m19:46:34.020219 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:46:34.021046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:46:34.027622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c265b1e7-4551-4e79-9297-3595d0f2e60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaba70>]}
[0m19:46:34.027858 [info ] [MainThread]: Found 2 models, 3 seeds, 4 data tests, 424 macros
[0m19:46:34.028023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c265b1e7-4551-4e79-9297-3595d0f2e60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2c670>]}
[0m19:46:34.028876 [info ] [MainThread]: 
[0m19:46:34.029041 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:46:34.029166 [info ] [MainThread]: 
[0m19:46:34.029385 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:46:34.031352 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:46:34.056139 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:46:34.056325 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:46:34.056463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:46:34.060703 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:46:34.061388 [debug] [ThreadPool]: On list_dev: Close
[0m19:46:34.062294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:46:34.062728 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:46:34.065433 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:46:34.065582 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:46:34.065702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:34.068952 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:46:34.069531 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:46:34.069659 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:46:34.069845 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:46:34.069956 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:46:34.070076 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:46:34.070278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:46:34.070612 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:46:34.070727 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:46:34.070831 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:46:34.071000 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:46:34.071113 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:46:34.072242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m19:46:34.074460 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:46:34.074597 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:46:34.074710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:46:34.077880 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:46:34.078016 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:46:34.078146 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:46:34.092464 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m19:46:34.093351 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:46:34.093886 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:46:34.094020 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:46:34.095493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c265b1e7-4551-4e79-9297-3595d0f2e60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d4ef0>]}
[0m19:46:34.095682 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:34.095797 [debug] [MainThread]: On master: BEGIN
[0m19:46:34.095899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:46:34.098813 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:46:34.098966 [debug] [MainThread]: On master: COMMIT
[0m19:46:34.099093 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:34.099208 [debug] [MainThread]: On master: COMMIT
[0m19:46:34.099396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:46:34.099513 [debug] [MainThread]: On master: Close
[0m19:46:34.100599 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.my_first_dbt_model
[0m19:46:34.100816 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m19:46:34.101032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.my_first_dbt_model)
[0m19:46:34.101183 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.my_first_dbt_model
[0m19:46:34.104269 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:46:34.104608 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.my_first_dbt_model
[0m19:46:34.119760 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:46:34.120339 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:46:34.120513 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: BEGIN
[0m19:46:34.120656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:46:34.124018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:46:34.124197 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:46:34.124348 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      with source as (
    select * from "dev"."main"."card_events"
)

select 
    date_trunc('day', timestamp::timestamp) as day,
    count(*) as num_events
from source
group by all
    );
  
  
[0m19:46:34.131325 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m19:46:34.134082 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:46:34.134261 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:46:34.134977 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:46:34.140642 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: COMMIT
[0m19:46:34.140817 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:46:34.140967 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: COMMIT
[0m19:46:34.141415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:46:34.143557 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:46:34.143730 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m19:46:34.144001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:46:34.145033 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: Close
[0m19:46:34.151003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c265b1e7-4551-4e79-9297-3595d0f2e60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b6210>]}
[0m19:46:34.151315 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m19:46:34.151578 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.my_first_dbt_model
[0m19:46:34.151902 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.my_second_dbt_model
[0m19:46:34.152153 [info ] [Thread-2 (]: 2 of 2 START sql table model main.my_second_dbt_model .......................... [RUN]
[0m19:46:34.152412 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.my_second_dbt_model'
[0m19:46:34.152563 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.my_second_dbt_model
[0m19:46:34.153589 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:46:34.153863 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.my_second_dbt_model
[0m19:46:34.155231 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:46:34.155520 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:46:34.155667 [debug] [Thread-2 (]: On model.slash_analytics_take_home.my_second_dbt_model: BEGIN
[0m19:46:34.155799 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:46:34.159072 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m19:46:34.159245 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:46:34.159396 [debug] [Thread-2 (]: On model.slash_analytics_take_home.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_second_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_second_dbt_model__dbt_tmp"
  
    as (
      select 
    date_trunc('month', day) as month,
    sum(num_events) as monthly_events
from "dev"."main"."my_first_dbt_model"
group by all
    );
  
  
[0m19:46:34.160171 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:46:34.161433 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:46:34.161610 [debug] [Thread-2 (]: On model.slash_analytics_take_home.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_second_dbt_model"} */
alter table "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:46:34.161886 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:46:34.162560 [debug] [Thread-2 (]: On model.slash_analytics_take_home.my_second_dbt_model: COMMIT
[0m19:46:34.162715 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:46:34.162850 [debug] [Thread-2 (]: On model.slash_analytics_take_home.my_second_dbt_model: COMMIT
[0m19:46:34.163223 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:46:34.164055 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:46:34.164201 [debug] [Thread-2 (]: On model.slash_analytics_take_home.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_second_dbt_model"} */
drop table if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m19:46:34.164425 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:46:34.164957 [debug] [Thread-2 (]: On model.slash_analytics_take_home.my_second_dbt_model: Close
[0m19:46:34.170162 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c265b1e7-4551-4e79-9297-3595d0f2e60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a9e90>]}
[0m19:46:34.170483 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.my_second_dbt_model ..................... [[32mOK[0m in 0.02s]
[0m19:46:34.170729 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.my_second_dbt_model
[0m19:46:34.171248 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:34.171403 [debug] [MainThread]: On master: BEGIN
[0m19:46:34.171527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:46:34.174891 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:46:34.175043 [debug] [MainThread]: On master: COMMIT
[0m19:46:34.175170 [debug] [MainThread]: Using duckdb connection "master"
[0m19:46:34.175286 [debug] [MainThread]: On master: COMMIT
[0m19:46:34.175480 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:46:34.175613 [debug] [MainThread]: On master: Close
[0m19:46:34.176352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:46:34.176476 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.my_first_dbt_model' was properly closed.
[0m19:46:34.176583 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.my_second_dbt_model' was properly closed.
[0m19:46:34.176731 [info ] [MainThread]: 
[0m19:46:34.176882 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m19:46:34.177335 [debug] [MainThread]: Command end result
[0m19:46:34.189148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:46:34.190025 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:46:34.192792 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m19:46:34.192957 [info ] [MainThread]: 
[0m19:46:34.193130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:46:34.193268 [info ] [MainThread]: 
[0m19:46:34.193413 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:46:34.193747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.47649524, "process_in_blocks": "0", "process_kernel_time": 0.134823, "process_mem_max_rss": "161087488", "process_out_blocks": "0", "process_user_time": 0.903189}
[0m19:46:34.193966 [debug] [MainThread]: Command `dbt run` succeeded at 19:46:34.193923 after 0.48 seconds
[0m19:46:34.194194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107183020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d81f50>]}
[0m19:46:34.194409 [debug] [MainThread]: Flushing usage events
[0m19:46:34.360395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:42.246545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c63b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c63c50>]}


============================== 19:51:42.249222 | e18ed82c-84c6-4a82-9b2c-6a235b0a12fc ==============================
[0m19:51:42.249222 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:51:42.249525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:42.390422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e18ed82c-84c6-4a82-9b2c-6a235b0a12fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e708a0>]}
[0m19:51:42.412726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e18ed82c-84c6-4a82-9b2c-6a235b0a12fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d59bf0>]}
[0m19:51:42.414267 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:51:42.465869 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:51:42.534384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:42.534580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:42.554098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e18ed82c-84c6-4a82-9b2c-6a235b0a12fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109065250>]}
[0m19:51:42.587611 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:51:42.588573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:51:42.599930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e18ed82c-84c6-4a82-9b2c-6a235b0a12fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108effc50>]}
[0m19:51:42.600174 [info ] [MainThread]: Found 2 models, 3 seeds, 4 data tests, 424 macros
[0m19:51:42.600337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e18ed82c-84c6-4a82-9b2c-6a235b0a12fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d811d0>]}
[0m19:51:42.601241 [info ] [MainThread]: 
[0m19:51:42.601415 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:51:42.601540 [info ] [MainThread]: 
[0m19:51:42.601799 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:51:42.603843 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m19:51:42.637526 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:51:42.637703 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:51:42.637827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:42.645310 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m19:51:42.645484 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:51:42.645626 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:51:42.670344 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m19:51:42.671260 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:51:42.672002 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:51:42.672156 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:51:42.674187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e18ed82c-84c6-4a82-9b2c-6a235b0a12fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937e9c0>]}
[0m19:51:42.675329 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.card_transactions
[0m19:51:42.675504 [debug] [Thread-1 (]: Began running node seed.slash_analytics_take_home.card_events
[0m19:51:42.675722 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.slash_analytics_take_home.card_transactions'
[0m19:51:42.675897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.slash_analytics_take_home.card_events)
[0m19:51:42.676059 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.card_transactions
[0m19:51:42.676204 [debug] [Thread-1 (]: Began compiling node seed.slash_analytics_take_home.card_events
[0m19:51:42.678905 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.card_transactions
[0m19:51:42.679778 [debug] [Thread-1 (]: Began executing node seed.slash_analytics_take_home.card_events
[0m19:51:42.680084 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.card_transactions
[0m19:51:42.680355 [debug] [Thread-1 (]: Finished running node seed.slash_analytics_take_home.card_events
[0m19:51:42.680527 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.entity
[0m19:51:42.680761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.card_transactions, now seed.slash_analytics_take_home.entity)
[0m19:51:42.680908 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.entity
[0m19:51:42.681052 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.my_first_dbt_model
[0m19:51:42.681668 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.entity
[0m19:51:42.681829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.card_events, now model.slash_analytics_take_home.my_first_dbt_model)
[0m19:51:42.682087 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.entity
[0m19:51:42.682234 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.my_first_dbt_model
[0m19:51:42.683326 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:42.683738 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.my_first_dbt_model
[0m19:51:42.683980 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.my_first_dbt_model
[0m19:51:42.684258 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.my_second_dbt_model
[0m19:51:42.684475 [debug] [Thread-1 (]: Began running node test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:51:42.684627 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.entity, now model.slash_analytics_take_home.my_second_dbt_model)
[0m19:51:42.684800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.my_first_dbt_model, now test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710)
[0m19:51:42.684942 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.my_second_dbt_model
[0m19:51:42.685078 [debug] [Thread-1 (]: Began compiling node test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:51:42.686220 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.my_second_dbt_model"
[0m19:51:42.690897 [debug] [Thread-1 (]: Writing injected SQL for node "test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:51:42.691205 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.my_second_dbt_model
[0m19:51:42.691360 [debug] [Thread-1 (]: Began executing node test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:51:42.691620 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.my_second_dbt_model
[0m19:51:42.691861 [debug] [Thread-1 (]: Finished running node test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:51:42.692020 [debug] [Thread-2 (]: Began running node test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321
[0m19:51:42.692244 [debug] [Thread-1 (]: Began running node test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778
[0m19:51:42.692428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.my_second_dbt_model, now test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321)
[0m19:51:42.692587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.slash_analytics_take_home.not_null_my_first_dbt_model_id.5fb22c2710, now test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778)
[0m19:51:42.692735 [debug] [Thread-2 (]: Began compiling node test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321
[0m19:51:42.692876 [debug] [Thread-1 (]: Began compiling node test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778
[0m19:51:42.695199 [debug] [Thread-2 (]: Writing injected SQL for node "test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321"
[0m19:51:42.696877 [debug] [Thread-1 (]: Writing injected SQL for node "test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778"
[0m19:51:42.697192 [debug] [Thread-2 (]: Began executing node test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321
[0m19:51:42.697345 [debug] [Thread-1 (]: Began executing node test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778
[0m19:51:42.697601 [debug] [Thread-2 (]: Finished running node test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321
[0m19:51:42.697848 [debug] [Thread-1 (]: Finished running node test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778
[0m19:51:42.698003 [debug] [Thread-2 (]: Began running node test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493
[0m19:51:42.698197 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.slash_analytics_take_home.unique_my_first_dbt_model_id.16e066b321, now test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:51:42.698344 [debug] [Thread-2 (]: Began compiling node test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493
[0m19:51:42.699688 [debug] [Thread-2 (]: Writing injected SQL for node "test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:51:42.699933 [debug] [Thread-2 (]: Began executing node test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493
[0m19:51:42.700184 [debug] [Thread-2 (]: Finished running node test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493
[0m19:51:42.700541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:42.700665 [debug] [MainThread]: Connection 'test.slash_analytics_take_home.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m19:51:42.700776 [debug] [MainThread]: Connection 'test.slash_analytics_take_home.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:51:42.701355 [debug] [MainThread]: Command end result
[0m19:51:42.709763 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:51:42.710467 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:51:42.713314 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m19:51:42.713605 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.50106335, "process_in_blocks": "0", "process_kernel_time": 0.176965, "process_mem_max_rss": "131465216", "process_out_blocks": "0", "process_user_time": 0.82923}
[0m19:51:42.713789 [debug] [MainThread]: Command `dbt compile` succeeded at 19:51:42.713753 after 0.50 seconds
[0m19:51:42.713952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d95a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d9e90>]}
[0m19:51:42.714108 [debug] [MainThread]: Flushing usage events
[0m19:51:42.968498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:51:43.653132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107348980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11064fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11064fc50>]}


============================== 19:51:43.655055 | ff0b9141-ec30-42c5-8bb0-1e5d8b2919c0 ==============================
[0m19:51:43.655055 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:51:43.655375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select my_first_dbt_model', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:51:43.771322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff0b9141-ec30-42c5-8bb0-1e5d8b2919c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11123c8a0>]}
[0m19:51:43.793480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff0b9141-ec30-42c5-8bb0-1e5d8b2919c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073dbf0>]}
[0m19:51:43.794655 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:51:43.840465 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:51:43.888765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:43.888953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:43.908348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff0b9141-ec30-42c5-8bb0-1e5d8b2919c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11144d250>]}
[0m19:51:43.941554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:51:43.942328 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:51:43.948930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff0b9141-ec30-42c5-8bb0-1e5d8b2919c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112eba70>]}
[0m19:51:43.949157 [info ] [MainThread]: Found 2 models, 3 seeds, 4 data tests, 424 macros
[0m19:51:43.949321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff0b9141-ec30-42c5-8bb0-1e5d8b2919c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076c670>]}
[0m19:51:43.950046 [info ] [MainThread]: 
[0m19:51:43.950218 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m19:51:43.950348 [info ] [MainThread]: 
[0m19:51:43.950563 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:51:43.950925 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m19:51:43.972836 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m19:51:43.973029 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m19:51:43.973164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:43.977282 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m19:51:43.977866 [debug] [ThreadPool]: On list_dev: Close
[0m19:51:43.978727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m19:51:43.978926 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m19:51:43.981744 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:51:43.981891 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m19:51:43.982012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:43.985238 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:51:43.986029 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:51:43.986161 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m19:51:43.986342 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:43.986462 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:51:43.986582 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m19:51:43.986990 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:43.987431 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:51:43.987565 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m19:51:43.987680 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m19:51:43.987893 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:51:43.988021 [debug] [ThreadPool]: On create_dev_main: Close
[0m19:51:43.990683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m19:51:43.993173 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:51:43.993309 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m19:51:43.993417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:43.996422 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:51:43.996569 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m19:51:43.996702 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m19:51:44.010848 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m19:51:44.011436 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m19:51:44.011891 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m19:51:44.012016 [debug] [ThreadPool]: On list_dev_main: Close
[0m19:51:44.013374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff0b9141-ec30-42c5-8bb0-1e5d8b2919c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a14870>]}
[0m19:51:44.013573 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:44.013690 [debug] [MainThread]: On master: BEGIN
[0m19:51:44.013794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:44.017003 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:51:44.017154 [debug] [MainThread]: On master: COMMIT
[0m19:51:44.017277 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:44.017388 [debug] [MainThread]: On master: COMMIT
[0m19:51:44.017551 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:44.017661 [debug] [MainThread]: On master: Close
[0m19:51:44.018742 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.my_first_dbt_model
[0m19:51:44.018943 [info ] [Thread-1 (]: 1 of 1 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m19:51:44.019156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.my_first_dbt_model)
[0m19:51:44.019302 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.my_first_dbt_model
[0m19:51:44.022294 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:44.022606 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.my_first_dbt_model
[0m19:51:44.037036 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:44.037589 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:44.037751 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: BEGIN
[0m19:51:44.037886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:44.040966 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:51:44.041119 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:44.041263 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      with source as (
    select * from "dev"."main"."card_events"
)

select 
    date_trunc('day', timestamp::timestamp) as day,
    count(*) as num_events
from source
group by all
    );
  
  
[0m19:51:44.054077 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m19:51:44.056848 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:44.057021 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:51:44.057704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.058844 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:44.058995 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:51:44.059240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:51:44.065932 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: COMMIT
[0m19:51:44.066101 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:44.066248 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: COMMIT
[0m19:51:44.067043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:51:44.068953 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.my_first_dbt_model"
[0m19:51:44.069108 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m19:51:44.069425 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:51:44.070419 [debug] [Thread-1 (]: On model.slash_analytics_take_home.my_first_dbt_model: Close
[0m19:51:44.077184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0b9141-ec30-42c5-8bb0-1e5d8b2919c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f62d0>]}
[0m19:51:44.077494 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m19:51:44.077748 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.my_first_dbt_model
[0m19:51:44.078281 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:44.078437 [debug] [MainThread]: On master: BEGIN
[0m19:51:44.078558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:44.081680 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:51:44.081828 [debug] [MainThread]: On master: COMMIT
[0m19:51:44.081951 [debug] [MainThread]: Using duckdb connection "master"
[0m19:51:44.082061 [debug] [MainThread]: On master: COMMIT
[0m19:51:44.082223 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:51:44.082342 [debug] [MainThread]: On master: Close
[0m19:51:44.083138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:44.083303 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.my_first_dbt_model' was properly closed.
[0m19:51:44.083442 [info ] [MainThread]: 
[0m19:51:44.083589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m19:51:44.083864 [debug] [MainThread]: Command end result
[0m19:51:44.092625 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m19:51:44.093279 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m19:51:44.095663 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m19:51:44.095807 [info ] [MainThread]: 
[0m19:51:44.095978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:44.096107 [info ] [MainThread]: 
[0m19:51:44.096247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:51:44.096516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.47182658, "process_in_blocks": "0", "process_kernel_time": 0.125541, "process_mem_max_rss": "157286400", "process_out_blocks": "0", "process_user_time": 0.86357}
[0m19:51:44.096703 [debug] [MainThread]: Command `dbt run` succeeded at 19:51:44.096665 after 0.47 seconds
[0m19:51:44.096878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e5230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a7c0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a7fa70>]}
[0m19:51:44.097178 [debug] [MainThread]: Flushing usage events
[0m19:51:44.258382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:12.419342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c38980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e47b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e47c50>]}


============================== 10:01:12.422295 | d5d923a7-e655-409f-bbae-74b800d94eff ==============================
[0m10:01:12.422295 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:01:12.422634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:12.431484 [info ] [MainThread]: dbt version: 1.9.2
[0m10:01:12.431769 [info ] [MainThread]: python version: 3.13.2
[0m10:01:12.432016 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m10:01:12.432183 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m10:01:13.082955 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m10:01:13.083205 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m10:01:13.083358 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m10:01:13.084756 [info ] [MainThread]: adapter type: duckdb
[0m10:01:13.084908 [info ] [MainThread]: adapter version: 1.9.1
[0m10:01:13.124305 [info ] [MainThread]: Configuration:
[0m10:01:13.124596 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:01:13.124786 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:01:13.124962 [info ] [MainThread]: Required dependencies:
[0m10:01:13.125193 [debug] [MainThread]: Executing "git --help"
[0m10:01:13.139739 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:01:13.140195 [debug] [MainThread]: STDERR: "b''"
[0m10:01:13.140362 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:01:13.140522 [info ] [MainThread]: Connection:
[0m10:01:13.140677 [info ] [MainThread]:   database: dev
[0m10:01:13.140801 [info ] [MainThread]:   schema: main
[0m10:01:13.140917 [info ] [MainThread]:   path: dev.duckdb
[0m10:01:13.141029 [info ] [MainThread]:   config_options: None
[0m10:01:13.141141 [info ] [MainThread]:   extensions: None
[0m10:01:13.141253 [info ] [MainThread]:   settings: {}
[0m10:01:13.141368 [info ] [MainThread]:   external_root: .
[0m10:01:13.141478 [info ] [MainThread]:   use_credential_provider: None
[0m10:01:13.141596 [info ] [MainThread]:   attach: None
[0m10:01:13.141708 [info ] [MainThread]:   filesystems: None
[0m10:01:13.141816 [info ] [MainThread]:   remote: None
[0m10:01:13.141924 [info ] [MainThread]:   plugins: None
[0m10:01:13.142033 [info ] [MainThread]:   disable_transactions: False
[0m10:01:13.142337 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:01:13.196020 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:01:13.228182 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:01:13.228412 [debug] [MainThread]: On debug: select 1 as id
[0m10:01:13.228552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:01:13.235193 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m10:01:13.235657 [debug] [MainThread]: On debug: Close
[0m10:01:13.236506 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:01:13.236729 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:01:13.237078 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.85782796, "process_in_blocks": "0", "process_kernel_time": 0.188454, "process_mem_max_rss": "122454016", "process_out_blocks": "0", "process_user_time": 0.69195}
[0m10:01:13.237282 [debug] [MainThread]: Command `dbt debug` succeeded at 10:01:13.237237 after 0.86 seconds
[0m10:01:13.237434 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:01:13.237596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109177a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ff890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed79b0>]}
[0m10:01:13.237781 [debug] [MainThread]: Flushing usage events
[0m10:01:13.524010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:01:39.554158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108034980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e77b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e77c50>]}


============================== 10:01:39.557056 | 798d9f83-7eb5-4c02-b6e9-a068ae68e334 ==============================
[0m10:01:39.557056 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:01:39.557381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_entity', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:39.710306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '798d9f83-7eb5-4c02-b6e9-a068ae68e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090688a0>]}
[0m10:01:39.732717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '798d9f83-7eb5-4c02-b6e9-a068ae68e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6dbf0>]}
[0m10:01:39.734345 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:01:39.784762 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:01:39.830127 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:01:39.830394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '798d9f83-7eb5-4c02-b6e9-a068ae68e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3f650>]}
[0m10:01:40.356608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '798d9f83-7eb5-4c02-b6e9-a068ae68e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f9400>]}
[0m10:01:40.388158 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:01:40.389373 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:01:40.400674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '798d9f83-7eb5-4c02-b6e9-a068ae68e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a3af0>]}
[0m10:01:40.400900 [info ] [MainThread]: Found 4 models, 3 seeds, 4 data tests, 424 macros
[0m10:01:40.401062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '798d9f83-7eb5-4c02-b6e9-a068ae68e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e5300>]}
[0m10:01:40.401751 [info ] [MainThread]: 
[0m10:01:40.401916 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:01:40.402043 [info ] [MainThread]: 
[0m10:01:40.402247 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:01:40.402606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:01:40.430700 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:01:40.430894 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:01:40.431028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:40.446153 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m10:01:40.446981 [debug] [ThreadPool]: On list_dev: Close
[0m10:01:40.448314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:01:40.448544 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:01:40.451356 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:01:40.451528 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:01:40.451660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:40.454932 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:01:40.455546 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:01:40.455676 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:01:40.455856 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:01:40.455973 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:01:40.456089 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:01:40.456651 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:01:40.457086 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:01:40.457239 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:01:40.457368 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:01:40.457559 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:01:40.457687 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:01:40.460521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:01:40.463065 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:01:40.463205 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:01:40.463319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:01:40.466502 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:01:40.466654 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:01:40.466790 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:01:40.483709 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:01:40.484435 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:01:40.485228 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:01:40.485378 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:01:40.486935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '798d9f83-7eb5-4c02-b6e9-a068ae68e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109626450>]}
[0m10:01:40.487141 [debug] [MainThread]: Using duckdb connection "master"
[0m10:01:40.487261 [debug] [MainThread]: On master: BEGIN
[0m10:01:40.487365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:01:40.490567 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:01:40.490717 [debug] [MainThread]: On master: COMMIT
[0m10:01:40.490848 [debug] [MainThread]: Using duckdb connection "master"
[0m10:01:40.490956 [debug] [MainThread]: On master: COMMIT
[0m10:01:40.491123 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:01:40.491241 [debug] [MainThread]: On master: Close
[0m10:01:40.492389 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m10:01:40.492638 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_entity ................................... [RUN]
[0m10:01:40.492849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_entity)
[0m10:01:40.493007 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m10:01:40.496168 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m10:01:40.496808 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m10:01:40.511562 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m10:01:40.512305 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:01:40.512459 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m10:01:40.512592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:40.515751 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:01:40.515920 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:01:40.516079 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw;
    );
  
  
[0m10:01:40.518079 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw;
    );
  
  
[0m10:01:40.518281 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:01:40.518480 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: ROLLBACK
[0m10:01:40.523624 [debug] [Thread-1 (]: Failed to rollback 'model.slash_analytics_take_home.stg_entity'
[0m10:01:40.523785 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m10:01:40.526235 [debug] [Thread-1 (]: Runtime Error in model stg_entity (models/staging/stg_entity.sql)
  Parser Error: syntax error at or near ";"
[0m10:01:40.527118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798d9f83-7eb5-4c02-b6e9-a068ae68e334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e3ac0>]}
[0m10:01:40.527402 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.stg_entity .......................... [[31mERROR[0m in 0.03s]
[0m10:01:40.527661 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m10:01:40.527884 [debug] [Thread-5 (]: Marking all children of 'model.slash_analytics_take_home.stg_entity' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_entity (models/staging/stg_entity.sql)
  Parser Error: syntax error at or near ";".
[0m10:01:40.528637 [debug] [MainThread]: Using duckdb connection "master"
[0m10:01:40.528771 [debug] [MainThread]: On master: BEGIN
[0m10:01:40.528885 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:01:40.532234 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:01:40.532394 [debug] [MainThread]: On master: COMMIT
[0m10:01:40.532532 [debug] [MainThread]: Using duckdb connection "master"
[0m10:01:40.532651 [debug] [MainThread]: On master: COMMIT
[0m10:01:40.532822 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:01:40.532943 [debug] [MainThread]: On master: Close
[0m10:01:40.533665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:40.533814 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m10:01:40.533968 [info ] [MainThread]: 
[0m10:01:40.534172 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m10:01:40.534480 [debug] [MainThread]: Command end result
[0m10:01:40.543506 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:01:40.544263 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:01:40.547668 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m10:01:40.547827 [info ] [MainThread]: 
[0m10:01:40.548004 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:01:40.548144 [info ] [MainThread]: 
[0m10:01:40.548302 [error] [MainThread]:   Runtime Error in model stg_entity (models/staging/stg_entity.sql)
  Parser Error: syntax error at or near ";"
[0m10:01:40.548427 [info ] [MainThread]: 
[0m10:01:40.548561 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:01:40.548847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0288565, "process_in_blocks": "0", "process_kernel_time": 0.18597, "process_mem_max_rss": "141934592", "process_out_blocks": "0", "process_user_time": 1.347248}
[0m10:01:40.549019 [debug] [MainThread]: Command `dbt run` failed at 10:01:40.548983 after 1.03 seconds
[0m10:01:40.549194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957cfd0>]}
[0m10:01:40.549343 [debug] [MainThread]: Flushing usage events
[0m10:01:40.708022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:25.065611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10401c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e63b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e63c50>]}


============================== 10:02:25.068401 | f671f99c-566b-4636-9bff-868c556c591f ==============================
[0m10:02:25.068401 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:02:25.068724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_entity', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:02:25.209835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f671f99c-566b-4636-9bff-868c556c591f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504c8a0>]}
[0m10:02:25.232091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f671f99c-566b-4636-9bff-868c556c591f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f59bf0>]}
[0m10:02:25.233563 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:02:25.286605 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:02:25.351989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:02:25.352294 [debug] [MainThread]: Partial parsing: updated file: slash_analytics_take_home://models/staging/stg_entity.sql
[0m10:02:25.455412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f671f99c-566b-4636-9bff-868c556c591f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10525e050>]}
[0m10:02:25.487555 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:02:25.490826 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:02:25.501793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f671f99c-566b-4636-9bff-868c556c591f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ffa70>]}
[0m10:02:25.502008 [info ] [MainThread]: Found 4 models, 3 seeds, 4 data tests, 424 macros
[0m10:02:25.502174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f671f99c-566b-4636-9bff-868c556c591f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105551010>]}
[0m10:02:25.502868 [info ] [MainThread]: 
[0m10:02:25.503028 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:02:25.503153 [info ] [MainThread]: 
[0m10:02:25.503361 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:02:25.503722 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:02:25.535410 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:02:25.535603 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:02:25.535732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:25.546685 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:02:25.547354 [debug] [ThreadPool]: On list_dev: Close
[0m10:02:25.548890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:02:25.549111 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:02:25.551937 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:02:25.552081 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:02:25.552200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:25.555397 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:02:25.555989 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:02:25.556113 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:02:25.556288 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:02:25.556408 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:02:25.556523 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:02:25.556982 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:02:25.557368 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:02:25.557489 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:02:25.557595 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:02:25.557775 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:02:25.557897 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:02:25.560813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:02:25.565372 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:02:25.565530 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:02:25.565645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:25.568850 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:02:25.568995 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:02:25.569124 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:02:25.587435 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:02:25.588084 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:02:25.588811 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:02:25.588942 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:02:25.590465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f671f99c-566b-4636-9bff-868c556c591f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105513790>]}
[0m10:02:25.590668 [debug] [MainThread]: Using duckdb connection "master"
[0m10:02:25.590784 [debug] [MainThread]: On master: BEGIN
[0m10:02:25.590888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:02:25.593879 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:02:25.594028 [debug] [MainThread]: On master: COMMIT
[0m10:02:25.594155 [debug] [MainThread]: Using duckdb connection "master"
[0m10:02:25.594263 [debug] [MainThread]: On master: COMMIT
[0m10:02:25.594429 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:02:25.594552 [debug] [MainThread]: On master: Close
[0m10:02:25.595633 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m10:02:25.595855 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_entity ................................... [RUN]
[0m10:02:25.596052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_entity)
[0m10:02:25.596200 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m10:02:25.599204 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m10:02:25.599502 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m10:02:25.614372 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m10:02:25.614925 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:02:25.615090 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m10:02:25.615230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:02:25.618562 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:02:25.618733 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:02:25.618890 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw
    );
  
  
[0m10:02:25.621635 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:02:25.624287 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:02:25.624455 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity__dbt_tmp" rename to "stg_entity"
[0m10:02:25.625013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:02:25.630622 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m10:02:25.630786 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:02:25.630921 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m10:02:25.631674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:02:25.633753 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:02:25.633911 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
drop table if exists "dev"."main"."stg_entity__dbt_backup" cascade
[0m10:02:25.634157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:02:25.635138 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m10:02:25.645125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f671f99c-566b-4636-9bff-868c556c591f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556e5d0>]}
[0m10:02:25.645607 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.stg_entity .............................. [[32mOK[0m in 0.05s]
[0m10:02:25.645889 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m10:02:25.646418 [debug] [MainThread]: Using duckdb connection "master"
[0m10:02:25.646551 [debug] [MainThread]: On master: BEGIN
[0m10:02:25.646663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:02:25.649828 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:02:25.649979 [debug] [MainThread]: On master: COMMIT
[0m10:02:25.650104 [debug] [MainThread]: Using duckdb connection "master"
[0m10:02:25.650212 [debug] [MainThread]: On master: COMMIT
[0m10:02:25.650383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:02:25.650505 [debug] [MainThread]: On master: Close
[0m10:02:25.651239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:25.651348 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m10:02:25.651470 [info ] [MainThread]: 
[0m10:02:25.651606 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m10:02:25.651934 [debug] [MainThread]: Command end result
[0m10:02:25.661966 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:02:25.662694 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:02:25.665132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m10:02:25.665275 [info ] [MainThread]: 
[0m10:02:25.665452 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:02:25.665585 [info ] [MainThread]: 
[0m10:02:25.665728 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:02:25.666001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6327024, "process_in_blocks": "0", "process_kernel_time": 0.177082, "process_mem_max_rss": "138477568", "process_out_blocks": "0", "process_user_time": 0.960113}
[0m10:02:25.666185 [debug] [MainThread]: Command `dbt run` succeeded at 10:02:25.666147 after 0.63 seconds
[0m10:02:25.666339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054e2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f768f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f74af0>]}
[0m10:02:25.666488 [debug] [MainThread]: Flushing usage events
[0m10:02:25.860419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:16.698257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104048980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4fc50>]}


============================== 10:03:16.701075 | 29887e81-ef8c-43d0-b5ad-821216198263 ==============================
[0m10:03:16.701075 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:03:16.701374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/prashulkumar/.dbt', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select final_entity', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:16.859990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29887e81-ef8c-43d0-b5ad-821216198263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060408a0>]}
[0m10:03:16.882372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29887e81-ef8c-43d0-b5ad-821216198263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d45bf0>]}
[0m10:03:16.883939 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:03:16.936570 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:03:16.999684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:16.999872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:17.019500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29887e81-ef8c-43d0-b5ad-821216198263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644d250>]}
[0m10:03:17.053789 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:03:17.054886 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:03:17.066330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29887e81-ef8c-43d0-b5ad-821216198263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ebf20>]}
[0m10:03:17.066554 [info ] [MainThread]: Found 4 models, 3 seeds, 4 data tests, 424 macros
[0m10:03:17.066715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29887e81-ef8c-43d0-b5ad-821216198263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6c670>]}
[0m10:03:17.067408 [info ] [MainThread]: 
[0m10:03:17.067572 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:03:17.067697 [info ] [MainThread]: 
[0m10:03:17.067906 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:03:17.068276 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:03:17.103989 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:03:17.104197 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:03:17.104331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:17.112307 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:03:17.112477 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m10:03:17.112858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:17.113010 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m10:03:17.113140 [info ] [MainThread]: 
[0m10:03:17.113284 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m10:03:17.113504 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.2.0/bin/duckdb (PID 47508) by user prashulkumar. See also https://duckdb.org/docs/connect/concurrency
[0m10:03:17.113786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.45038536, "process_in_blocks": "0", "process_kernel_time": 0.182693, "process_mem_max_rss": "125698048", "process_out_blocks": "0", "process_user_time": 0.768654}
[0m10:03:17.113964 [debug] [MainThread]: Command `dbt run` failed at 10:03:17.113930 after 0.45 seconds
[0m10:03:17.114116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fe8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bac410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f9b50>]}
[0m10:03:17.114266 [debug] [MainThread]: Flushing usage events
[0m10:03:17.411662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:02.902209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105944980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c47b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c47c50>]}


============================== 10:06:02.905096 | 0dfb900e-f924-4580-9e49-9749f39c09c1 ==============================
[0m10:06:02.905096 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:06:02.905419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:06:02.913878 [info ] [MainThread]: dbt version: 1.9.2
[0m10:06:02.914091 [info ] [MainThread]: python version: 3.13.2
[0m10:06:02.914232 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m10:06:02.914360 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m10:06:03.035128 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m10:06:03.035381 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m10:06:03.035536 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m10:06:03.037055 [info ] [MainThread]: adapter type: duckdb
[0m10:06:03.037235 [info ] [MainThread]: adapter version: 1.9.1
[0m10:06:03.075772 [info ] [MainThread]: Configuration:
[0m10:06:03.076015 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:06:03.076171 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:06:03.076314 [info ] [MainThread]: Required dependencies:
[0m10:06:03.076492 [debug] [MainThread]: Executing "git --help"
[0m10:06:03.083523 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:06:03.083976 [debug] [MainThread]: STDERR: "b''"
[0m10:06:03.084152 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:06:03.084308 [info ] [MainThread]: Connection:
[0m10:06:03.084461 [info ] [MainThread]:   database: dev
[0m10:06:03.084576 [info ] [MainThread]:   schema: main
[0m10:06:03.084690 [info ] [MainThread]:   path: dev.duckdb
[0m10:06:03.084798 [info ] [MainThread]:   config_options: None
[0m10:06:03.084913 [info ] [MainThread]:   extensions: None
[0m10:06:03.085024 [info ] [MainThread]:   settings: {}
[0m10:06:03.085131 [info ] [MainThread]:   external_root: .
[0m10:06:03.085239 [info ] [MainThread]:   use_credential_provider: None
[0m10:06:03.085353 [info ] [MainThread]:   attach: None
[0m10:06:03.085458 [info ] [MainThread]:   filesystems: None
[0m10:06:03.085565 [info ] [MainThread]:   remote: None
[0m10:06:03.085672 [info ] [MainThread]:   plugins: None
[0m10:06:03.085785 [info ] [MainThread]:   disable_transactions: False
[0m10:06:03.086086 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:06:03.131651 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:06:03.163324 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:06:03.163518 [debug] [MainThread]: On debug: select 1 as id
[0m10:06:03.163645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:06:03.171436 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m10:06:03.171610 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m10:06:03.171807 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:06:03.171965 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:06:03.172099 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.2.0/bin/duckdb (PID 47508) by user prashulkumar. See also https://duckdb.org/docs/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:06:03.172410 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.30797425, "process_in_blocks": "0", "process_kernel_time": 0.186215, "process_mem_max_rss": "120504320", "process_out_blocks": "0", "process_user_time": 0.669987}
[0m10:06:03.172613 [debug] [MainThread]: Command `dbt debug` failed at 10:06:03.172562 after 0.31 seconds
[0m10:06:03.172774 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:06:03.172924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c99370>]}
[0m10:06:03.173110 [debug] [MainThread]: Flushing usage events
[0m10:06:03.446835 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:15.411026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ac980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e47b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e47c50>]}


============================== 10:07:15.413767 | 2ce09891-7495-405f-bbf3-bf0bab3dbe07 ==============================
[0m10:07:15.413767 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:07:15.414069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:07:15.422393 [info ] [MainThread]: dbt version: 1.9.2
[0m10:07:15.422596 [info ] [MainThread]: python version: 3.13.2
[0m10:07:15.422805 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m10:07:15.423017 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m10:07:15.541506 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m10:07:15.541744 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m10:07:15.541906 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m10:07:15.543374 [info ] [MainThread]: adapter type: duckdb
[0m10:07:15.543552 [info ] [MainThread]: adapter version: 1.9.1
[0m10:07:15.582017 [info ] [MainThread]: Configuration:
[0m10:07:15.582240 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:07:15.582393 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:07:15.582527 [info ] [MainThread]: Required dependencies:
[0m10:07:15.582702 [debug] [MainThread]: Executing "git --help"
[0m10:07:15.596339 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:07:15.597028 [debug] [MainThread]: STDERR: "b''"
[0m10:07:15.597266 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:07:15.597435 [info ] [MainThread]: Connection:
[0m10:07:15.597600 [info ] [MainThread]:   database: dev
[0m10:07:15.597728 [info ] [MainThread]:   schema: main
[0m10:07:15.597844 [info ] [MainThread]:   path: dev.duckdb
[0m10:07:15.597959 [info ] [MainThread]:   config_options: None
[0m10:07:15.598074 [info ] [MainThread]:   extensions: None
[0m10:07:15.598192 [info ] [MainThread]:   settings: {}
[0m10:07:15.598306 [info ] [MainThread]:   external_root: .
[0m10:07:15.598415 [info ] [MainThread]:   use_credential_provider: None
[0m10:07:15.598530 [info ] [MainThread]:   attach: None
[0m10:07:15.598638 [info ] [MainThread]:   filesystems: None
[0m10:07:15.598749 [info ] [MainThread]:   remote: None
[0m10:07:15.598859 [info ] [MainThread]:   plugins: None
[0m10:07:15.598969 [info ] [MainThread]:   disable_transactions: False
[0m10:07:15.599330 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:07:15.648168 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m10:07:15.680153 [debug] [MainThread]: Using duckdb connection "debug"
[0m10:07:15.680351 [debug] [MainThread]: On debug: select 1 as id
[0m10:07:15.680480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:15.694570 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m10:07:15.695066 [debug] [MainThread]: On debug: Close
[0m10:07:15.696617 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:07:15.696796 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:07:15.697133 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3239056, "process_in_blocks": "0", "process_kernel_time": 0.177422, "process_mem_max_rss": "122699776", "process_out_blocks": "0", "process_user_time": 0.647335}
[0m10:07:15.697342 [debug] [MainThread]: Command `dbt debug` succeeded at 10:07:15.697291 after 0.32 seconds
[0m10:07:15.697489 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:07:15.697647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105277a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ef890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed79b0>]}
[0m10:07:15.697839 [debug] [MainThread]: Flushing usage events
[0m10:07:15.843063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:19.789737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110144980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11154fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11154fc50>]}


============================== 10:07:19.791681 | be9dfe48-2bf9-4cec-83cb-e2e8806a5f71 ==============================
[0m10:07:19.791681 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:07:19.791987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select final_entity', 'send_anonymous_usage_stats': 'True'}
[0m10:07:19.885862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be9dfe48-2bf9-4cec-83cb-e2e8806a5f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120408a0>]}
[0m10:07:19.907989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be9dfe48-2bf9-4cec-83cb-e2e8806a5f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111645bf0>]}
[0m10:07:19.909128 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:07:19.960446 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:07:20.024043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:20.024222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:20.043851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be9dfe48-2bf9-4cec-83cb-e2e8806a5f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11224d250>]}
[0m10:07:20.077375 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:07:20.078488 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:07:20.086646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be9dfe48-2bf9-4cec-83cb-e2e8806a5f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ebf20>]}
[0m10:07:20.086864 [info ] [MainThread]: Found 4 models, 3 seeds, 4 data tests, 424 macros
[0m10:07:20.087028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be9dfe48-2bf9-4cec-83cb-e2e8806a5f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11166c670>]}
[0m10:07:20.087757 [info ] [MainThread]: 
[0m10:07:20.087923 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:07:20.088050 [info ] [MainThread]: 
[0m10:07:20.088261 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:07:20.088626 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:07:20.110873 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:07:20.111070 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:07:20.111204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:20.119299 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m10:07:20.120276 [debug] [ThreadPool]: On list_dev: Close
[0m10:07:20.121219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:07:20.121612 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:07:20.124425 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:07:20.124568 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:07:20.124688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:20.128228 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:07:20.128922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:07:20.129049 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:07:20.129236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:07:20.129353 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:07:20.129472 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:07:20.129884 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:07:20.130300 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:07:20.130431 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:07:20.130543 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:07:20.130722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:07:20.130848 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:07:20.133595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:07:20.136064 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:07:20.136198 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:07:20.136322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:20.139408 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:07:20.139540 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:07:20.139660 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:07:20.157026 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:07:20.157649 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:07:20.158410 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:07:20.158552 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:07:20.160069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be9dfe48-2bf9-4cec-83cb-e2e8806a5f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112804050>]}
[0m10:07:20.160270 [debug] [MainThread]: Using duckdb connection "master"
[0m10:07:20.160393 [debug] [MainThread]: On master: BEGIN
[0m10:07:20.160495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:20.163653 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:07:20.163818 [debug] [MainThread]: On master: COMMIT
[0m10:07:20.163951 [debug] [MainThread]: Using duckdb connection "master"
[0m10:07:20.164063 [debug] [MainThread]: On master: COMMIT
[0m10:07:20.164234 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:07:20.164359 [debug] [MainThread]: On master: Close
[0m10:07:20.165454 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_entity
[0m10:07:20.165693 [info ] [Thread-1 (]: 1 of 1 START sql table model main.final_entity ................................. [RUN]
[0m10:07:20.165894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_entity)
[0m10:07:20.166047 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m10:07:20.169089 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m10:07:20.169743 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m10:07:20.184551 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m10:07:20.185215 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:07:20.185372 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m10:07:20.185509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:20.188667 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:07:20.188837 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:07:20.188986 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity;
    );
  
  
[0m10:07:20.192000 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity;
    );
  
  
[0m10:07:20.192185 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:07:20.192378 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: ROLLBACK
[0m10:07:20.197717 [debug] [Thread-1 (]: Failed to rollback 'model.slash_analytics_take_home.final_entity'
[0m10:07:20.197874 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: Close
[0m10:07:20.200149 [debug] [Thread-1 (]: Runtime Error in model final_entity (models/final/final_entity.sql)
  Parser Error: syntax error at or near ";"
[0m10:07:20.201011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be9dfe48-2bf9-4cec-83cb-e2e8806a5f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123fa210>]}
[0m10:07:20.201294 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.final_entity ........................ [[31mERROR[0m in 0.03s]
[0m10:07:20.201550 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m10:07:20.201788 [debug] [Thread-5 (]: Marking all children of 'model.slash_analytics_take_home.final_entity' to be skipped because of status 'error'.  Reason: Runtime Error in model final_entity (models/final/final_entity.sql)
  Parser Error: syntax error at or near ";".
[0m10:07:20.202540 [debug] [MainThread]: Using duckdb connection "master"
[0m10:07:20.202668 [debug] [MainThread]: On master: BEGIN
[0m10:07:20.202773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:20.205955 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:07:20.206098 [debug] [MainThread]: On master: COMMIT
[0m10:07:20.206221 [debug] [MainThread]: Using duckdb connection "master"
[0m10:07:20.206340 [debug] [MainThread]: On master: COMMIT
[0m10:07:20.206522 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:07:20.206642 [debug] [MainThread]: On master: Close
[0m10:07:20.207385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:20.207508 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m10:07:20.207632 [info ] [MainThread]: 
[0m10:07:20.207769 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m10:07:20.208044 [debug] [MainThread]: Command end result
[0m10:07:20.217429 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:07:20.218483 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:07:20.221399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m10:07:20.221550 [info ] [MainThread]: 
[0m10:07:20.221716 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:07:20.221852 [info ] [MainThread]: 
[0m10:07:20.222013 [error] [MainThread]:   Runtime Error in model final_entity (models/final/final_entity.sql)
  Parser Error: syntax error at or near ";"
[0m10:07:20.222139 [info ] [MainThread]: 
[0m10:07:20.222269 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:07:20.222545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.461416, "process_in_blocks": "0", "process_kernel_time": 0.130516, "process_mem_max_rss": "136085504", "process_out_blocks": "0", "process_user_time": 0.853703}
[0m10:07:20.222722 [debug] [MainThread]: Command `dbt run` failed at 10:07:20.222687 after 0.46 seconds
[0m10:07:20.222895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ea200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112883bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112880190>]}
[0m10:07:20.223047 [debug] [MainThread]: Flushing usage events
[0m10:07:20.379295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:30.478006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e48980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644fc50>]}


============================== 10:07:30.480474 | f29405f2-b206-488e-be59-35c4b8651a7e ==============================
[0m10:07:30.480474 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:07:30.480774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select final_entity', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:07:30.632938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f29405f2-b206-488e-be59-35c4b8651a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069408a0>]}
[0m10:07:30.657273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f29405f2-b206-488e-be59-35c4b8651a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106545bf0>]}
[0m10:07:30.659132 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:07:30.710766 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:07:30.771197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:07:30.771485 [debug] [MainThread]: Partial parsing: updated file: slash_analytics_take_home://models/final/final_entity.sql
[0m10:07:30.877588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f29405f2-b206-488e-be59-35c4b8651a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4e050>]}
[0m10:07:30.908974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:07:30.909992 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:07:30.919634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f29405f2-b206-488e-be59-35c4b8651a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069eba70>]}
[0m10:07:30.919854 [info ] [MainThread]: Found 4 models, 3 seeds, 4 data tests, 424 macros
[0m10:07:30.920013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f29405f2-b206-488e-be59-35c4b8651a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e449f0>]}
[0m10:07:30.920684 [info ] [MainThread]: 
[0m10:07:30.920843 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:07:30.920967 [info ] [MainThread]: 
[0m10:07:30.921168 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:07:30.921517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:07:30.945924 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:07:30.946116 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:07:30.946251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:30.963846 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:07:30.964993 [debug] [ThreadPool]: On list_dev: Close
[0m10:07:30.966550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:07:30.966754 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:07:30.969685 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:07:30.969838 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:07:30.969960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:30.973401 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:07:30.974110 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:07:30.974240 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:07:30.974418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:07:30.974537 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:07:30.974651 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:07:30.975428 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m10:07:30.975777 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:07:30.975905 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:07:30.976014 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:07:30.976183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:07:30.976301 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:07:30.979252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:07:30.983439 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:07:30.983583 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:07:30.983696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:30.986856 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:07:30.987008 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:07:30.987149 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:07:31.005749 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m10:07:31.006539 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:07:31.007351 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:07:31.007481 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:07:31.009099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f29405f2-b206-488e-be59-35c4b8651a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e07790>]}
[0m10:07:31.009329 [debug] [MainThread]: Using duckdb connection "master"
[0m10:07:31.009455 [debug] [MainThread]: On master: BEGIN
[0m10:07:31.009560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:31.012516 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:07:31.012663 [debug] [MainThread]: On master: COMMIT
[0m10:07:31.012788 [debug] [MainThread]: Using duckdb connection "master"
[0m10:07:31.012905 [debug] [MainThread]: On master: COMMIT
[0m10:07:31.013069 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:07:31.013189 [debug] [MainThread]: On master: Close
[0m10:07:31.014296 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_entity
[0m10:07:31.014527 [info ] [Thread-1 (]: 1 of 1 START sql table model main.final_entity ................................. [RUN]
[0m10:07:31.014725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_entity)
[0m10:07:31.014881 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m10:07:31.018013 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m10:07:31.018333 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m10:07:31.033158 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m10:07:31.033540 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:07:31.033687 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m10:07:31.033817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:31.036953 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:07:31.037128 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:07:31.037279 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m10:07:31.040778 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:07:31.043295 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:07:31.043457 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m10:07:31.044375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:07:31.049816 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m10:07:31.049975 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:07:31.050108 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m10:07:31.050991 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:07:31.053028 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:07:31.053182 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m10:07:31.053618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:07:31.054648 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: Close
[0m10:07:31.067351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f29405f2-b206-488e-be59-35c4b8651a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5e5d0>]}
[0m10:07:31.067655 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.05s]
[0m10:07:31.067922 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m10:07:31.068467 [debug] [MainThread]: Using duckdb connection "master"
[0m10:07:31.068618 [debug] [MainThread]: On master: BEGIN
[0m10:07:31.068738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:31.071862 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:07:31.072010 [debug] [MainThread]: On master: COMMIT
[0m10:07:31.072134 [debug] [MainThread]: Using duckdb connection "master"
[0m10:07:31.072242 [debug] [MainThread]: On master: COMMIT
[0m10:07:31.072412 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:07:31.072529 [debug] [MainThread]: On master: Close
[0m10:07:31.073258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:31.073377 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m10:07:31.073504 [info ] [MainThread]: 
[0m10:07:31.073642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m10:07:31.073988 [debug] [MainThread]: Command end result
[0m10:07:31.083443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:07:31.084290 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:07:31.086710 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m10:07:31.086859 [info ] [MainThread]: 
[0m10:07:31.087035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:31.087165 [info ] [MainThread]: 
[0m10:07:31.087312 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:07:31.087591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6397926, "process_in_blocks": "0", "process_kernel_time": 0.159866, "process_mem_max_rss": "141328384", "process_out_blocks": "0", "process_user_time": 0.972538}
[0m10:07:31.087778 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:31.087739 after 0.64 seconds
[0m10:07:31.087946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dced00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065628f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106563c50>]}
[0m10:07:31.088106 [debug] [MainThread]: Flushing usage events
[0m10:07:31.284979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:17:42.830972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035ec980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104433b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104433c50>]}


============================== 10:17:42.833736 | ba9b6e7c-8d40-48f7-a008-e058d715b4c6 ==============================
[0m10:17:42.833736 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:17:42.834041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_entity', 'send_anonymous_usage_stats': 'True'}
[0m10:17:42.991531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba9b6e7c-8d40-48f7-a008-e058d715b4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046248a0>]}
[0m10:17:43.014102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba9b6e7c-8d40-48f7-a008-e058d715b4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104529bf0>]}
[0m10:17:43.015715 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:17:43.067514 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:17:43.110091 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:17:43.110344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ba9b6e7c-8d40-48f7-a008-e058d715b4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ff650>]}
[0m10:17:43.642718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba9b6e7c-8d40-48f7-a008-e058d715b4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10445bc50>]}
[0m10:17:43.674661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:17:43.675692 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:17:43.688116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba9b6e7c-8d40-48f7-a008-e058d715b4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046620b0>]}
[0m10:17:43.688328 [info ] [MainThread]: Found 4 models, 3 seeds, 4 data tests, 424 macros
[0m10:17:43.688493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba9b6e7c-8d40-48f7-a008-e058d715b4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a1300>]}
[0m10:17:43.689173 [info ] [MainThread]: 
[0m10:17:43.689334 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:17:43.689456 [info ] [MainThread]: 
[0m10:17:43.689659 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:17:43.690024 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:17:43.725164 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:17:43.725364 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:17:43.725496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:43.741101 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:17:43.742086 [debug] [ThreadPool]: On list_dev: Close
[0m10:17:43.743486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:17:43.743707 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:17:43.746512 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:17:43.746664 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:17:43.746803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:43.750490 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:17:43.751066 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:17:43.751185 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:17:43.751368 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:17:43.751484 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:17:43.751603 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:17:43.752131 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:17:43.752473 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:17:43.752589 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:17:43.752694 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:17:43.752863 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:17:43.752983 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:17:43.755932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:17:43.758447 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:17:43.758588 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:17:43.758703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:43.761727 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:17:43.761864 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:17:43.761987 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:17:43.777761 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:17:43.778413 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:17:43.779142 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:17:43.779287 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:17:43.780893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba9b6e7c-8d40-48f7-a008-e058d715b4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bda210>]}
[0m10:17:43.781096 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:43.781222 [debug] [MainThread]: On master: BEGIN
[0m10:17:43.781338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:43.784370 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:17:43.784518 [debug] [MainThread]: On master: COMMIT
[0m10:17:43.784645 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:43.784755 [debug] [MainThread]: On master: COMMIT
[0m10:17:43.784919 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:17:43.785043 [debug] [MainThread]: On master: Close
[0m10:17:43.786086 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m10:17:43.786299 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_entity ................................... [RUN]
[0m10:17:43.786493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_entity)
[0m10:17:43.786642 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m10:17:43.789607 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.790064 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m10:17:43.801565 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.801740 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m10:17:43.801878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:43.805143 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:17:43.805299 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.805441 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount;
      
[0m10:17:43.805897 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:43.809668 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.810020 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.810187 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw
    );
  
  
[0m10:17:43.812826 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:17:43.815257 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.815419 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity" rename to "stg_entity__dbt_backup"
[0m10:17:43.815739 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:43.816994 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.817146 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity__dbt_tmp" rename to "stg_entity"
[0m10:17:43.817387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:43.819479 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.819635 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."stg_entity" (entity_id, subaccount_id);
      
[0m10:17:43.820019 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:43.825198 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m10:17:43.825367 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.825506 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m10:17:43.827808 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:17:43.829701 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:17:43.829859 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
drop table if exists "dev"."main"."stg_entity__dbt_backup" cascade
[0m10:17:43.830172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:17:43.831161 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m10:17:43.842984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba9b6e7c-8d40-48f7-a008-e058d715b4c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bafac0>]}
[0m10:17:43.843284 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.stg_entity .............................. [[32mOK[0m in 0.05s]
[0m10:17:43.843533 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m10:17:43.844049 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:43.844205 [debug] [MainThread]: On master: BEGIN
[0m10:17:43.844323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:43.847535 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:17:43.847687 [debug] [MainThread]: On master: COMMIT
[0m10:17:43.847825 [debug] [MainThread]: Using duckdb connection "master"
[0m10:17:43.847950 [debug] [MainThread]: On master: COMMIT
[0m10:17:43.848132 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:17:43.848270 [debug] [MainThread]: On master: Close
[0m10:17:43.849048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:43.849206 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m10:17:43.849344 [info ] [MainThread]: 
[0m10:17:43.849495 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:17:43.849820 [debug] [MainThread]: Command end result
[0m10:17:43.858947 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:17:43.859617 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:17:43.862250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m10:17:43.862404 [info ] [MainThread]: 
[0m10:17:43.862580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:43.862709 [info ] [MainThread]: 
[0m10:17:43.862850 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:43.863122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.06707, "process_in_blocks": "0", "process_kernel_time": 0.194034, "process_mem_max_rss": "144850944", "process_out_blocks": "0", "process_user_time": 1.360531}
[0m10:17:43.863297 [debug] [MainThread]: Command `dbt run` succeeded at 10:17:43.863259 after 1.07 seconds
[0m10:17:43.863448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eeaad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b39250>]}
[0m10:17:43.863602 [debug] [MainThread]: Flushing usage events
[0m10:17:44.153803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:01.111222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107880980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c3c50>]}


============================== 10:19:01.114084 | d7c8e478-63fe-4555-bc4b-9aa6c0a62283 ==============================
[0m10:19:01.114084 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:19:01.114396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_entity', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:19:01.275242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7c8e478-63fe-4555-bc4b-9aa6c0a62283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b48a0>]}
[0m10:19:01.298856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7c8e478-63fe-4555-bc4b-9aa6c0a62283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b9bf0>]}
[0m10:19:01.300523 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:19:01.351776 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:19:01.394371 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:19:01.394607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7c8e478-63fe-4555-bc4b-9aa6c0a62283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878fb50>]}
[0m10:19:01.922145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7c8e478-63fe-4555-bc4b-9aa6c0a62283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a6bc50>]}
[0m10:19:01.954901 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:19:01.956392 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:19:01.968349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7c8e478-63fe-4555-bc4b-9aa6c0a62283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e2890>]}
[0m10:19:01.968567 [info ] [MainThread]: Found 4 models, 3 seeds, 4 data tests, 424 macros
[0m10:19:01.968732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c8e478-63fe-4555-bc4b-9aa6c0a62283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a318b0>]}
[0m10:19:01.969428 [info ] [MainThread]: 
[0m10:19:01.969589 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:19:01.969715 [info ] [MainThread]: 
[0m10:19:01.969916 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:19:01.970267 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:19:02.005272 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:19:02.005471 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:19:02.005607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:02.022369 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m10:19:02.023320 [debug] [ThreadPool]: On list_dev: Close
[0m10:19:02.024781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:19:02.025170 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:19:02.027998 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:19:02.028148 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:19:02.028270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:02.031839 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:19:02.032464 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:19:02.032602 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:19:02.032797 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:19:02.032922 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:19:02.033045 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:19:02.033596 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:19:02.034023 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:19:02.034173 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:19:02.034298 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:19:02.034474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:19:02.034599 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:19:02.037606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:19:02.040222 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:19:02.040369 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:19:02.040485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:02.043660 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:19:02.043807 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:19:02.043944 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:19:02.060029 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m10:19:02.060681 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:19:02.061412 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:19:02.061563 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:19:02.063135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c8e478-63fe-4555-bc4b-9aa6c0a62283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de1d90>]}
[0m10:19:02.063346 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:02.063482 [debug] [MainThread]: On master: BEGIN
[0m10:19:02.063594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:02.066829 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:19:02.066985 [debug] [MainThread]: On master: COMMIT
[0m10:19:02.067112 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:02.067229 [debug] [MainThread]: On master: COMMIT
[0m10:19:02.067399 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:19:02.067518 [debug] [MainThread]: On master: Close
[0m10:19:02.068608 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m10:19:02.068824 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_entity ................................... [RUN]
[0m10:19:02.069016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_entity)
[0m10:19:02.069166 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m10:19:02.072160 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.072764 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m10:19:02.084219 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.084404 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m10:19:02.084560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:02.087756 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:19:02.087916 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.088053 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount;
      
[0m10:19:02.088584 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:02.092426 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.092757 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.092926 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw
    );
  
  
[0m10:19:02.095434 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:19:02.097859 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.098030 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity" rename to "stg_entity__dbt_backup"
[0m10:19:02.098567 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:02.099810 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.099953 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity__dbt_tmp" rename to "stg_entity"
[0m10:19:02.100198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:02.106600 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m10:19:02.106763 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.106903 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m10:19:02.107496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:02.109368 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m10:19:02.109528 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
drop table if exists "dev"."main"."stg_entity__dbt_backup" cascade
[0m10:19:02.109825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:02.110816 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m10:19:02.124541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c8e478-63fe-4555-bc4b-9aa6c0a62283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e47960>]}
[0m10:19:02.124846 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.stg_entity .............................. [[32mOK[0m in 0.05s]
[0m10:19:02.125109 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m10:19:02.125625 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:02.125759 [debug] [MainThread]: On master: BEGIN
[0m10:19:02.125872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:02.129039 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:19:02.129190 [debug] [MainThread]: On master: COMMIT
[0m10:19:02.129319 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:02.129426 [debug] [MainThread]: On master: COMMIT
[0m10:19:02.129594 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:19:02.129717 [debug] [MainThread]: On master: Close
[0m10:19:02.130454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:02.130610 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m10:19:02.130750 [info ] [MainThread]: 
[0m10:19:02.130894 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:19:02.131223 [debug] [MainThread]: Command end result
[0m10:19:02.140561 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:19:02.141280 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:19:02.143698 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m10:19:02.143885 [info ] [MainThread]: 
[0m10:19:02.144111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:02.144298 [info ] [MainThread]: 
[0m10:19:02.144466 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:19:02.144749 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.070341, "process_in_blocks": "0", "process_kernel_time": 0.19634, "process_mem_max_rss": "140820480", "process_out_blocks": "0", "process_user_time": 1.355778}
[0m10:19:02.144932 [debug] [MainThread]: Command `dbt run` succeeded at 10:19:02.144894 after 1.07 seconds
[0m10:19:02.145087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e09c50>]}
[0m10:19:02.145238 [debug] [MainThread]: Flushing usage events
[0m10:19:02.411638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:11.413034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106948980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4fc50>]}


============================== 10:19:11.415640 | 050c3237-bbda-407e-bbc3-d24f5f25906b ==============================
[0m10:19:11.415640 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:19:11.415947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select final_entity', 'send_anonymous_usage_stats': 'True'}
[0m10:19:11.509860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '050c3237-bbda-407e-bbc3-d24f5f25906b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f408a0>]}
[0m10:19:11.532005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '050c3237-bbda-407e-bbc3-d24f5f25906b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d45bf0>]}
[0m10:19:11.534355 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m10:19:11.584536 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:19:11.644399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:11.644595 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:11.664332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '050c3237-bbda-407e-bbc3-d24f5f25906b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110251750>]}
[0m10:19:11.699109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:19:11.700070 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:19:11.712127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '050c3237-bbda-407e-bbc3-d24f5f25906b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107febf20>]}
[0m10:19:11.712356 [info ] [MainThread]: Found 4 models, 3 seeds, 4 data tests, 424 macros
[0m10:19:11.712522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050c3237-bbda-407e-bbc3-d24f5f25906b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6c670>]}
[0m10:19:11.713226 [info ] [MainThread]: 
[0m10:19:11.713395 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m10:19:11.713518 [info ] [MainThread]: 
[0m10:19:11.713741 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:19:11.714117 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m10:19:11.739594 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m10:19:11.739794 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m10:19:11.739930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:11.744447 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m10:19:11.745083 [debug] [ThreadPool]: On list_dev: Close
[0m10:19:11.746137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m10:19:11.746347 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m10:19:11.749211 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:19:11.749366 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m10:19:11.749487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:11.752761 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:19:11.753390 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:19:11.753515 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m10:19:11.753694 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:19:11.753806 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:19:11.753914 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m10:19:11.754108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:19:11.754441 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:19:11.754556 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m10:19:11.754658 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m10:19:11.754818 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:19:11.754930 [debug] [ThreadPool]: On create_dev_main: Close
[0m10:19:11.757790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m10:19:11.760394 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:19:11.760536 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m10:19:11.760645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:11.764073 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:19:11.764210 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m10:19:11.764331 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m10:19:11.778406 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m10:19:11.779044 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m10:19:11.779956 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m10:19:11.780094 [debug] [ThreadPool]: On list_dev_main: Close
[0m10:19:11.781704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050c3237-bbda-407e-bbc3-d24f5f25906b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111010050>]}
[0m10:19:11.781934 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:11.782104 [debug] [MainThread]: On master: BEGIN
[0m10:19:11.782235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:11.785446 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:19:11.785589 [debug] [MainThread]: On master: COMMIT
[0m10:19:11.785705 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:11.785812 [debug] [MainThread]: On master: COMMIT
[0m10:19:11.785979 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:19:11.786096 [debug] [MainThread]: On master: Close
[0m10:19:11.787204 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_entity
[0m10:19:11.787412 [info ] [Thread-1 (]: 1 of 1 START sql table model main.final_entity ................................. [RUN]
[0m10:19:11.787611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_entity)
[0m10:19:11.787756 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m10:19:11.790821 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m10:19:11.791345 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m10:19:11.803223 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:19:11.803407 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m10:19:11.803544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:11.807000 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:19:11.807165 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:19:11.807307 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount;
      
[0m10:19:11.807540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:11.811449 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m10:19:11.811973 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:19:11.812128 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m10:19:11.813426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:19:11.815873 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:19:11.816033 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m10:19:11.816307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:11.817389 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:19:11.817530 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m10:19:11.817769 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:11.820070 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:19:11.820230 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id);
      
[0m10:19:11.820641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:11.825711 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m10:19:11.825879 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:19:11.826018 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m10:19:11.828641 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m10:19:11.830561 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m10:19:11.830716 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m10:19:11.831013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m10:19:11.831986 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: Close
[0m10:19:11.843611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '050c3237-bbda-407e-bbc3-d24f5f25906b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104fa150>]}
[0m10:19:11.843907 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.05s]
[0m10:19:11.844160 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m10:19:11.844684 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:11.844812 [debug] [MainThread]: On master: BEGIN
[0m10:19:11.844921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:11.848137 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m10:19:11.848283 [debug] [MainThread]: On master: COMMIT
[0m10:19:11.848406 [debug] [MainThread]: Using duckdb connection "master"
[0m10:19:11.848515 [debug] [MainThread]: On master: COMMIT
[0m10:19:11.848702 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:19:11.848857 [debug] [MainThread]: On master: Close
[0m10:19:11.849698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:11.849852 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m10:19:11.850069 [info ] [MainThread]: 
[0m10:19:11.850217 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m10:19:11.850549 [debug] [MainThread]: Command end result
[0m10:19:11.859812 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m10:19:11.860466 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m10:19:11.863033 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m10:19:11.863180 [info ] [MainThread]: 
[0m10:19:11.863376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:11.863528 [info ] [MainThread]: 
[0m10:19:11.863672 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:19:11.863949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48595166, "process_in_blocks": "0", "process_kernel_time": 0.144873, "process_mem_max_rss": "139624448", "process_out_blocks": "0", "process_user_time": 0.899016}
[0m10:19:11.864196 [debug] [MainThread]: Command `dbt run` succeeded at 10:19:11.864101 after 0.49 seconds
[0m10:19:11.864382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ea360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111006030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111005770>]}
[0m10:19:11.864547 [debug] [MainThread]: Flushing usage events
[0m10:19:12.016812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:28.766379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081dc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109017b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109017c50>]}


============================== 12:08:28.769120 | d137fa6d-fc62-49b7-90d1-1b7ac3858643 ==============================
[0m12:08:28.769120 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:08:28.769429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:08:28.778534 [info ] [MainThread]: dbt version: 1.9.2
[0m12:08:28.778794 [info ] [MainThread]: python version: 3.13.2
[0m12:08:28.778938 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m12:08:28.779072 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m12:08:28.916207 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m12:08:28.916450 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m12:08:28.916623 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m12:08:28.918140 [info ] [MainThread]: adapter type: duckdb
[0m12:08:28.918320 [info ] [MainThread]: adapter version: 1.9.1
[0m12:08:28.957491 [info ] [MainThread]: Configuration:
[0m12:08:28.957729 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:08:28.957881 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:08:28.958018 [info ] [MainThread]: Required dependencies:
[0m12:08:28.958196 [debug] [MainThread]: Executing "git --help"
[0m12:08:28.964409 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:08:28.964893 [debug] [MainThread]: STDERR: "b''"
[0m12:08:28.965078 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:08:28.965236 [info ] [MainThread]: Connection:
[0m12:08:28.965387 [info ] [MainThread]:   database: dev
[0m12:08:28.965511 [info ] [MainThread]:   schema: main
[0m12:08:28.965621 [info ] [MainThread]:   path: dev.duckdb
[0m12:08:28.965732 [info ] [MainThread]:   config_options: None
[0m12:08:28.965838 [info ] [MainThread]:   extensions: None
[0m12:08:28.965954 [info ] [MainThread]:   settings: {}
[0m12:08:28.966061 [info ] [MainThread]:   external_root: .
[0m12:08:28.966165 [info ] [MainThread]:   use_credential_provider: None
[0m12:08:28.966276 [info ] [MainThread]:   attach: None
[0m12:08:28.966379 [info ] [MainThread]:   filesystems: None
[0m12:08:28.966589 [info ] [MainThread]:   remote: None
[0m12:08:28.966926 [info ] [MainThread]:   plugins: None
[0m12:08:28.967119 [info ] [MainThread]:   disable_transactions: False
[0m12:08:28.967678 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m12:08:29.016647 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:08:29.050851 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:08:29.051034 [debug] [MainThread]: On debug: select 1 as id
[0m12:08:29.051163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:29.067019 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m12:08:29.067503 [debug] [MainThread]: On debug: Close
[0m12:08:29.069019 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:08:29.069196 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:08:29.069531 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.34106207, "process_in_blocks": "0", "process_kernel_time": 0.175013, "process_mem_max_rss": "123846656", "process_out_blocks": "0", "process_user_time": 0.647847}
[0m12:08:29.069743 [debug] [MainThread]: Command `dbt debug` succeeded at 12:08:29.069691 after 0.34 seconds
[0m12:08:29.069890 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:08:29.070053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109247a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a79b0>]}
[0m12:08:29.070243 [debug] [MainThread]: Flushing usage events
[0m12:08:29.672377 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:47.478159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebfc50>]}


============================== 12:10:47.481177 | 6a6cca90-4f1b-4ef6-bce9-a3883924f9fb ==============================
[0m12:10:47.481177 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:10:47.481496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_entity', 'send_anonymous_usage_stats': 'True'}
[0m12:10:47.643608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a6cca90-4f1b-4ef6-bce9-a3883924f9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b08a0>]}
[0m12:10:47.667435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a6cca90-4f1b-4ef6-bce9-a3883924f9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb9bf0>]}
[0m12:10:47.669165 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m12:10:47.721351 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:10:47.763486 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:10:47.763747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a6cca90-4f1b-4ef6-bce9-a3883924f9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8bb50>]}
[0m12:10:48.292901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a6cca90-4f1b-4ef6-bce9-a3883924f9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725d310>]}
[0m12:10:48.325872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m12:10:48.326936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m12:10:48.339262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a6cca90-4f1b-4ef6-bce9-a3883924f9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c6350>]}
[0m12:10:48.339484 [info ] [MainThread]: Found 6 models, 3 seeds, 4 data tests, 424 macros
[0m12:10:48.339647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a6cca90-4f1b-4ef6-bce9-a3883924f9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722d7e0>]}
[0m12:10:48.340346 [info ] [MainThread]: 
[0m12:10:48.340506 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m12:10:48.340631 [info ] [MainThread]: 
[0m12:10:48.340835 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:10:48.341196 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:10:48.376313 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:10:48.376510 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m12:10:48.376641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:48.393601 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:10:48.394815 [debug] [ThreadPool]: On list_dev: Close
[0m12:10:48.396604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:10:48.396857 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:10:48.399993 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:10:48.400146 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m12:10:48.400266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:48.403812 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m12:10:48.404546 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:10:48.404685 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:10:48.404867 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:10:48.404987 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:10:48.405104 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:10:48.405898 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:10:48.406257 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:10:48.406387 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:10:48.406503 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:10:48.406683 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:10:48.406803 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:10:48.409957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m12:10:48.412542 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:10:48.412689 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:10:48.412802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:48.416087 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:10:48.416238 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:10:48.416374 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m12:10:48.433363 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:10:48.433962 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:10:48.434746 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:10:48.434893 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:10:48.436463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a6cca90-4f1b-4ef6-bce9-a3883924f9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766e150>]}
[0m12:10:48.436671 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:48.436789 [debug] [MainThread]: On master: BEGIN
[0m12:10:48.436893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:48.439890 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:10:48.440041 [debug] [MainThread]: On master: COMMIT
[0m12:10:48.440167 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:48.440281 [debug] [MainThread]: On master: COMMIT
[0m12:10:48.440448 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:10:48.440569 [debug] [MainThread]: On master: Close
[0m12:10:48.441653 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m12:10:48.441877 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_entity ................................... [RUN]
[0m12:10:48.442079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_entity)
[0m12:10:48.442233 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m12:10:48.445244 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m12:10:48.445844 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m12:10:48.460867 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m12:10:48.461482 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m12:10:48.461654 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m12:10:48.461799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:48.465158 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:10:48.465330 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m12:10:48.465485 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw
    );
  
  
[0m12:10:48.468181 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:10:48.470641 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m12:10:48.470810 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity" rename to "stg_entity__dbt_backup"
[0m12:10:48.471375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:10:48.472662 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m12:10:48.472818 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity__dbt_tmp" rename to "stg_entity"
[0m12:10:48.473067 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:10:48.479489 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m12:10:48.479656 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m12:10:48.479798 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m12:10:48.480414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:10:48.482306 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m12:10:48.482463 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
drop table if exists "dev"."main"."stg_entity__dbt_backup" cascade
[0m12:10:48.482783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:10:48.483769 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m12:10:48.494819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a6cca90-4f1b-4ef6-bce9-a3883924f9fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763fac0>]}
[0m12:10:48.495098 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.stg_entity .............................. [[32mOK[0m in 0.05s]
[0m12:10:48.495349 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m12:10:48.495864 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:48.496023 [debug] [MainThread]: On master: BEGIN
[0m12:10:48.496145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:48.499437 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:10:48.499570 [debug] [MainThread]: On master: COMMIT
[0m12:10:48.499691 [debug] [MainThread]: Using duckdb connection "master"
[0m12:10:48.499808 [debug] [MainThread]: On master: COMMIT
[0m12:10:48.499984 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:10:48.500103 [debug] [MainThread]: On master: Close
[0m12:10:48.500808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:48.500935 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m12:10:48.501056 [info ] [MainThread]: 
[0m12:10:48.501192 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m12:10:48.501505 [debug] [MainThread]: Command end result
[0m12:10:48.511043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m12:10:48.511720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m12:10:48.514206 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m12:10:48.514356 [info ] [MainThread]: 
[0m12:10:48.514526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:48.514659 [info ] [MainThread]: 
[0m12:10:48.514795 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:10:48.515063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0735615, "process_in_blocks": "0", "process_kernel_time": 0.19082, "process_mem_max_rss": "143851520", "process_out_blocks": "0", "process_user_time": 1.373273}
[0m12:10:48.515249 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:48.515206 after 1.07 seconds
[0m12:10:48.515408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107683bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073149d0>]}
[0m12:10:48.515611 [debug] [MainThread]: Flushing usage events
[0m12:10:49.064010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:24.943745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106088980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecbc50>]}


============================== 13:02:24.946839 | 1800f307-43f7-4cce-b5ef-1ddbb239ae18 ==============================
[0m13:02:24.946839 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:02:24.947179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_entity', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:02:25.109527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1800f307-43f7-4cce-b5ef-1ddbb239ae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bc8a0>]}
[0m13:02:25.132264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1800f307-43f7-4cce-b5ef-1ddbb239ae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc5bf0>]}
[0m13:02:25.133965 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:02:25.184900 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:02:25.249662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:02:25.249844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:02:25.269840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1800f307-43f7-4cce-b5ef-1ddbb239ae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cdd50>]}
[0m13:02:25.304314 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m13:02:25.305463 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m13:02:25.317588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1800f307-43f7-4cce-b5ef-1ddbb239ae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107167f20>]}
[0m13:02:25.317817 [info ] [MainThread]: Found 6 models, 3 seeds, 4 data tests, 424 macros
[0m13:02:25.317989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1800f307-43f7-4cce-b5ef-1ddbb239ae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe8670>]}
[0m13:02:25.318710 [info ] [MainThread]: 
[0m13:02:25.318878 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:02:25.319002 [info ] [MainThread]: 
[0m13:02:25.319218 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:02:25.319596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:02:25.356426 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:02:25.356614 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:02:25.356746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:25.372654 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:02:25.373360 [debug] [ThreadPool]: On list_dev: Close
[0m13:02:25.374881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:02:25.375274 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:02:25.378255 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:02:25.378405 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:02:25.378523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:25.382053 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:02:25.382656 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:02:25.382790 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:02:25.382968 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:02:25.383084 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:02:25.383198 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:02:25.383907 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:02:25.384294 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:02:25.384422 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:02:25.384532 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:02:25.384707 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:02:25.384829 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:02:25.387682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:02:25.390200 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:02:25.390337 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:02:25.390444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:02:25.393552 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:02:25.393700 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:02:25.393831 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:02:25.411077 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:02:25.411707 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:02:25.412462 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:02:25.412591 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:02:25.414195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1800f307-43f7-4cce-b5ef-1ddbb239ae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f7520>]}
[0m13:02:25.414407 [debug] [MainThread]: Using duckdb connection "master"
[0m13:02:25.414528 [debug] [MainThread]: On master: BEGIN
[0m13:02:25.414632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:25.417723 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:02:25.417868 [debug] [MainThread]: On master: COMMIT
[0m13:02:25.417991 [debug] [MainThread]: Using duckdb connection "master"
[0m13:02:25.418097 [debug] [MainThread]: On master: COMMIT
[0m13:02:25.418258 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:02:25.418379 [debug] [MainThread]: On master: Close
[0m13:02:25.419439 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_entity
[0m13:02:25.419667 [info ] [Thread-1 (]: 1 of 1 START sql table model main.final_entity ................................. [RUN]
[0m13:02:25.419873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_entity)
[0m13:02:25.420023 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m13:02:25.423058 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m13:02:25.423568 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m13:02:25.435254 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:02:25.435444 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m13:02:25.435585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:25.439177 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:02:25.439359 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:02:25.439504 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m13:02:25.440205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:02:25.444031 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m13:02:25.444372 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:02:25.444533 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m13:02:25.448837 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:02:25.451422 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:02:25.451584 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m13:02:25.452249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:02:25.453302 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:02:25.453444 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m13:02:25.453682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:25.456021 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:02:25.456185 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m13:02:25.456531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:25.461533 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m13:02:25.461704 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:02:25.461845 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m13:02:25.464326 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:02:25.466231 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:02:25.466390 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m13:02:25.466686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:25.467689 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: Close
[0m13:02:25.479066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1800f307-43f7-4cce-b5ef-1ddbb239ae18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747a150>]}
[0m13:02:25.479375 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.06s]
[0m13:02:25.479636 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m13:02:25.480163 [debug] [MainThread]: Using duckdb connection "master"
[0m13:02:25.480293 [debug] [MainThread]: On master: BEGIN
[0m13:02:25.480407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:25.483629 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:02:25.483776 [debug] [MainThread]: On master: COMMIT
[0m13:02:25.483900 [debug] [MainThread]: Using duckdb connection "master"
[0m13:02:25.484010 [debug] [MainThread]: On master: COMMIT
[0m13:02:25.484179 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:02:25.484303 [debug] [MainThread]: On master: Close
[0m13:02:25.485049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:25.485179 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m13:02:25.485303 [info ] [MainThread]: 
[0m13:02:25.485443 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:02:25.485764 [debug] [MainThread]: Command end result
[0m13:02:25.495378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m13:02:25.496096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m13:02:25.498482 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m13:02:25.498629 [info ] [MainThread]: 
[0m13:02:25.498803 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:25.498932 [info ] [MainThread]: 
[0m13:02:25.499067 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:02:25.499344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5932491, "process_in_blocks": "0", "process_kernel_time": 0.196177, "process_mem_max_rss": "137904128", "process_out_blocks": "0", "process_user_time": 0.882871}
[0m13:02:25.499516 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:25.499482 after 0.59 seconds
[0m13:02:25.499670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107469700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780ba70>]}
[0m13:02:25.499820 [debug] [MainThread]: Flushing usage events
[0m13:02:25.766131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:35.200454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107448980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827fc50>]}


============================== 13:03:35.203387 | 16ba68cd-581d-4e36-a831-590ab638cd31 ==============================
[0m13:03:35.203387 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:03:35.203706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:03:35.212061 [info ] [MainThread]: dbt version: 1.9.2
[0m13:03:35.212273 [info ] [MainThread]: python version: 3.13.2
[0m13:03:35.212419 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m13:03:35.212613 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m13:03:35.332706 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m13:03:35.332953 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m13:03:35.333118 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m13:03:35.334492 [info ] [MainThread]: adapter type: duckdb
[0m13:03:35.334670 [info ] [MainThread]: adapter version: 1.9.1
[0m13:03:35.373123 [info ] [MainThread]: Configuration:
[0m13:03:35.373359 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:03:35.373533 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:03:35.373695 [info ] [MainThread]: Required dependencies:
[0m13:03:35.373926 [debug] [MainThread]: Executing "git --help"
[0m13:03:35.392331 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:03:35.392840 [debug] [MainThread]: STDERR: "b''"
[0m13:03:35.393029 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:03:35.393198 [info ] [MainThread]: Connection:
[0m13:03:35.393363 [info ] [MainThread]:   database: dev
[0m13:03:35.393491 [info ] [MainThread]:   schema: main
[0m13:03:35.393607 [info ] [MainThread]:   path: dev.duckdb
[0m13:03:35.393716 [info ] [MainThread]:   config_options: None
[0m13:03:35.393828 [info ] [MainThread]:   extensions: None
[0m13:03:35.393940 [info ] [MainThread]:   settings: {}
[0m13:03:35.394050 [info ] [MainThread]:   external_root: .
[0m13:03:35.394160 [info ] [MainThread]:   use_credential_provider: None
[0m13:03:35.394272 [info ] [MainThread]:   attach: None
[0m13:03:35.394380 [info ] [MainThread]:   filesystems: None
[0m13:03:35.394486 [info ] [MainThread]:   remote: None
[0m13:03:35.394595 [info ] [MainThread]:   plugins: None
[0m13:03:35.394701 [info ] [MainThread]:   disable_transactions: False
[0m13:03:35.395039 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:03:35.442561 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m13:03:35.473035 [debug] [MainThread]: Using duckdb connection "debug"
[0m13:03:35.473212 [debug] [MainThread]: On debug: select 1 as id
[0m13:03:35.473340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:35.491283 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m13:03:35.491787 [debug] [MainThread]: On debug: Close
[0m13:03:35.493402 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:03:35.493579 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:03:35.493919 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.33012563, "process_in_blocks": "0", "process_kernel_time": 0.173862, "process_mem_max_rss": "124583936", "process_out_blocks": "0", "process_user_time": 0.643319}
[0m13:03:35.494119 [debug] [MainThread]: Command `dbt debug` succeeded at 13:03:35.494072 after 0.33 seconds
[0m13:03:35.494266 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:03:35.494422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b3a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108527890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830f9b0>]}
[0m13:03:35.494617 [debug] [MainThread]: Flushing usage events
[0m13:03:35.657559 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:08.521395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682bc50>]}


============================== 13:04:08.524052 | 58ea8d84-70c7-4323-b419-5bbeb241d50a ==============================
[0m13:04:08.524052 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:04:08.524354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_entity', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:04:08.684873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ea8d84-70c7-4323-b419-5bbeb241d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1c8a0>]}
[0m13:04:08.707440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58ea8d84-70c7-4323-b419-5bbeb241d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106921bf0>]}
[0m13:04:08.708920 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:04:08.766127 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:04:08.835674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:08.835892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:08.856034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58ea8d84-70c7-4323-b419-5bbeb241d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2dd50>]}
[0m13:04:08.890895 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m13:04:08.892065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m13:04:08.902617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58ea8d84-70c7-4323-b419-5bbeb241d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac7f20>]}
[0m13:04:08.902848 [info ] [MainThread]: Found 6 models, 3 seeds, 4 data tests, 424 macros
[0m13:04:08.903020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ea8d84-70c7-4323-b419-5bbeb241d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106948670>]}
[0m13:04:08.903734 [info ] [MainThread]: 
[0m13:04:08.903892 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:04:08.904019 [info ] [MainThread]: 
[0m13:04:08.904234 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:04:08.904622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:04:08.932820 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:04:08.933014 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:04:08.933147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:08.948611 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:04:08.949408 [debug] [ThreadPool]: On list_dev: Close
[0m13:04:08.950887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:04:08.951293 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:04:08.954036 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:04:08.954183 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:04:08.954303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:08.957989 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:04:08.958574 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:04:08.958700 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:04:08.958883 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:04:08.958998 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:04:08.959117 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:04:08.959638 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:04:08.959989 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:04:08.960108 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:04:08.960234 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:04:08.960401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:04:08.960521 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:04:08.963362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:04:08.965823 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:04:08.965960 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:04:08.966071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:08.969155 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:04:08.969291 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:04:08.969415 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:04:08.985919 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:04:08.986701 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:04:08.987433 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:04:08.987578 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:04:08.989157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ea8d84-70c7-4323-b419-5bbeb241d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707b520>]}
[0m13:04:08.989376 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:08.989500 [debug] [MainThread]: On master: BEGIN
[0m13:04:08.989610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:08.992591 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:04:08.992742 [debug] [MainThread]: On master: COMMIT
[0m13:04:08.992871 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:08.992982 [debug] [MainThread]: On master: COMMIT
[0m13:04:08.993148 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:04:08.993274 [debug] [MainThread]: On master: Close
[0m13:04:08.994325 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m13:04:08.994552 [info ] [Thread-1 (]: 1 of 1 START sql table model main.stg_entity ................................... [RUN]
[0m13:04:08.994748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_entity)
[0m13:04:08.994898 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m13:04:08.998270 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m13:04:08.998929 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m13:04:09.014023 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m13:04:09.014754 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:09.014917 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m13:04:09.015053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:09.018291 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:04:09.018460 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:09.018615 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw
    );
  
  
[0m13:04:09.021351 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:04:09.023874 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:09.024035 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity" rename to "stg_entity__dbt_backup"
[0m13:04:09.024634 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:09.025719 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:09.025858 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity__dbt_tmp" rename to "stg_entity"
[0m13:04:09.026094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:09.032731 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m13:04:09.032898 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:09.033037 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m13:04:09.033949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:04:09.035886 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:09.036056 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
drop table if exists "dev"."main"."stg_entity__dbt_backup" cascade
[0m13:04:09.036390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:09.037383 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m13:04:09.048495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58ea8d84-70c7-4323-b419-5bbeb241d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efe390>]}
[0m13:04:09.048785 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.stg_entity .............................. [[32mOK[0m in 0.05s]
[0m13:04:09.049042 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m13:04:09.049569 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:09.049726 [debug] [MainThread]: On master: BEGIN
[0m13:04:09.049844 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:09.052948 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:04:09.053097 [debug] [MainThread]: On master: COMMIT
[0m13:04:09.053220 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:09.053324 [debug] [MainThread]: On master: COMMIT
[0m13:04:09.053484 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:04:09.053600 [debug] [MainThread]: On master: Close
[0m13:04:09.054313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:09.054466 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m13:04:09.054601 [info ] [MainThread]: 
[0m13:04:09.054753 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m13:04:09.055069 [debug] [MainThread]: Command end result
[0m13:04:09.065717 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m13:04:09.066519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m13:04:09.069127 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m13:04:09.069276 [info ] [MainThread]: 
[0m13:04:09.069446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:09.069577 [info ] [MainThread]: 
[0m13:04:09.069718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:04:09.069994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5804302, "process_in_blocks": "0", "process_kernel_time": 0.192555, "process_mem_max_rss": "134660096", "process_out_blocks": "0", "process_user_time": 0.885293}
[0m13:04:09.070170 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:09.070136 after 0.58 seconds
[0m13:04:09.070326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719b750>]}
[0m13:04:09.070473 [debug] [MainThread]: Flushing usage events
[0m13:04:09.328656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:51.748732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564fc50>]}


============================== 13:04:51.751647 | b06a2a08-d168-4925-ad3d-6f716329638b ==============================
[0m13:04:51.751647 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:04:51.751955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:04:51.902544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b06a2a08-d168-4925-ad3d-6f716329638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a408a0>]}
[0m13:04:51.926035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b06a2a08-d168-4925-ad3d-6f716329638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105849bf0>]}
[0m13:04:51.927712 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:04:51.978465 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:04:52.046738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:52.046952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:52.066763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b06a2a08-d168-4925-ad3d-6f716329638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f51d50>]}
[0m13:04:52.100773 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m13:04:52.101777 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m13:04:52.113738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b06a2a08-d168-4925-ad3d-6f716329638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aebf20>]}
[0m13:04:52.113955 [info ] [MainThread]: Found 6 models, 3 seeds, 4 data tests, 424 macros
[0m13:04:52.114123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b06a2a08-d168-4925-ad3d-6f716329638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586c670>]}
[0m13:04:52.114846 [info ] [MainThread]: 
[0m13:04:52.115018 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:04:52.115144 [info ] [MainThread]: 
[0m13:04:52.115364 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:04:52.117199 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:04:52.152857 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:04:52.153052 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:04:52.153182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:52.167478 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:04:52.168149 [debug] [ThreadPool]: On list_dev: Close
[0m13:04:52.169507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:04:52.169893 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:04:52.172687 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:04:52.172835 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:04:52.172953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:52.176460 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:04:52.177198 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:04:52.177348 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:04:52.177542 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:04:52.177676 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:04:52.177799 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:04:52.178196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:04:52.178561 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:04:52.178683 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:04:52.178787 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:04:52.178956 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:04:52.179076 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:04:52.180345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:04:52.182532 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:04:52.182668 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:04:52.182780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:52.185834 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:04:52.185979 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:04:52.186110 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:04:52.202020 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:04:52.202942 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:04:52.203728 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:04:52.203855 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:04:52.205631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b06a2a08-d168-4925-ad3d-6f716329638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c906d0>]}
[0m13:04:52.205829 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:52.205945 [debug] [MainThread]: On master: BEGIN
[0m13:04:52.206049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:52.209093 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:04:52.209245 [debug] [MainThread]: On master: COMMIT
[0m13:04:52.209370 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:52.209475 [debug] [MainThread]: On master: COMMIT
[0m13:04:52.209638 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:04:52.209755 [debug] [MainThread]: On master: Close
[0m13:04:52.210861 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_cardevents
[0m13:04:52.211028 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m13:04:52.211253 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_cardevents ............................... [RUN]
[0m13:04:52.211541 [info ] [Thread-2 (]: 2 of 2 START sql table model main.stg_entity ................................... [RUN]
[0m13:04:52.211782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_cardevents)
[0m13:04:52.211993 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.stg_entity'
[0m13:04:52.212152 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_cardevents
[0m13:04:52.212294 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m13:04:52.215337 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_cardevents"
[0m13:04:52.216287 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m13:04:52.216948 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_cardevents
[0m13:04:52.223463 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m13:04:52.233739 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m13:04:52.234416 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_cardevents"
[0m13:04:52.235039 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m13:04:52.235216 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:52.235376 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: BEGIN
[0m13:04:52.235547 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m13:04:52.235710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:52.235861 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:04:52.239162 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:04:52.239335 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m13:04:52.239480 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:04:52.239636 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */

  
    
    

    create  table
      "dev"."main"."stg_cardevents__dbt_tmp"
  
    as (
      with source as (
    select * from "dev"."main"."card_events"
)
select 
    slash_account_id,
    card_event_id,
    card_id,
    event_type,
    card_status,
    timestamp,
    case 
        when card_event_id is null then 0
        else 1
    end as is_valid
from source
    );
  
  
[0m13:04:52.239790 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:52.239995 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw
    );
  
  
[0m13:04:52.246065 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:04:52.251480 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:52.251677 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity" rename to "stg_entity__dbt_backup"
[0m13:04:52.252346 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:04:52.253613 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:52.253784 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity__dbt_tmp" rename to "stg_entity"
[0m13:04:52.254060 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:04:52.270810 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m13:04:52.271173 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:52.271448 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m13:04:52.273847 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:04:52.276392 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m13:04:52.276602 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
drop table if exists "dev"."main"."stg_entity__dbt_backup" cascade
[0m13:04:52.277269 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:04:52.279205 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m13:04:52.281759 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b06a2a08-d168-4925-ad3d-6f716329638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fdfd0>]}
[0m13:04:52.282740 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.stg_entity .............................. [[32mOK[0m in 0.07s]
[0m13:04:52.283057 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m13:04:52.917009 [debug] [Thread-1 (]: SQL status: OK in 0.677 seconds
[0m13:04:52.919386 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m13:04:52.919553 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */
alter table "dev"."main"."stg_cardevents__dbt_tmp" rename to "stg_cardevents"
[0m13:04:52.919912 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:52.920540 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: COMMIT
[0m13:04:52.920684 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m13:04:52.920815 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: COMMIT
[0m13:04:53.531642 [debug] [Thread-1 (]: SQL status: OK in 0.611 seconds
[0m13:04:53.533794 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m13:04:53.533959 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */
drop table if exists "dev"."main"."stg_cardevents__dbt_backup" cascade
[0m13:04:53.534322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:53.534949 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: Close
[0m13:04:53.653836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b06a2a08-d168-4925-ad3d-6f716329638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068edbd0>]}
[0m13:04:53.654349 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.stg_cardevents .......................... [[32mOK[0m in 1.44s]
[0m13:04:53.654637 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_cardevents
[0m13:04:53.655367 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:53.655529 [debug] [MainThread]: On master: BEGIN
[0m13:04:53.655653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:53.659338 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m13:04:53.659504 [debug] [MainThread]: On master: COMMIT
[0m13:04:53.659640 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:53.659754 [debug] [MainThread]: On master: COMMIT
[0m13:04:53.659926 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:04:53.660045 [debug] [MainThread]: On master: Close
[0m13:04:53.661156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:53.661330 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_cardevents' was properly closed.
[0m13:04:53.661464 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m13:04:53.661636 [info ] [MainThread]: 
[0m13:04:53.661777 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m13:04:53.662128 [debug] [MainThread]: Command end result
[0m13:04:53.673585 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m13:04:53.674680 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m13:04:53.677212 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m13:04:53.677364 [info ] [MainThread]: 
[0m13:04:53.677540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:53.677674 [info ] [MainThread]: 
[0m13:04:53.677817 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:04:53.678110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9662143, "process_in_blocks": "0", "process_kernel_time": 0.467666, "process_mem_max_rss": "512868352", "process_out_blocks": "0", "process_user_time": 5.679734}
[0m13:04:53.678295 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:53.678260 after 1.97 seconds
[0m13:04:53.678468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101388af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bb4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea2e50>]}
[0m13:04:53.678616 [debug] [MainThread]: Flushing usage events
[0m13:04:53.826207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:04.522759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a4980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e7c50>]}


============================== 13:05:04.525257 | 5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5 ==============================
[0m13:05:04.525257 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:05:04.525560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select final', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:04.667001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d88a0>]}
[0m13:05:04.689611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e1bf0>]}
[0m13:05:04.691813 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:05:04.741851 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:05:04.804780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:04.804999 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:04.826502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e9d50>]}
[0m13:05:04.860855 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m13:05:04.861964 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m13:05:04.871871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109383f20>]}
[0m13:05:04.872093 [info ] [MainThread]: Found 6 models, 3 seeds, 4 data tests, 424 macros
[0m13:05:04.872259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109204670>]}
[0m13:05:04.872987 [info ] [MainThread]: 
[0m13:05:04.873149 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m13:05:04.873273 [info ] [MainThread]: 
[0m13:05:04.873488 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:05:04.875372 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m13:05:04.904825 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m13:05:04.905028 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m13:05:04.905165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:04.918791 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:05:04.919672 [debug] [ThreadPool]: On list_dev: Close
[0m13:05:04.921337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m13:05:04.921544 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m13:05:04.924355 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:05:04.924505 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m13:05:04.924626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:04.928275 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:05:04.929056 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:05:04.929198 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m13:05:04.929392 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:05:04.929519 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:05:04.929640 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m13:05:04.930358 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:05:04.930731 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:05:04.930851 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m13:05:04.930956 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m13:05:04.931126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:05:04.931250 [debug] [ThreadPool]: On create_dev_main: Close
[0m13:05:04.932554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m13:05:04.934849 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:05:04.934985 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m13:05:04.935097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:04.938236 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:05:04.938384 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m13:05:04.938518 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m13:05:04.955619 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:05:04.956566 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m13:05:04.957304 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m13:05:04.957443 [debug] [ThreadPool]: On list_dev_main: Close
[0m13:05:04.959132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a286d0>]}
[0m13:05:04.959334 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:04.959456 [debug] [MainThread]: On master: BEGIN
[0m13:05:04.959564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:04.962676 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:05:04.962826 [debug] [MainThread]: On master: COMMIT
[0m13:05:04.962953 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:04.963071 [debug] [MainThread]: On master: COMMIT
[0m13:05:04.963237 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:05:04.963357 [debug] [MainThread]: On master: Close
[0m13:05:04.964476 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_entity
[0m13:05:04.964648 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m13:05:04.964881 [info ] [Thread-2 (]: 2 of 2 START sql table model main.final_entity ................................. [RUN]
[0m13:05:04.965165 [info ] [Thread-1 (]: 1 of 2 START sql table model main.final_cardevents ............................. [RUN]
[0m13:05:04.965429 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_entity'
[0m13:05:04.965614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m13:05:04.965769 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m13:05:04.965916 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m13:05:04.968976 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m13:05:04.969932 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m13:05:04.970513 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m13:05:04.970757 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m13:05:04.982530 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m13:05:04.983761 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:05:04.983943 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m13:05:04.984090 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m13:05:04.984238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:04.984372 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:05:04.987904 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:05:04.988103 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:05:04.988262 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:05:04.988408 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m13:05:04.988554 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m13:05:04.988716 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m13:05:04.989355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:04.993264 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m13:05:04.993435 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:05:04.994026 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m13:05:04.994343 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:05:04.994502 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m13:05:04.994662 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m13:05:04.994835 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m13:05:05.001009 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:05:05.004198 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:05:05.004377 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m13:05:05.004803 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:05:05.005948 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:05:05.006102 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m13:05:05.006351 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:05:05.009471 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:05:05.009681 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m13:05:05.010094 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:05:05.023855 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m13:05:05.024117 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:05:05.024587 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m13:05:05.029902 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:05:05.032786 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m13:05:05.032988 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m13:05:05.033404 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:05:05.036333 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: Close
[0m13:05:05.039161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109695d90>]}
[0m13:05:05.039948 [info ] [Thread-2 (]: 2 of 2 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.07s]
[0m13:05:05.040629 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m13:05:05.635016 [debug] [Thread-1 (]: SQL status: OK in 0.640 seconds
[0m13:05:05.637189 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m13:05:05.637352 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m13:05:05.637695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:05.638526 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m13:05:05.638672 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m13:05:05.639028 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:05.639554 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m13:05:05.639698 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m13:05:05.639828 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m13:05:08.834903 [debug] [Thread-1 (]: SQL status: OK in 3.195 seconds
[0m13:05:08.838653 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m13:05:08.838831 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m13:05:08.839236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:08.840011 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m13:05:09.182597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5231e1c4-e8a5-4c2c-b5ce-18e7614a05c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096899c0>]}
[0m13:05:09.186762 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 4.22s]
[0m13:05:09.187104 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m13:05:09.187985 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:09.188131 [debug] [MainThread]: On master: BEGIN
[0m13:05:09.188244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:09.192009 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m13:05:09.192163 [debug] [MainThread]: On master: COMMIT
[0m13:05:09.192284 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:09.192395 [debug] [MainThread]: On master: COMMIT
[0m13:05:09.192570 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:05:09.192685 [debug] [MainThread]: On master: Close
[0m13:05:09.193509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:09.193684 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_cardevents' was properly closed.
[0m13:05:09.193841 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m13:05:09.194045 [info ] [MainThread]: 
[0m13:05:09.194211 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m13:05:09.194567 [debug] [MainThread]: Command end result
[0m13:05:09.206156 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m13:05:09.208375 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m13:05:09.211308 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m13:05:09.211457 [info ] [MainThread]: 
[0m13:05:09.211647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:09.211797 [info ] [MainThread]: 
[0m13:05:09.211962 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:05:09.212291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.722132, "process_in_blocks": "0", "process_kernel_time": 0.564631, "process_mem_max_rss": "838598656", "process_out_blocks": "0", "process_user_time": 8.345223}
[0m13:05:09.212477 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:09.212442 after 4.72 seconds
[0m13:05:09.212666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096a42d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096474a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943ae50>]}
[0m13:05:09.212833 [debug] [MainThread]: Flushing usage events
[0m13:05:09.391084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:01.199615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10361d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449fc50>]}


============================== 16:04:01.202634 | 0246216f-67ba-45bd-b45f-6d3838d521d9 ==============================
[0m16:04:01.202634 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:04:01.202959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:04:01.211847 [info ] [MainThread]: dbt version: 1.9.2
[0m16:04:01.212033 [info ] [MainThread]: python version: 3.13.2
[0m16:04:01.212167 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m16:04:01.212293 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m16:04:01.337891 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m16:04:01.338130 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m16:04:01.338288 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m16:04:01.339690 [info ] [MainThread]: adapter type: duckdb
[0m16:04:01.339862 [info ] [MainThread]: adapter version: 1.9.1
[0m16:04:01.378383 [info ] [MainThread]: Configuration:
[0m16:04:01.378604 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:04:01.378767 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:04:01.378902 [info ] [MainThread]: Required dependencies:
[0m16:04:01.379091 [debug] [MainThread]: Executing "git --help"
[0m16:04:01.393246 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:04:01.393674 [debug] [MainThread]: STDERR: "b''"
[0m16:04:01.393832 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:04:01.393986 [info ] [MainThread]: Connection:
[0m16:04:01.394140 [info ] [MainThread]:   database: dev
[0m16:04:01.394304 [info ] [MainThread]:   schema: main
[0m16:04:01.394537 [info ] [MainThread]:   path: dev.duckdb
[0m16:04:01.394709 [info ] [MainThread]:   config_options: None
[0m16:04:01.394840 [info ] [MainThread]:   extensions: None
[0m16:04:01.394965 [info ] [MainThread]:   settings: {}
[0m16:04:01.395082 [info ] [MainThread]:   external_root: .
[0m16:04:01.395193 [info ] [MainThread]:   use_credential_provider: None
[0m16:04:01.395309 [info ] [MainThread]:   attach: None
[0m16:04:01.395419 [info ] [MainThread]:   filesystems: None
[0m16:04:01.395524 [info ] [MainThread]:   remote: None
[0m16:04:01.395632 [info ] [MainThread]:   plugins: None
[0m16:04:01.395738 [info ] [MainThread]:   disable_transactions: False
[0m16:04:01.396067 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:04:01.442315 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:04:01.483171 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:04:01.483359 [debug] [MainThread]: On debug: select 1 as id
[0m16:04:01.483485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:01.491154 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m16:04:01.491338 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m16:04:01.491537 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:04:01.491692 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:04:01.491822 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Could not set lock on file "/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.2.0/bin/duckdb (PID 23635) by user prashulkumar. See also https://duckdb.org/docs/connect/concurrency

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:04:01.492121 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.33187732, "process_in_blocks": "0", "process_kernel_time": 0.188238, "process_mem_max_rss": "121225216", "process_out_blocks": "0", "process_user_time": 0.648048}
[0m16:04:01.492321 [debug] [MainThread]: Command `dbt debug` failed at 16:04:01.492271 after 0.33 seconds
[0m16:04:01.492475 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:04:01.492626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104723890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e97b0>]}
[0m16:04:01.492812 [debug] [MainThread]: Flushing usage events
[0m16:04:01.762598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:18.504388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508bc50>]}


============================== 16:04:18.507083 | 1ebd36e2-ccc0-47ea-ad26-3abc7c7e9d4f ==============================
[0m16:04:18.507083 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:04:18.507424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:04:18.513902 [info ] [MainThread]: dbt version: 1.9.2
[0m16:04:18.514086 [info ] [MainThread]: python version: 3.13.2
[0m16:04:18.514217 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m16:04:18.514341 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m16:04:18.627917 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m16:04:18.628176 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m16:04:18.628338 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m16:04:18.629736 [info ] [MainThread]: adapter type: duckdb
[0m16:04:18.629915 [info ] [MainThread]: adapter version: 1.9.1
[0m16:04:18.668334 [info ] [MainThread]: Configuration:
[0m16:04:18.668578 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:04:18.668737 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:04:18.668880 [info ] [MainThread]: Required dependencies:
[0m16:04:18.669076 [debug] [MainThread]: Executing "git --help"
[0m16:04:18.682397 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:04:18.682899 [debug] [MainThread]: STDERR: "b''"
[0m16:04:18.683075 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:04:18.683238 [info ] [MainThread]: Connection:
[0m16:04:18.683398 [info ] [MainThread]:   database: dev
[0m16:04:18.683514 [info ] [MainThread]:   schema: main
[0m16:04:18.683628 [info ] [MainThread]:   path: dev.duckdb
[0m16:04:18.683742 [info ] [MainThread]:   config_options: None
[0m16:04:18.683853 [info ] [MainThread]:   extensions: None
[0m16:04:18.683966 [info ] [MainThread]:   settings: {}
[0m16:04:18.684074 [info ] [MainThread]:   external_root: .
[0m16:04:18.684188 [info ] [MainThread]:   use_credential_provider: None
[0m16:04:18.684298 [info ] [MainThread]:   attach: None
[0m16:04:18.684404 [info ] [MainThread]:   filesystems: None
[0m16:04:18.684514 [info ] [MainThread]:   remote: None
[0m16:04:18.684618 [info ] [MainThread]:   plugins: None
[0m16:04:18.684725 [info ] [MainThread]:   disable_transactions: False
[0m16:04:18.685060 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:04:18.730691 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:04:18.750775 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:04:18.750970 [debug] [MainThread]: On debug: select 1 as id
[0m16:04:18.751097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:18.766110 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m16:04:18.766626 [debug] [MainThread]: On debug: Close
[0m16:04:18.768459 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:04:18.768655 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:04:18.768997 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.29665864, "process_in_blocks": "0", "process_kernel_time": 0.151434, "process_mem_max_rss": "123437056", "process_out_blocks": "0", "process_user_time": 0.643467}
[0m16:04:18.769213 [debug] [MainThread]: Command `dbt debug` succeeded at 16:04:18.769165 after 0.30 seconds
[0m16:04:18.769376 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:04:18.769554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052abce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051138a0>]}
[0m16:04:18.769758 [debug] [MainThread]: Flushing usage events
[0m16:04:18.940066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:45.132177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb7c50>]}


============================== 16:04:45.135035 | 90719e1e-222b-419f-a4fa-f2df5dfbefc8 ==============================
[0m16:04:45.135035 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:04:45.135431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:04:45.294251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea8b00>]}
[0m16:04:45.316768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8de10>]}
[0m16:04:45.318410 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:04:45.371060 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:04:45.413751 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:04:45.413993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109038350>]}
[0m16:04:45.950265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cf3e0>]}
[0m16:04:45.984382 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:04:45.987911 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:04:45.999786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e2faf0>]}
[0m16:04:46.000004 [info ] [MainThread]: Found 8 models, 4 seeds, 4 data tests, 424 macros
[0m16:04:46.000168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cac30>]}
[0m16:04:46.000935 [info ] [MainThread]: 
[0m16:04:46.001099 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:04:46.001225 [info ] [MainThread]: 
[0m16:04:46.001438 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:04:46.003432 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:04:46.035273 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:04:46.035470 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:04:46.035599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:46.054554 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:04:46.055732 [debug] [ThreadPool]: On list_dev: Close
[0m16:04:46.057498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:04:46.057715 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:04:46.060569 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:04:46.060721 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:04:46.060840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:46.064513 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:04:46.065229 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:04:46.065357 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:04:46.065534 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:04:46.065651 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:04:46.065772 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:04:46.066581 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:04:46.067027 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:04:46.067187 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:04:46.067319 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:04:46.067579 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:04:46.067755 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:04:46.069171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:04:46.071739 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:04:46.071878 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:04:46.071992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:46.075414 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:04:46.075571 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:04:46.075706 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:04:46.093719 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:04:46.094389 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:04:46.095130 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:04:46.095283 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:04:46.097029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923f890>]}
[0m16:04:46.097246 [debug] [MainThread]: Using duckdb connection "master"
[0m16:04:46.097372 [debug] [MainThread]: On master: BEGIN
[0m16:04:46.097483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:46.100678 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:04:46.100827 [debug] [MainThread]: On master: COMMIT
[0m16:04:46.100954 [debug] [MainThread]: Using duckdb connection "master"
[0m16:04:46.101075 [debug] [MainThread]: On master: COMMIT
[0m16:04:46.101247 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:04:46.101373 [debug] [MainThread]: On master: Close
[0m16:04:46.102479 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_cardevents
[0m16:04:46.102656 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.stg_cardtransactions
[0m16:04:46.102868 [info ] [Thread-1 (]: 1 of 3 START sql table model main.stg_cardevents ............................... [RUN]
[0m16:04:46.103107 [info ] [Thread-2 (]: 2 of 3 START sql table model main.stg_cardtransactions ......................... [RUN]
[0m16:04:46.103313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_cardevents)
[0m16:04:46.103536 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.stg_cardtransactions'
[0m16:04:46.103693 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_cardevents
[0m16:04:46.103838 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.stg_cardtransactions
[0m16:04:46.106825 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_cardevents"
[0m16:04:46.107802 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:04:46.108511 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.stg_cardtransactions
[0m16:04:46.123529 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:04:46.123807 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_cardevents
[0m16:04:46.125212 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_cardevents"
[0m16:04:46.125460 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:04:46.125637 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: BEGIN
[0m16:04:46.125801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:04:46.126024 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:04:46.126176 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: BEGIN
[0m16:04:46.126315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:46.129274 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:04:46.129450 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:04:46.129599 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:04:46.129767 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."stg_cardtransactions__dbt_tmp"
  
    as (
      with source as (
    select *,
        row_number() over (partition by TRANSACTION_ID order by 
            case when MERCHANT_CATEGORY_CODE is not null then 1 else 2 end, TRANSACTION_ID) as row_num
    from "dev"."main"."card_transactions"
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    case 
        when TRANSACTION_ID is null then 0
        when row_num = 1 then 1         
        else 0
    end as is_valid
from source
    );
  
  
[0m16:04:46.129937 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:04:46.130168 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */

  
    
    

    create  table
      "dev"."main"."stg_cardevents__dbt_tmp"
  
    as (
      with source as (
    select * from "dev"."main"."card_events"
)
select 
    slash_account_id,
    card_event_id,
    card_id,
    event_type,
    card_status,
    timestamp,
    case 
        when card_event_id is null then 0
        else 1
    end as is_valid
from source
    );
  
  
[0m16:04:46.947045 [debug] [Thread-1 (]: SQL status: OK in 0.817 seconds
[0m16:04:46.951225 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:04:46.951433 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */
alter table "dev"."main"."stg_cardevents" rename to "stg_cardevents__dbt_backup"
[0m16:04:46.952472 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:04:46.953721 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:04:46.953888 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */
alter table "dev"."main"."stg_cardevents__dbt_tmp" rename to "stg_cardevents"
[0m16:04:46.954177 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:04:46.961537 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: COMMIT
[0m16:04:46.961747 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:04:46.961902 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: COMMIT
[0m16:04:47.303970 [debug] [Thread-2 (]: SQL status: OK in 1.174 seconds
[0m16:04:47.305936 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:04:47.306115 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardtransactions"} */
alter table "dev"."main"."stg_cardtransactions__dbt_tmp" rename to "stg_cardtransactions"
[0m16:04:47.306518 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:04:47.307233 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: COMMIT
[0m16:04:47.307388 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:04:47.307542 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: COMMIT
[0m16:04:47.635423 [debug] [Thread-1 (]: SQL status: OK in 0.671 seconds
[0m16:04:47.641827 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:04:47.642340 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */
drop table if exists "dev"."main"."stg_cardevents__dbt_backup" cascade
[0m16:04:47.771054 [debug] [Thread-2 (]: SQL status: OK in 0.463 seconds
[0m16:04:47.772442 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:04:47.772623 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardtransactions"} */
drop table if exists "dev"."main"."stg_cardtransactions__dbt_backup" cascade
[0m16:04:47.772804 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m16:04:47.774249 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: Close
[0m16:04:47.775099 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:04:47.775674 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: Close
[0m16:04:47.786690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109407b70>]}
[0m16:04:47.787063 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.stg_cardevents .......................... [[32mOK[0m in 1.67s]
[0m16:04:47.787342 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_cardevents
[0m16:04:47.787530 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m16:04:47.787812 [info ] [Thread-1 (]: 3 of 3 START sql table model main.stg_entity ................................... [RUN]
[0m16:04:47.788027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.stg_cardevents, now model.slash_analytics_take_home.stg_entity)
[0m16:04:47.788190 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m16:04:47.789453 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m16:04:47.793591 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m16:04:47.795484 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m16:04:47.795848 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:04:47.796000 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m16:04:47.796143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:48.304580 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c04410>]}
[0m16:04:48.306490 [info ] [Thread-2 (]: 2 of 3 OK created sql table model main.stg_cardtransactions .................... [[32mOK[0m in 2.20s]
[0m16:04:48.306845 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.stg_cardtransactions
[0m16:04:48.309280 [debug] [Thread-1 (]: SQL status: OK in 0.513 seconds
[0m16:04:48.309486 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:04:48.309657 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw
    );
  
  
[0m16:04:48.315274 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:04:48.316842 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:04:48.316998 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity" rename to "stg_entity__dbt_backup"
[0m16:04:48.317299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:04:48.318336 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:04:48.318478 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity__dbt_tmp" rename to "stg_entity"
[0m16:04:48.318723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:04:48.319412 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m16:04:48.319550 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:04:48.319677 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m16:04:48.320278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:04:48.321138 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:04:48.321287 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
drop table if exists "dev"."main"."stg_entity__dbt_backup" cascade
[0m16:04:48.321657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:04:48.322214 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m16:04:48.344651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90719e1e-222b-419f-a4fa-f2df5dfbefc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109780950>]}
[0m16:04:48.344996 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.stg_entity .............................. [[32mOK[0m in 0.56s]
[0m16:04:48.345273 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m16:04:48.346001 [debug] [MainThread]: Using duckdb connection "master"
[0m16:04:48.346136 [debug] [MainThread]: On master: BEGIN
[0m16:04:48.346247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:48.350286 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:04:48.350515 [debug] [MainThread]: On master: COMMIT
[0m16:04:48.350661 [debug] [MainThread]: Using duckdb connection "master"
[0m16:04:48.350788 [debug] [MainThread]: On master: COMMIT
[0m16:04:48.351006 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:04:48.351145 [debug] [MainThread]: On master: Close
[0m16:04:48.352108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:48.352277 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m16:04:48.352412 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_cardtransactions' was properly closed.
[0m16:04:48.352601 [info ] [MainThread]: 
[0m16:04:48.352762 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m16:04:48.353184 [debug] [MainThread]: Command end result
[0m16:04:48.366156 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:04:48.367506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:04:48.370669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m16:04:48.370834 [info ] [MainThread]: 
[0m16:04:48.371015 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:48.371153 [info ] [MainThread]: 
[0m16:04:48.371299 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:04:48.371645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2746785, "process_in_blocks": "0", "process_kernel_time": 0.644196, "process_mem_max_rss": "892059648", "process_out_blocks": "0", "process_user_time": 8.993564}
[0m16:04:48.371855 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:48.371816 after 3.27 seconds
[0m16:04:48.372084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d42040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109824050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109663e90>]}
[0m16:04:48.372249 [debug] [MainThread]: Flushing usage events
[0m16:04:48.551676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:08.315246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c5fc50>]}


============================== 16:05:08.317714 | 6b74fa3c-9e48-4840-8690-8049592babb7 ==============================
[0m16:05:08.317714 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:05:08.318020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select final', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:05:08.422498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5cb00>]}
[0m16:05:08.444911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cede10>]}
[0m16:05:08.447156 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:05:08.496811 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:05:08.559836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:08.560048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:08.581888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e6750>]}
[0m16:05:08.614035 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:05:08.615047 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:05:08.626513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fffb60>]}
[0m16:05:08.626786 [info ] [MainThread]: Found 8 models, 4 seeds, 4 data tests, 424 macros
[0m16:05:08.626950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd9fd0>]}
[0m16:05:08.627763 [info ] [MainThread]: 
[0m16:05:08.627926 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:05:08.628050 [info ] [MainThread]: 
[0m16:05:08.628311 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:05:08.630387 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:05:08.659789 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:05:08.660004 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:05:08.660138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:08.666123 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:05:08.666754 [debug] [ThreadPool]: On list_dev: Close
[0m16:05:08.667783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:05:08.667986 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:05:08.670734 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:05:08.670882 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:05:08.671001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:08.674562 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:05:08.675122 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:05:08.675248 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:05:08.675428 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:08.675539 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:05:08.675657 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:05:08.675848 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:08.676176 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:05:08.676293 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:05:08.676397 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:05:08.676565 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:08.676676 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:05:08.678056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:05:08.680346 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:05:08.680489 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:05:08.680605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:08.684008 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:05:08.684148 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:05:08.684274 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:05:08.698954 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:05:08.699912 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:05:08.700722 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:05:08.700861 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:05:08.702687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e9710>]}
[0m16:05:08.702928 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:08.703062 [debug] [MainThread]: On master: BEGIN
[0m16:05:08.703173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:08.706740 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:05:08.706879 [debug] [MainThread]: On master: COMMIT
[0m16:05:08.706993 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:08.707099 [debug] [MainThread]: On master: COMMIT
[0m16:05:08.707278 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:05:08.707397 [debug] [MainThread]: On master: Close
[0m16:05:08.708614 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m16:05:08.708779 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m16:05:08.708996 [info ] [Thread-1 (]: 1 of 3 START sql table model main.final_cardevents ............................. [RUN]
[0m16:05:08.709287 [info ] [Thread-2 (]: 2 of 3 START sql table model main.final_cardtransactions ....................... [RUN]
[0m16:05:08.709548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m16:05:08.709750 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_cardtransactions'
[0m16:05:08.709909 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m16:05:08.710053 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m16:05:08.713495 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m16:05:08.714720 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:08.715485 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m16:05:08.721484 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m16:05:08.727402 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:08.728581 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:08.728754 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m16:05:08.728900 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m16:05:08.729037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:08.729174 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:05:08.733069 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:05:08.733261 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:08.733438 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:05:08.733792 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m16:05:08.733954 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:08.734349 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m16:05:08.734544 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:05:08.738382 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:08.738581 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:05:08.739159 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m16:05:08.739400 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:08.739570 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    date(TIMESTAMP) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m16:05:08.739863 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:08.740046 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m16:05:08.749424 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    date(TIMESTAMP) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m16:05:08.749664 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m16:05:08.749901 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: ROLLBACK
[0m16:05:08.759740 [debug] [Thread-2 (]: Failed to rollback 'model.slash_analytics_take_home.final_cardtransactions'
[0m16:05:08.759971 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m16:05:08.763334 [debug] [Thread-2 (]: Runtime Error in model final_cardtransactions (models/final/final_cardtransactions.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 27:     date(TIMESTAMP) as exchange_rt_dt,
               ^
[0m16:05:08.764493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c3290>]}
[0m16:05:08.765528 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model main.final_cardtransactions .............. [[31mERROR[0m in 0.05s]
[0m16:05:08.765836 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m16:05:08.766031 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_entity
[0m16:05:08.766251 [info ] [Thread-2 (]: 3 of 3 START sql table model main.final_entity ................................. [RUN]
[0m16:05:08.766634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardtransactions, now model.slash_analytics_take_home.final_entity)
[0m16:05:08.766818 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m16:05:08.768125 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m16:05:08.768513 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m16:05:08.770930 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:05:08.771113 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m16:05:08.771266 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:05:08.772427 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:05:08.775346 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:05:08.773155 [debug] [Thread-5 (]: Marking all children of 'model.slash_analytics_take_home.final_cardtransactions' to be skipped because of status 'error'.  Reason: Runtime Error in model final_cardtransactions (models/final/final_cardtransactions.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 27:     date(TIMESTAMP) as exchange_rt_dt,
               ^.
[0m16:05:08.775984 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m16:05:08.780572 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:05:08.781451 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m16:05:08.781843 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:05:08.782013 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m16:05:08.783408 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:05:08.790036 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:05:08.790481 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m16:05:08.791311 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:05:08.794688 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:05:08.794871 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m16:05:08.795175 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:05:08.797637 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:05:08.797819 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m16:05:08.798278 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:05:08.813593 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m16:05:08.814142 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:05:08.814513 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m16:05:08.819550 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:05:08.823426 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:05:08.823660 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m16:05:08.824075 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:05:08.825639 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: Close
[0m16:05:08.826423 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062daf10>]}
[0m16:05:08.826743 [info ] [Thread-2 (]: 3 of 3 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.06s]
[0m16:05:08.826997 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m16:05:09.460843 [debug] [Thread-1 (]: SQL status: OK in 0.721 seconds
[0m16:05:09.462403 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:09.462579 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m16:05:09.462925 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:09.463959 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:09.464104 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m16:05:09.464355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:09.467113 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:09.467278 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m16:05:09.467668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:09.468268 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m16:05:09.468415 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:09.468549 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m16:05:12.631926 [debug] [Thread-1 (]: SQL status: OK in 3.163 seconds
[0m16:05:12.637725 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:12.637909 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m16:05:12.964217 [debug] [Thread-1 (]: SQL status: OK in 0.326 seconds
[0m16:05:12.965158 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m16:05:12.977964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b74fa3c-9e48-4840-8690-8049592babb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f9db0>]}
[0m16:05:12.978365 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 4.27s]
[0m16:05:12.978641 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m16:05:12.979364 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:12.979493 [debug] [MainThread]: On master: BEGIN
[0m16:05:12.979600 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:12.983570 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:05:12.983716 [debug] [MainThread]: On master: COMMIT
[0m16:05:12.983836 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:12.983941 [debug] [MainThread]: On master: COMMIT
[0m16:05:12.984106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:05:12.984219 [debug] [MainThread]: On master: Close
[0m16:05:12.985134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:12.985297 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_cardevents' was properly closed.
[0m16:05:12.985418 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m16:05:12.985588 [info ] [MainThread]: 
[0m16:05:12.985743 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.36 seconds (4.36s).
[0m16:05:12.986155 [debug] [MainThread]: Command end result
[0m16:05:12.996527 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:05:13.002891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:05:13.005615 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m16:05:13.005760 [info ] [MainThread]: 
[0m16:05:13.005927 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:05:13.006077 [info ] [MainThread]: 
[0m16:05:13.006251 [error] [MainThread]:   Runtime Error in model final_cardtransactions (models/final/final_cardtransactions.sql)
  Catalog Error: Scalar Function with name date does not exist!
  Did you mean "datesub"?
  LINE 27:     date(TIMESTAMP) as exchange_rt_dt,
               ^
[0m16:05:13.006387 [info ] [MainThread]: 
[0m16:05:13.006542 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:05:13.006860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.723319, "process_in_blocks": "0", "process_kernel_time": 0.575223, "process_mem_max_rss": "851427328", "process_out_blocks": "0", "process_user_time": 8.220689}
[0m16:05:13.007046 [debug] [MainThread]: Command `dbt run` failed at 16:05:13.007012 after 4.72 seconds
[0m16:05:13.007246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c62850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca19b0>]}
[0m16:05:13.007389 [debug] [MainThread]: Flushing usage events
[0m16:05:13.185908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:57.927421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036252b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a3c50>]}


============================== 16:05:57.930242 | ef87bec6-a823-43c9-8354-d13d84195feb ==============================
[0m16:05:57.930242 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:05:57.930561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select final', 'send_anonymous_usage_stats': 'True'}
[0m16:05:58.093321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a0b00>]}
[0m16:05:58.117469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104531e10>]}
[0m16:05:58.119321 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:05:58.170801 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:05:58.242249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:58.242588 [debug] [MainThread]: Partial parsing: updated file: slash_analytics_take_home://models/final/final_cardtransactions.sql
[0m16:05:58.346546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104828350>]}
[0m16:05:58.378673 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:05:58.379813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:05:58.391273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048aa120>]}
[0m16:05:58.391498 [info ] [MainThread]: Found 8 models, 4 seeds, 4 data tests, 424 macros
[0m16:05:58.391661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107096510>]}
[0m16:05:58.392437 [info ] [MainThread]: 
[0m16:05:58.392603 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:05:58.392725 [info ] [MainThread]: 
[0m16:05:58.392933 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:05:58.394872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:05:58.431802 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:05:58.432005 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:05:58.432199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:58.454527 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m16:05:58.455525 [debug] [ThreadPool]: On list_dev: Close
[0m16:05:58.457188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:05:58.457420 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:05:58.460288 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:05:58.460450 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:05:58.460573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:58.464584 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:05:58.465168 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:05:58.465296 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:05:58.465485 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:58.465599 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:05:58.465712 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:05:58.466434 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:05:58.466787 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:05:58.466905 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:05:58.467009 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:05:58.467168 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:05:58.467287 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:05:58.468726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:05:58.470932 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:05:58.471069 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:05:58.471180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:58.474685 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:05:58.474833 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:05:58.474968 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:05:58.494044 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m16:05:58.495057 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:05:58.495818 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:05:58.495964 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:05:58.497964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721fe10>]}
[0m16:05:58.498182 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:58.498310 [debug] [MainThread]: On master: BEGIN
[0m16:05:58.498416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:58.502192 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:05:58.502343 [debug] [MainThread]: On master: COMMIT
[0m16:05:58.502470 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:58.502586 [debug] [MainThread]: On master: COMMIT
[0m16:05:58.502770 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:05:58.502933 [debug] [MainThread]: On master: Close
[0m16:05:58.504175 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m16:05:58.504347 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m16:05:58.504564 [info ] [Thread-2 (]: 2 of 3 START sql table model main.final_cardtransactions ....................... [RUN]
[0m16:05:58.504803 [info ] [Thread-1 (]: 1 of 3 START sql table model main.final_cardevents ............................. [RUN]
[0m16:05:58.505040 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_cardtransactions'
[0m16:05:58.505217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m16:05:58.505373 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m16:05:58.505514 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m16:05:58.508703 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:58.509743 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m16:05:58.510259 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m16:05:58.510443 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m16:05:58.522621 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:58.523816 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:58.524004 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m16:05:58.524154 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m16:05:58.524296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:58.524432 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:05:58.528440 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:05:58.528611 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:58.528771 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:05:58.528945 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m16:05:58.529103 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:58.529472 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m16:05:58.529737 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:05:58.533698 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:58.533896 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:05:58.534460 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m16:05:58.534729 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:58.534922 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    CAST(TIMESTAMP AS DATE) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m16:05:58.535215 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:58.535388 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m16:05:59.305887 [debug] [Thread-1 (]: SQL status: OK in 0.770 seconds
[0m16:05:59.309231 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:59.309419 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m16:05:59.310257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:05:59.311449 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:59.311611 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m16:05:59.311863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:59.314163 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:59.314343 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m16:05:59.314717 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:05:59.320183 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m16:05:59.320364 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:05:59.320507 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m16:05:59.423224 [debug] [Thread-2 (]: SQL status: OK in 0.888 seconds
[0m16:05:59.424639 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:59.424816 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions__dbt_tmp" rename to "final_cardtransactions"
[0m16:05:59.425210 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:05:59.426081 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:59.426238 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        CREATE INDEX IF NOT EXISTS idx_card_tx ON "dev"."main"."final_cardtransactions" (transaction_id)
      
[0m16:05:59.426654 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:05:59.427266 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m16:05:59.427427 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:05:59.427568 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m16:06:02.579710 [debug] [Thread-1 (]: SQL status: OK in 3.257 seconds
[0m16:06:02.587181 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:06:02.587434 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m16:06:03.171884 [debug] [Thread-2 (]: SQL status: OK in 3.744 seconds
[0m16:06:03.172713 [debug] [Thread-1 (]: SQL status: OK in 0.585 seconds
[0m16:06:03.177509 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:06:03.180059 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m16:06:03.180244 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
drop table if exists "dev"."main"."final_cardtransactions__dbt_backup" cascade
[0m16:06:03.181504 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:06:03.182105 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m16:06:03.182962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107370050>]}
[0m16:06:03.183581 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 4.68s]
[0m16:06:03.183905 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m16:06:03.184122 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_entity
[0m16:06:03.184504 [info ] [Thread-1 (]: 3 of 3 START sql table model main.final_entity ................................. [RUN]
[0m16:06:03.184776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardevents, now model.slash_analytics_take_home.final_entity)
[0m16:06:03.184955 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m16:06:03.186270 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m16:06:03.186674 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m16:06:03.187915 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:06:03.188078 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m16:06:03.188228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:03.903542 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7ac0>]}
[0m16:06:03.907878 [info ] [Thread-2 (]: 2 of 3 OK created sql table model main.final_cardtransactions .................. [[32mOK[0m in 5.40s]
[0m16:06:03.908265 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m16:06:03.908451 [debug] [Thread-1 (]: SQL status: OK in 0.720 seconds
[0m16:06:03.908710 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:06:03.908869 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m16:06:03.909167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:06:03.909818 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m16:06:03.910191 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:06:03.910338 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m16:06:03.915211 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:06:03.916871 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:06:03.917051 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m16:06:03.917372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:06:03.918653 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:06:03.918861 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m16:06:03.919168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:06:03.920098 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:06:03.920256 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m16:06:03.920662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:06:03.921270 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m16:06:03.921419 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:06:03.921558 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m16:06:03.923117 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:06:03.923975 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:06:03.924125 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m16:06:03.924456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:06:03.925282 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: Close
[0m16:06:03.951986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef87bec6-a823-43c9-8354-d13d84195feb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776fed0>]}
[0m16:06:03.952291 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.77s]
[0m16:06:03.952539 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m16:06:03.953373 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:03.953511 [debug] [MainThread]: On master: BEGIN
[0m16:06:03.953624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:03.957336 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:06:03.957489 [debug] [MainThread]: On master: COMMIT
[0m16:06:03.957617 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:03.957723 [debug] [MainThread]: On master: COMMIT
[0m16:06:03.957886 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:06:03.958004 [debug] [MainThread]: On master: Close
[0m16:06:03.959226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:03.959378 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m16:06:03.959497 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_cardtransactions' was properly closed.
[0m16:06:03.959699 [info ] [MainThread]: 
[0m16:06:03.959857 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m16:06:03.960258 [debug] [MainThread]: Command end result
[0m16:06:03.970792 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:06:03.981295 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:06:03.984198 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m16:06:03.984346 [info ] [MainThread]: 
[0m16:06:03.984527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:03.984670 [info ] [MainThread]: 
[0m16:06:03.984832 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:06:03.985225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0923653, "process_in_blocks": "0", "process_kernel_time": 0.791362, "process_mem_max_rss": "815153152", "process_out_blocks": "0", "process_user_time": 10.499098}
[0m16:06:03.985418 [debug] [MainThread]: Command `dbt run` succeeded at 16:06:03.985384 after 6.09 seconds
[0m16:06:03.985667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104faf2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107014f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e19b0>]}
[0m16:06:03.985817 [debug] [MainThread]: Flushing usage events
[0m16:06:04.369498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:10.899667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101192b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155fc50>]}


============================== 16:31:10.902670 | 6373f2a2-0b9e-49b0-a286-d6034fa9cef1 ==============================
[0m16:31:10.902670 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:31:10.902989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:31:10.912031 [info ] [MainThread]: dbt version: 1.9.2
[0m16:31:10.912307 [info ] [MainThread]: python version: 3.13.2
[0m16:31:10.912490 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m16:31:10.912663 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m16:31:11.041619 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m16:31:11.041869 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m16:31:11.042029 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m16:31:11.043385 [info ] [MainThread]: adapter type: duckdb
[0m16:31:11.043568 [info ] [MainThread]: adapter version: 1.9.1
[0m16:31:11.084451 [info ] [MainThread]: Configuration:
[0m16:31:11.084708 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:31:11.084853 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:31:11.084995 [info ] [MainThread]: Required dependencies:
[0m16:31:11.085184 [debug] [MainThread]: Executing "git --help"
[0m16:31:11.099461 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:31:11.100058 [debug] [MainThread]: STDERR: "b''"
[0m16:31:11.100242 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:31:11.100400 [info ] [MainThread]: Connection:
[0m16:31:11.100552 [info ] [MainThread]:   database: dev
[0m16:31:11.100672 [info ] [MainThread]:   schema: main
[0m16:31:11.100785 [info ] [MainThread]:   path: dev.duckdb
[0m16:31:11.100895 [info ] [MainThread]:   config_options: None
[0m16:31:11.101003 [info ] [MainThread]:   extensions: None
[0m16:31:11.101111 [info ] [MainThread]:   settings: {}
[0m16:31:11.101220 [info ] [MainThread]:   external_root: .
[0m16:31:11.101322 [info ] [MainThread]:   use_credential_provider: None
[0m16:31:11.101433 [info ] [MainThread]:   attach: None
[0m16:31:11.101536 [info ] [MainThread]:   filesystems: None
[0m16:31:11.101642 [info ] [MainThread]:   remote: None
[0m16:31:11.101748 [info ] [MainThread]:   plugins: None
[0m16:31:11.101852 [info ] [MainThread]:   disable_transactions: False
[0m16:31:11.102166 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:31:11.148000 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:31:11.187090 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:31:11.187269 [debug] [MainThread]: On debug: select 1 as id
[0m16:31:11.187395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:11.201880 [debug] [MainThread]: SQL status: OK in 0.014 seconds
[0m16:31:11.202348 [debug] [MainThread]: On debug: Close
[0m16:31:11.203953 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:31:11.204123 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:31:11.204442 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.34386265, "process_in_blocks": "0", "process_kernel_time": 0.192177, "process_mem_max_rss": "124452864", "process_out_blocks": "0", "process_user_time": 0.642947}
[0m16:31:11.204639 [debug] [MainThread]: Command `dbt debug` succeeded at 16:31:11.204594 after 0.34 seconds
[0m16:31:11.204785 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:31:11.204936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119e39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e78a0>]}
[0m16:31:11.205115 [debug] [MainThread]: Flushing usage events
[0m16:31:11.427117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:19.255147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108703b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108703c50>]}


============================== 16:31:19.257699 | 95f971cd-7575-4f08-97a5-f6152c64bb01 ==============================
[0m16:31:19.257699 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:31:19.258008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:31:19.359201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108904b00>]}
[0m16:31:19.381774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108791e10>]}
[0m16:31:19.383360 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:31:19.432675 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:31:19.499193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:19.499490 [debug] [MainThread]: Partial parsing: updated file: slash_analytics_take_home://models/final/final_cardtransactions.sql
[0m16:31:19.605744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a84350>]}
[0m16:31:19.637805 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:31:19.639145 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:31:19.649329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b09d60>]}
[0m16:31:19.649542 [info ] [MainThread]: Found 8 models, 4 seeds, 4 data tests, 424 macros
[0m16:31:19.649706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd2510>]}
[0m16:31:19.650459 [info ] [MainThread]: 
[0m16:31:19.650623 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:31:19.650744 [info ] [MainThread]: 
[0m16:31:19.650947 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:31:19.652862 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:31:19.678348 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:31:19.678546 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:31:19.678680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:19.688619 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:31:19.689858 [debug] [ThreadPool]: On list_dev: Close
[0m16:31:19.690987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:31:19.691378 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:31:19.694187 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:31:19.694334 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:31:19.694453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:19.698638 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:31:19.699332 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:31:19.699459 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:31:19.699645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:31:19.699762 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:31:19.699878 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:31:19.700660 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:31:19.701002 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:31:19.701127 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:31:19.701231 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:31:19.701388 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:31:19.701513 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:31:19.702938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:31:19.705188 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:31:19.705324 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:31:19.705433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:19.709140 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:31:19.709281 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:31:19.709405 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:31:19.727923 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m16:31:19.729135 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:31:19.729907 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:31:19.730048 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:31:19.732157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbb110>]}
[0m16:31:19.732376 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:19.732496 [debug] [MainThread]: On master: BEGIN
[0m16:31:19.732601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:19.736163 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:31:19.736314 [debug] [MainThread]: On master: COMMIT
[0m16:31:19.736441 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:19.736556 [debug] [MainThread]: On master: COMMIT
[0m16:31:19.736728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:31:19.736850 [debug] [MainThread]: On master: Close
[0m16:31:19.738116 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.stg_cardtransactions
[0m16:31:19.738312 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_cardevents
[0m16:31:19.738547 [info ] [Thread-2 (]: 2 of 3 START sql table model main.stg_cardtransactions ......................... [RUN]
[0m16:31:19.738775 [info ] [Thread-1 (]: 1 of 3 START sql table model main.stg_cardevents ............................... [RUN]
[0m16:31:19.739028 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.stg_cardtransactions'
[0m16:31:19.739210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.stg_cardevents)
[0m16:31:19.739364 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.stg_cardtransactions
[0m16:31:19.739507 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_cardevents
[0m16:31:19.742592 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:31:19.743528 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_cardevents"
[0m16:31:19.744334 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.stg_cardtransactions
[0m16:31:19.744490 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_cardevents
[0m16:31:19.760795 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_cardevents"
[0m16:31:19.763122 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:31:19.763730 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:31:19.763913 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:31:19.764077 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: BEGIN
[0m16:31:19.764239 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: BEGIN
[0m16:31:19.764392 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:31:19.764527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:19.768387 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:31:19.768564 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:31:19.768716 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:31:19.768873 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."stg_cardtransactions__dbt_tmp"
  
    as (
      with source as (
    select *,
        row_number() over (partition by TRANSACTION_ID order by 
            case when MERCHANT_CATEGORY_CODE is not null then 1 else 2 end, TRANSACTION_ID) as row_num
    from "dev"."main"."card_transactions"
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    case 
        when TRANSACTION_ID is null then 0
        when row_num = 1 then 1         
        else 0
    end as is_valid
from source
    );
  
  
[0m16:31:19.769034 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:31:19.769254 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */

  
    
    

    create  table
      "dev"."main"."stg_cardevents__dbt_tmp"
  
    as (
      with source as (
    select * from "dev"."main"."card_events"
)
select 
    slash_account_id,
    card_event_id,
    card_id,
    event_type,
    card_status,
    timestamp,
    case 
        when card_event_id is null then 0
        else 1
    end as is_valid
from source
    );
  
  
[0m16:31:20.644690 [debug] [Thread-1 (]: SQL status: OK in 0.875 seconds
[0m16:31:20.649140 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:31:20.649389 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */
alter table "dev"."main"."stg_cardevents" rename to "stg_cardevents__dbt_backup"
[0m16:31:20.650712 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:31:20.651966 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:31:20.652130 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */
alter table "dev"."main"."stg_cardevents__dbt_tmp" rename to "stg_cardevents"
[0m16:31:20.652418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:20.659846 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: COMMIT
[0m16:31:20.660072 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:31:20.660231 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: COMMIT
[0m16:31:20.754858 [debug] [Thread-2 (]: SQL status: OK in 0.986 seconds
[0m16:31:20.756501 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:31:20.756674 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardtransactions"} */
alter table "dev"."main"."stg_cardtransactions" rename to "stg_cardtransactions__dbt_backup"
[0m16:31:20.757028 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:31:20.758103 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:31:20.758255 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardtransactions"} */
alter table "dev"."main"."stg_cardtransactions__dbt_tmp" rename to "stg_cardtransactions"
[0m16:31:20.758513 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:31:20.759219 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: COMMIT
[0m16:31:20.759368 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:31:20.759504 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: COMMIT
[0m16:31:21.267708 [debug] [Thread-1 (]: SQL status: OK in 0.607 seconds
[0m16:31:21.272138 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardevents"
[0m16:31:21.272313 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardevents"} */
drop table if exists "dev"."main"."stg_cardevents__dbt_backup" cascade
[0m16:31:21.467033 [debug] [Thread-2 (]: SQL status: OK in 0.707 seconds
[0m16:31:21.468377 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.stg_cardtransactions"
[0m16:31:21.468553 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_cardtransactions"} */
drop table if exists "dev"."main"."stg_cardtransactions__dbt_backup" cascade
[0m16:31:21.468733 [debug] [Thread-1 (]: SQL status: OK in 0.196 seconds
[0m16:31:21.470258 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_cardevents: Close
[0m16:31:21.472848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109090950>]}
[0m16:31:21.473256 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.stg_cardevents .......................... [[32mOK[0m in 1.73s]
[0m16:31:21.473531 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_cardevents
[0m16:31:21.473725 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.stg_entity
[0m16:31:21.474016 [info ] [Thread-1 (]: 3 of 3 START sql table model main.stg_entity ................................... [RUN]
[0m16:31:21.474255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.stg_cardevents, now model.slash_analytics_take_home.stg_entity)
[0m16:31:21.474422 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.stg_entity
[0m16:31:21.475601 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.stg_entity"
[0m16:31:21.477425 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.stg_entity
[0m16:31:21.479007 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.stg_entity"
[0m16:31:21.479333 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:31:21.479576 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: BEGIN
[0m16:31:21.479784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:21.480093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:21.480252 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:31:21.480417 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */

  
    
    

    create  table
      "dev"."main"."stg_entity__dbt_tmp"
  
    as (
      WITH entity_raw AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date,
        CASE 
            WHEN entity_id IS NULL OR subaccount_id IS NULL OR account_creation_date IS NULL THEN 0 
            ELSE 1 
        END AS is_valid
    FROM "dev"."main"."entity"
)
SELECT * FROM entity_raw
    );
  
  
[0m16:31:22.017011 [debug] [Thread-2 (]: SQL status: OK in 0.548 seconds
[0m16:31:22.017828 [debug] [Thread-1 (]: SQL status: OK in 0.537 seconds
[0m16:31:22.019773 [debug] [Thread-2 (]: On model.slash_analytics_take_home.stg_cardtransactions: Close
[0m16:31:22.020897 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:31:22.021184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7d4f0>]}
[0m16:31:22.021348 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity" rename to "stg_entity__dbt_backup"
[0m16:31:22.021633 [info ] [Thread-2 (]: 2 of 3 OK created sql table model main.stg_cardtransactions .................... [[32mOK[0m in 2.28s]
[0m16:31:22.022007 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.stg_cardtransactions
[0m16:31:22.022276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:22.023400 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:31:22.023565 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
alter table "dev"."main"."stg_entity__dbt_tmp" rename to "stg_entity"
[0m16:31:22.023834 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:22.024555 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m16:31:22.024702 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:31:22.024832 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: COMMIT
[0m16:31:22.025405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:22.026433 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.stg_entity"
[0m16:31:22.026581 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.stg_entity"} */
drop table if exists "dev"."main"."stg_entity__dbt_backup" cascade
[0m16:31:22.026881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:22.027384 [debug] [Thread-1 (]: On model.slash_analytics_take_home.stg_entity: Close
[0m16:31:22.066296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95f971cd-7575-4f08-97a5-f6152c64bb01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109206990>]}
[0m16:31:22.066674 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.stg_entity .............................. [[32mOK[0m in 0.59s]
[0m16:31:22.066959 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.stg_entity
[0m16:31:22.067846 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:22.068052 [debug] [MainThread]: On master: BEGIN
[0m16:31:22.068194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:22.072838 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m16:31:22.073007 [debug] [MainThread]: On master: COMMIT
[0m16:31:22.073138 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:22.073263 [debug] [MainThread]: On master: COMMIT
[0m16:31:22.073508 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:31:22.073636 [debug] [MainThread]: On master: Close
[0m16:31:22.074634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:22.074788 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_entity' was properly closed.
[0m16:31:22.074895 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.stg_cardtransactions' was properly closed.
[0m16:31:22.075066 [info ] [MainThread]: 
[0m16:31:22.075221 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m16:31:22.075629 [debug] [MainThread]: Command end result
[0m16:31:22.085932 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:31:22.087873 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:31:22.091313 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m16:31:22.091469 [info ] [MainThread]: 
[0m16:31:22.091654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:22.091787 [info ] [MainThread]: 
[0m16:31:22.091942 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:31:22.092337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8690565, "process_in_blocks": "0", "process_kernel_time": 0.648054, "process_mem_max_rss": "882032640", "process_out_blocks": "0", "process_user_time": 8.321913}
[0m16:31:22.092559 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:22.092520 after 2.87 seconds
[0m16:31:22.092777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d572d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087459b0>]}
[0m16:31:22.092926 [debug] [MainThread]: Flushing usage events
[0m16:31:22.252476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:27.878525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078012b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867fc50>]}


============================== 16:31:27.880898 | 31dc47b1-0772-49ac-83fc-b9ec5a49dd6b ==============================
[0m16:31:27.880898 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:31:27.881208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select final', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:27.974713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108880b00>]}
[0m16:31:27.997325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870de10>]}
[0m16:31:27.999555 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:31:28.047281 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:31:28.107731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:28.107922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:28.129480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a06750>]}
[0m16:31:28.162827 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:31:28.163641 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:31:28.173623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891fb60>]}
[0m16:31:28.173842 [info ] [MainThread]: Found 8 models, 4 seeds, 4 data tests, 424 macros
[0m16:31:28.174011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e5fd0>]}
[0m16:31:28.174799 [info ] [MainThread]: 
[0m16:31:28.174957 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m16:31:28.175083 [info ] [MainThread]: 
[0m16:31:28.175298 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:31:28.177203 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m16:31:28.202396 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m16:31:28.202625 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m16:31:28.202769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:28.207821 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:31:28.208489 [debug] [ThreadPool]: On list_dev: Close
[0m16:31:28.209624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m16:31:28.209841 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m16:31:28.212892 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:31:28.213042 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m16:31:28.213162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:28.216959 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:31:28.217526 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:31:28.217654 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m16:31:28.217840 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:31:28.217951 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:31:28.218059 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m16:31:28.218252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:31:28.218580 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:31:28.218697 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m16:31:28.218800 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m16:31:28.218963 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:31:28.219075 [debug] [ThreadPool]: On create_dev_main: Close
[0m16:31:28.220475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m16:31:28.222720 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:31:28.222865 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m16:31:28.222980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:28.226774 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:31:28.226923 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m16:31:28.227049 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m16:31:28.241325 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:31:28.242293 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m16:31:28.243262 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m16:31:28.243402 [debug] [ThreadPool]: On list_dev_main: Close
[0m16:31:28.245425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f09710>]}
[0m16:31:28.245655 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:28.245795 [debug] [MainThread]: On master: BEGIN
[0m16:31:28.245916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:28.249390 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:31:28.249519 [debug] [MainThread]: On master: COMMIT
[0m16:31:28.249632 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:28.249736 [debug] [MainThread]: On master: COMMIT
[0m16:31:28.249910 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:31:28.250021 [debug] [MainThread]: On master: Close
[0m16:31:28.251310 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m16:31:28.251498 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m16:31:28.251720 [info ] [Thread-1 (]: 1 of 3 START sql table model main.final_cardevents ............................. [RUN]
[0m16:31:28.251995 [info ] [Thread-2 (]: 2 of 3 START sql table model main.final_cardtransactions ....................... [RUN]
[0m16:31:28.252217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m16:31:28.252415 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_cardtransactions'
[0m16:31:28.252564 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m16:31:28.252709 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m16:31:28.255890 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m16:31:28.256850 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:28.257675 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m16:31:28.257856 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m16:31:28.268845 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:31:28.270158 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:28.270352 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m16:31:28.270546 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m16:31:28.270707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:28.271016 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:31:28.274734 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:31:28.274908 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:31:28.275063 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:31:28.275225 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:28.275374 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m16:31:28.275528 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m16:31:28.276217 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:31:28.280387 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:28.280575 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:31:28.281182 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m16:31:28.281567 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:31:28.281764 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:28.281945 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m16:31:28.282177 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    case 
        when ORIGINAL_CURRENCY_CODE = 'ILR' then 'ILS'
        when ORIGINAL_CURRENCY_CODE = 'ARY' then 'ARS'
        when ORIGINAL_CURRENCY_CODE = 'MXP' then 'MXN'
        when ORIGINAL_CURRENCY_CODE = 'CSJ' then 'CZK'
        when ORIGINAL_CURRENCY_CODE = 'VNC' then 'VND'
        when ORIGINAL_CURRENCY_CODE = 'PES' then 'PEN'
        else ORIGINAL_CURRENCY_CODE
    end as ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    CAST(TIMESTAMP AS DATE) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m16:31:28.992956 [debug] [Thread-1 (]: SQL status: OK in 0.710 seconds
[0m16:31:29.003922 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:31:29.004135 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m16:31:29.004580 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:29.005843 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:31:29.006016 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m16:31:29.006334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:29.008810 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:31:29.009013 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m16:31:29.009421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:29.015128 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m16:31:29.015326 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:31:29.015480 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m16:31:29.492622 [debug] [Thread-2 (]: SQL status: OK in 1.210 seconds
[0m16:31:29.494239 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:29.494417 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions" rename to "final_cardtransactions__dbt_backup"
[0m16:31:29.494770 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:31:29.495892 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:29.496049 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions__dbt_tmp" rename to "final_cardtransactions"
[0m16:31:29.496312 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:31:29.497200 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:29.497355 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        CREATE INDEX IF NOT EXISTS idx_card_tx ON "dev"."main"."final_cardtransactions" (transaction_id)
      
[0m16:31:29.497696 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:31:29.498316 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m16:31:29.498468 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:29.498606 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m16:31:32.254539 [debug] [Thread-1 (]: SQL status: OK in 3.239 seconds
[0m16:31:32.258704 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m16:31:32.258912 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m16:31:32.840873 [debug] [Thread-2 (]: SQL status: OK in 3.342 seconds
[0m16:31:32.842455 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m16:31:32.842648 [debug] [Thread-1 (]: SQL status: OK in 0.584 seconds
[0m16:31:32.842842 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
drop table if exists "dev"."main"."final_cardtransactions__dbt_backup" cascade
[0m16:31:32.844701 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m16:31:32.850064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be3ad0>]}
[0m16:31:32.850662 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 4.59s]
[0m16:31:32.851473 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m16:31:32.851723 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_entity
[0m16:31:32.852562 [info ] [Thread-1 (]: 3 of 3 START sql table model main.final_entity ................................. [RUN]
[0m16:31:32.852895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardevents, now model.slash_analytics_take_home.final_entity)
[0m16:31:32.853138 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m16:31:32.855041 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m16:31:32.856208 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m16:31:32.863231 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:31:32.863811 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m16:31:32.864258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:32.865334 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:31:32.865936 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:31:32.866276 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m16:31:33.403693 [debug] [Thread-2 (]: SQL status: OK in 0.559 seconds
[0m16:31:33.403991 [debug] [Thread-1 (]: SQL status: OK in 0.537 seconds
[0m16:31:33.408902 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m16:31:33.409558 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m16:31:33.409889 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bfa8e0>]}
[0m16:31:33.410174 [info ] [Thread-2 (]: 2 of 3 OK created sql table model main.final_cardtransactions .................. [[32mOK[0m in 5.16s]
[0m16:31:33.410422 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m16:31:33.414031 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:31:33.414193 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m16:31:33.415725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:31:33.417020 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:31:33.417207 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m16:31:33.417515 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:33.418691 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:31:33.418851 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m16:31:33.419105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:33.420180 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:31:33.420370 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m16:31:33.420772 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:33.421446 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m16:31:33.421605 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:31:33.422073 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m16:31:33.423604 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:31:33.424474 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m16:31:33.424622 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m16:31:33.424936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:31:33.425461 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: Close
[0m16:31:33.469575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31dc47b1-0772-49ac-83fc-b9ec5a49dd6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105871630>]}
[0m16:31:33.469968 [info ] [Thread-1 (]: 3 of 3 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.62s]
[0m16:31:33.470239 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m16:31:33.471020 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:33.471186 [debug] [MainThread]: On master: BEGIN
[0m16:31:33.471308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:33.475257 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m16:31:33.475421 [debug] [MainThread]: On master: COMMIT
[0m16:31:33.475548 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:33.475655 [debug] [MainThread]: On master: COMMIT
[0m16:31:33.475823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:31:33.475946 [debug] [MainThread]: On master: Close
[0m16:31:33.477449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:33.477612 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m16:31:33.477731 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_cardtransactions' was properly closed.
[0m16:31:33.477948 [info ] [MainThread]: 
[0m16:31:33.478117 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m16:31:33.478544 [debug] [MainThread]: Command end result
[0m16:31:33.488986 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m16:31:33.490445 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m16:31:33.493305 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m16:31:33.493453 [info ] [MainThread]: 
[0m16:31:33.493620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:33.493752 [info ] [MainThread]: 
[0m16:31:33.493972 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:31:33.494380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.646834, "process_in_blocks": "0", "process_kernel_time": 0.649887, "process_mem_max_rss": "866484224", "process_out_blocks": "0", "process_user_time": 10.872919}
[0m16:31:33.494608 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:33.494562 after 5.65 seconds
[0m16:31:33.494874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e44450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c19b0>]}
[0m16:31:33.495054 [debug] [MainThread]: Flushing usage events
[0m16:31:33.663351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:48.167989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7bc50>]}


============================== 17:12:48.170848 | 06bdbd55-157e-44b1-b65e-7cfe0a858f02 ==============================
[0m17:12:48.170848 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:12:48.171170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:12:48.180119 [info ] [MainThread]: dbt version: 1.9.2
[0m17:12:48.180332 [info ] [MainThread]: python version: 3.13.2
[0m17:12:48.180745 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m17:12:48.180943 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m17:12:48.306712 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m17:12:48.306970 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m17:12:48.307128 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m17:12:48.308701 [info ] [MainThread]: adapter type: duckdb
[0m17:12:48.308885 [info ] [MainThread]: adapter version: 1.9.1
[0m17:12:48.347496 [info ] [MainThread]: Configuration:
[0m17:12:48.347716 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:12:48.347899 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:12:48.348104 [info ] [MainThread]: Required dependencies:
[0m17:12:48.348296 [debug] [MainThread]: Executing "git --help"
[0m17:12:48.360044 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:12:48.360443 [debug] [MainThread]: STDERR: "b''"
[0m17:12:48.360601 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:12:48.360749 [info ] [MainThread]: Connection:
[0m17:12:48.360892 [info ] [MainThread]:   database: dev
[0m17:12:48.361012 [info ] [MainThread]:   schema: main
[0m17:12:48.361126 [info ] [MainThread]:   path: dev.duckdb
[0m17:12:48.361239 [info ] [MainThread]:   config_options: None
[0m17:12:48.361351 [info ] [MainThread]:   extensions: None
[0m17:12:48.361462 [info ] [MainThread]:   settings: {}
[0m17:12:48.361572 [info ] [MainThread]:   external_root: .
[0m17:12:48.361684 [info ] [MainThread]:   use_credential_provider: None
[0m17:12:48.361794 [info ] [MainThread]:   attach: None
[0m17:12:48.361904 [info ] [MainThread]:   filesystems: None
[0m17:12:48.362012 [info ] [MainThread]:   remote: None
[0m17:12:48.362120 [info ] [MainThread]:   plugins: None
[0m17:12:48.362230 [info ] [MainThread]:   disable_transactions: False
[0m17:12:48.362533 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:12:48.409650 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m17:12:48.440120 [debug] [MainThread]: Using duckdb connection "debug"
[0m17:12:48.440308 [debug] [MainThread]: On debug: select 1 as id
[0m17:12:48.440432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:48.455916 [debug] [MainThread]: SQL status: OK in 0.015 seconds
[0m17:12:48.456390 [debug] [MainThread]: On debug: Close
[0m17:12:48.457970 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:12:48.458144 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:12:48.458461 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.32597816, "process_in_blocks": "0", "process_kernel_time": 0.179282, "process_mem_max_rss": "124190720", "process_out_blocks": "0", "process_user_time": 0.649228}
[0m17:12:48.458657 [debug] [MainThread]: Command `dbt debug` succeeded at 17:12:48.458608 after 0.33 seconds
[0m17:12:48.458801 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:12:48.458955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d139b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b038a0>]}
[0m17:12:48.459141 [debug] [MainThread]: Flushing usage events
[0m17:12:48.677510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:53.920045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117192b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11345fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11345fc50>]}


============================== 17:12:53.922462 | 21c2ea5b-d611-4847-beec-1470ef393cb3 ==============================
[0m17:12:53.922462 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:12:53.922776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select final', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:12:54.020093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113760b00>]}
[0m17:12:54.044631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113536030>]}
[0m17:12:54.046254 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:12:54.096906 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:12:54.140700 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:12:54.140972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e4350>]}
[0m17:12:54.674278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a719a0>]}
[0m17:12:54.708173 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:12:54.709591 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:12:54.720019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135c4210>]}
[0m17:12:54.720258 [info ] [MainThread]: Found 9 models, 5 seeds, 4 data tests, 424 macros
[0m17:12:54.720424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d7e340>]}
[0m17:12:54.721204 [info ] [MainThread]: 
[0m17:12:54.721367 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:12:54.721492 [info ] [MainThread]: 
[0m17:12:54.721699 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:12:54.723663 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:12:54.746473 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:12:54.746660 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:12:54.746787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:54.756170 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:12:54.757414 [debug] [ThreadPool]: On list_dev: Close
[0m17:12:54.758534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:12:54.758924 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:12:54.761676 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:12:54.761824 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:12:54.761941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:54.765965 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:12:54.766681 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:12:54.766820 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:12:54.767008 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:54.767130 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:12:54.767248 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:12:54.767896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:54.768268 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:12:54.768393 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:12:54.768501 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:12:54.768672 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:54.768793 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:12:54.770285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:12:54.772773 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:12:54.772906 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:12:54.773015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:54.776877 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:12:54.777027 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:12:54.777158 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:12:54.794717 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m17:12:54.795391 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:12:54.796179 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:12:54.796319 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:12:54.798283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c7b590>]}
[0m17:12:54.798486 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:54.798608 [debug] [MainThread]: On master: BEGIN
[0m17:12:54.798719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:54.802230 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:12:54.802375 [debug] [MainThread]: On master: COMMIT
[0m17:12:54.802496 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:54.802601 [debug] [MainThread]: On master: COMMIT
[0m17:12:54.802761 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:54.802879 [debug] [MainThread]: On master: Close
[0m17:12:54.804059 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m17:12:54.804231 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m17:12:54.804454 [info ] [Thread-2 (]: 2 of 4 START sql table model main.final_cardtransactions ....................... [RUN]
[0m17:12:54.804701 [info ] [Thread-1 (]: 1 of 4 START sql table model main.final_cardevents ............................. [RUN]
[0m17:12:54.804931 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_cardtransactions'
[0m17:12:54.805109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m17:12:54.805258 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m17:12:54.805398 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m17:12:54.808384 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:54.809300 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m17:12:54.810171 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m17:12:54.816669 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m17:12:54.822239 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:12:54.823596 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:54.823776 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m17:12:54.823919 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m17:12:54.824058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:54.824193 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:12:54.828082 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:12:54.828292 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:12:54.828478 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:12:54.828652 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m17:12:54.828805 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:54.829339 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m17:12:54.829930 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:54.833727 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:54.833908 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:12:54.834510 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m17:12:54.834757 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:54.834939 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    case 
        when ORIGINAL_CURRENCY_CODE = 'ILR' then 'ILS'
        when ORIGINAL_CURRENCY_CODE = 'ARY' then 'ARS'
        when ORIGINAL_CURRENCY_CODE = 'MXP' then 'MXN'
        when ORIGINAL_CURRENCY_CODE = 'CSJ' then 'CZK'
        when ORIGINAL_CURRENCY_CODE = 'VNC' then 'VND'
        when ORIGINAL_CURRENCY_CODE = 'PES' then 'PEN'
        else ORIGINAL_CURRENCY_CODE
    end as ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    CAST(TIMESTAMP AS DATE) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m17:12:54.835183 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:12:54.835337 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m17:12:55.671700 [debug] [Thread-1 (]: SQL status: OK in 0.835 seconds
[0m17:12:55.681541 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:12:55.681742 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m17:12:55.682719 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:55.683931 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:12:55.684095 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m17:12:55.684366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:55.686762 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:12:55.686934 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m17:12:55.687338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:55.693060 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:12:55.693251 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:12:55.693399 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:12:55.954852 [debug] [Thread-2 (]: SQL status: OK in 1.120 seconds
[0m17:12:55.956305 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:55.956490 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions" rename to "final_cardtransactions__dbt_backup"
[0m17:12:55.956936 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:55.958057 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:55.958209 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions__dbt_tmp" rename to "final_cardtransactions"
[0m17:12:55.958464 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:55.959305 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:55.959454 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        CREATE INDEX IF NOT EXISTS idx_card_tx ON "dev"."main"."final_cardtransactions" (transaction_id)
      
[0m17:12:55.959851 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:55.960561 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:12:55.960727 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:55.960870 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:12:58.928561 [debug] [Thread-1 (]: SQL status: OK in 3.235 seconds
[0m17:12:58.932966 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:12:58.933154 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m17:12:59.532335 [debug] [Thread-2 (]: SQL status: OK in 3.571 seconds
[0m17:12:59.533475 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:12:59.533664 [debug] [Thread-1 (]: SQL status: OK in 0.600 seconds
[0m17:12:59.533867 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
drop table if exists "dev"."main"."final_cardtransactions__dbt_backup" cascade
[0m17:12:59.536235 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m17:12:59.540047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f3f8b0>]}
[0m17:12:59.540607 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 4.73s]
[0m17:12:59.540919 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m17:12:59.541138 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_currencyconv
[0m17:12:59.541521 [info ] [Thread-1 (]: 3 of 4 START sql table model main.final_currencyconv ........................... [RUN]
[0m17:12:59.541790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardevents, now model.slash_analytics_take_home.final_currencyconv)
[0m17:12:59.541973 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_currencyconv
[0m17:12:59.543517 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:12:59.544315 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_currencyconv
[0m17:12:59.546419 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:12:59.550389 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:12:59.550914 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: BEGIN
[0m17:12:59.551123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:59.551494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:59.551704 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:12:59.551854 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */

  
    
    

    create  table
      "dev"."main"."final_currencyconv__dbt_tmp"
  
    as (
      select * from "dev"."main"."currency_conv"
    );
  
  
[0m17:12:59.591994 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */

  
    
    

    create  table
      "dev"."main"."final_currencyconv__dbt_tmp"
  
    as (
      select * from "dev"."main"."currency_conv"
    );
  
  
[0m17:12:59.592389 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:12:59.592699 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: ROLLBACK
[0m17:12:59.599963 [debug] [Thread-1 (]: Failed to rollback 'model.slash_analytics_take_home.final_currencyconv'
[0m17:12:59.600206 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: Close
[0m17:12:59.602604 [debug] [Thread-1 (]: Runtime Error in model final_currencyconv (models/final/final_currencyconv.sql)
  Catalog Error: Table with name currency_conv does not exist!
  Did you mean "card_transactions"?
  LINE 11:       select * from "dev"."main"."currency_conv"
                               ^
[0m17:12:59.602893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142ed1d0>]}
[0m17:12:59.603222 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model main.final_currencyconv .................. [[31mERROR[0m in 0.06s]
[0m17:12:59.603539 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_currencyconv
[0m17:12:59.603761 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_entity
[0m17:12:59.604167 [info ] [Thread-1 (]: 4 of 4 START sql table model main.final_entity ................................. [RUN]
[0m17:12:59.604593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_currencyconv, now model.slash_analytics_take_home.final_entity)
[0m17:12:59.604769 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m17:12:59.606167 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m17:12:59.606538 [debug] [Thread-5 (]: Marking all children of 'model.slash_analytics_take_home.final_currencyconv' to be skipped because of status 'error'.  Reason: Runtime Error in model final_currencyconv (models/final/final_currencyconv.sql)
  Catalog Error: Table with name currency_conv does not exist!
  Did you mean "card_transactions"?
  LINE 11:       select * from "dev"."main"."currency_conv"
                               ^.
[0m17:12:59.607599 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m17:12:59.614510 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:12:59.614821 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m17:12:59.615029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:59.615599 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:59.615809 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:12:59.615975 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m17:13:00.337674 [debug] [Thread-2 (]: SQL status: OK in 0.801 seconds
[0m17:13:00.337965 [debug] [Thread-1 (]: SQL status: OK in 0.722 seconds
[0m17:13:00.338967 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m17:13:00.339549 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m17:13:00.339842 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d66cd0>]}
[0m17:13:00.340121 [info ] [Thread-2 (]: 2 of 4 OK created sql table model main.final_cardtransactions .................. [[32mOK[0m in 5.53s]
[0m17:13:00.340369 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m17:13:00.342862 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:13:00.343011 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m17:13:00.344774 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:13:00.345843 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:13:00.345983 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m17:13:00.346233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:13:00.347347 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:13:00.347526 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m17:13:00.347886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:13:00.348921 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:13:00.349120 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m17:13:00.349547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:13:00.350244 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:13:00.350414 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:13:00.350574 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:13:00.352359 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:13:00.353895 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:13:00.354080 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m17:13:00.354531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:13:00.355275 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_entity: Close
[0m17:13:00.410166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21c2ea5b-d611-4847-beec-1470ef393cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d4f2a0>]}
[0m17:13:00.410554 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.81s]
[0m17:13:00.410825 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m17:13:00.411605 [debug] [MainThread]: Using duckdb connection "master"
[0m17:13:00.411762 [debug] [MainThread]: On master: BEGIN
[0m17:13:00.411882 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:00.415964 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:13:00.416135 [debug] [MainThread]: On master: COMMIT
[0m17:13:00.416267 [debug] [MainThread]: Using duckdb connection "master"
[0m17:13:00.416374 [debug] [MainThread]: On master: COMMIT
[0m17:13:00.416537 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:13:00.416657 [debug] [MainThread]: On master: Close
[0m17:13:00.418337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:00.418483 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m17:13:00.418600 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_cardtransactions' was properly closed.
[0m17:13:00.418787 [info ] [MainThread]: 
[0m17:13:00.418941 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m17:13:00.419395 [debug] [MainThread]: Command end result
[0m17:13:00.438217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:13:00.446042 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:13:00.455987 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m17:13:00.456176 [info ] [MainThread]: 
[0m17:13:00.456353 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:13:00.456522 [info ] [MainThread]: 
[0m17:13:00.456702 [error] [MainThread]:   Runtime Error in model final_currencyconv (models/final/final_currencyconv.sql)
  Catalog Error: Table with name currency_conv does not exist!
  Did you mean "card_transactions"?
  LINE 11:       select * from "dev"."main"."currency_conv"
                               ^
[0m17:13:00.456842 [info ] [MainThread]: 
[0m17:13:00.457003 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:13:00.457342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.569766, "process_in_blocks": "0", "process_kernel_time": 0.725662, "process_mem_max_rss": "890896384", "process_out_blocks": "0", "process_user_time": 11.234267}
[0m17:13:00.457529 [debug] [MainThread]: Command `dbt run` failed at 17:13:00.457495 after 6.57 seconds
[0m17:13:00.457764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113991370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d73d70>]}
[0m17:13:00.457915 [debug] [MainThread]: Flushing usage events
[0m17:13:00.624270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:34.627991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cdd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5fc50>]}


============================== 17:15:34.630957 | 51a77160-56b1-4553-ac65-5fb1a8a4ea5c ==============================
[0m17:15:34.630957 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:15:34.631284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:34.788358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107260b00>]}
[0m17:15:34.812542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eee030>]}
[0m17:15:34.814400 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:15:34.865117 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:15:34.931450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:34.931639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:34.953383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ea750>]}
[0m17:15:34.986710 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:15:34.987674 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:15:35.000821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107303d40>]}
[0m17:15:35.001036 [info ] [MainThread]: Found 9 models, 5 seeds, 4 data tests, 424 macros
[0m17:15:35.001201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107628910>]}
[0m17:15:35.002112 [info ] [MainThread]: 
[0m17:15:35.002289 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:15:35.002414 [info ] [MainThread]: 
[0m17:15:35.002634 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:15:35.004620 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:15:35.039740 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:15:35.039950 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:15:35.040091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:35.059621 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m17:15:35.060811 [debug] [ThreadPool]: On list_dev: Close
[0m17:15:35.062478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:15:35.062693 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:15:35.065458 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:15:35.065605 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:15:35.065727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:35.069699 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:15:35.070411 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:15:35.070541 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:15:35.070718 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:15:35.070837 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:15:35.070953 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:15:35.071738 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:15:35.072095 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:15:35.072218 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:15:35.072320 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:15:35.072477 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:15:35.072596 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:15:35.074054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:15:35.076250 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:15:35.076379 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:15:35.076486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:35.079961 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m17:15:35.080104 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:15:35.080234 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:15:35.097768 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m17:15:35.098753 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:15:35.099499 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:15:35.099650 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:15:35.101554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101657e0>]}
[0m17:15:35.101770 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:35.101895 [debug] [MainThread]: On master: BEGIN
[0m17:15:35.102004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:35.105436 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:15:35.105583 [debug] [MainThread]: On master: COMMIT
[0m17:15:35.105708 [debug] [MainThread]: Using duckdb connection "master"
[0m17:15:35.105823 [debug] [MainThread]: On master: COMMIT
[0m17:15:35.105988 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:15:35.106107 [debug] [MainThread]: On master: Close
[0m17:15:35.107319 [debug] [Thread-1 (]: Began running node seed.slash_analytics_take_home.card_events
[0m17:15:35.107490 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.card_transactions
[0m17:15:35.107707 [info ] [Thread-1 (]: 1 of 5 START seed file main.card_events ........................................ [RUN]
[0m17:15:35.108084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.slash_analytics_take_home.card_events)
[0m17:15:35.107895 [info ] [Thread-2 (]: 2 of 5 START seed file main.card_transactions .................................. [RUN]
[0m17:15:35.108274 [debug] [Thread-1 (]: Began compiling node seed.slash_analytics_take_home.card_events
[0m17:15:35.108476 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.slash_analytics_take_home.card_transactions'
[0m17:15:35.108624 [debug] [Thread-1 (]: Began executing node seed.slash_analytics_take_home.card_events
[0m17:15:35.108759 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.card_transactions
[0m17:15:35.115394 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.card_transactions
[0m17:16:00.886255 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m17:16:00.893789 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: BEGIN
[0m17:16:00.900335 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:16:00.949272 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m17:16:00.955808 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m17:16:00.962285 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.card_transactions"} */
truncate table "dev"."main"."card_transactions"
[0m17:16:01.001550 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m17:16:01.023517 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m17:16:01.030000 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: 
          COPY "dev"."main"."card_transactions" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/card_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:16:02.884803 [debug] [Thread-2 (]: SQL status: OK in 1.839 seconds
[0m17:16:03.384002 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.card_transactions"
[0m17:16:03.438331 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: COMMIT
[0m17:16:03.444999 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m17:16:03.451170 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: COMMIT
[0m17:16:03.515559 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m17:16:03.523800 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: Close
[0m17:16:03.637663 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101d4110>]}
[0m17:16:03.644961 [info ] [Thread-2 (]: 2 of 5 OK loaded seed file main.card_transactions .............................. [[32mINSERT 909419[0m in 28.46s]
[0m17:16:03.656651 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.card_transactions
[0m17:16:03.663346 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.currency
[0m17:16:03.676062 [info ] [Thread-2 (]: 3 of 5 START seed file main.currency ........................................... [RUN]
[0m17:16:03.691361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.card_transactions, now seed.slash_analytics_take_home.currency)
[0m17:16:03.698342 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.currency
[0m17:16:03.710975 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.currency
[0m17:16:03.764161 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency"
[0m17:16:03.771615 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency: BEGIN
[0m17:16:03.778100 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:16:03.814870 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m17:16:03.821423 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency"
[0m17:16:03.828774 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.currency"} */

    create table "dev"."main"."currency" ("CURRENCY_CODE" text,"CURRENCY_NAME" text,"EXCHANGE_RATE" float8)
  
[0m17:16:03.855957 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m17:16:03.862993 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency"
[0m17:16:03.869451 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency: 
          COPY "dev"."main"."currency" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/currency.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:16:03.895870 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m17:16:03.902558 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.currency"
[0m17:16:03.939843 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency: COMMIT
[0m17:16:03.946339 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency"
[0m17:16:03.952597 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency: COMMIT
[0m17:16:03.983906 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m17:16:03.990724 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency: Close
[0m17:16:04.025081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107641910>]}
[0m17:16:04.037997 [info ] [Thread-2 (]: 3 of 5 OK loaded seed file main.currency ....................................... [[32mINSERT 181[0m in 0.34s]
[0m17:16:04.051095 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.currency
[0m17:16:04.057700 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.currency_conv
[0m17:16:04.070558 [info ] [Thread-2 (]: 4 of 5 START seed file main.currency_conv ...................................... [RUN]
[0m17:16:04.082946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.currency, now seed.slash_analytics_take_home.currency_conv)
[0m17:16:04.084916 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.currency_conv
[0m17:16:04.085668 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.currency_conv
[0m17:16:10.247574 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency_conv"
[0m17:16:10.262065 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: BEGIN
[0m17:16:10.268230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:16:10.305893 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m17:16:10.312369 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency_conv"
[0m17:16:10.318847 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.currency_conv"} */

    create table "dev"."main"."currency_conv" ("conversion_dt" datetime,"source_currency" varchar,"destination_currency" varchar,"exchange_rate" float)
  
[0m17:16:10.344294 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m17:16:10.351566 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency_conv"
[0m17:16:10.358019 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: 
          COPY "dev"."main"."currency_conv" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/currency_conv.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:16:10.472142 [debug] [Thread-2 (]: SQL status: OK in 0.108 seconds
[0m17:16:10.479011 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.currency_conv"
[0m17:16:10.518631 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: COMMIT
[0m17:16:10.525106 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency_conv"
[0m17:16:10.531290 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: COMMIT
[0m17:16:10.555759 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m17:16:10.562611 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: Close
[0m17:16:10.597958 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bc410>]}
[0m17:16:10.611067 [info ] [Thread-2 (]: 4 of 5 OK loaded seed file main.currency_conv .................................. [[32mINSERT 130685[0m in 6.51s]
[0m17:16:10.619886 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.currency_conv
[0m17:16:10.626484 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.entity
[0m17:16:10.641512 [info ] [Thread-2 (]: 5 of 5 START seed file main.entity ............................................. [RUN]
[0m17:16:10.650397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.currency_conv, now seed.slash_analytics_take_home.entity)
[0m17:16:10.650731 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.entity
[0m17:16:10.659303 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.entity
[0m17:16:10.709263 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m17:16:10.715817 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: BEGIN
[0m17:16:10.726071 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:16:10.761762 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m17:16:10.768215 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m17:16:10.774641 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.entity"} */
truncate table "dev"."main"."entity"
[0m17:16:10.800040 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m17:16:10.806942 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m17:16:10.813387 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: 
          COPY "dev"."main"."entity" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/entity.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:16:10.873367 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m17:16:10.879974 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.entity"
[0m17:16:10.924771 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: COMMIT
[0m17:16:10.931206 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m17:16:10.937452 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: COMMIT
[0m17:16:10.962848 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m17:16:10.969630 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: Close
[0m17:16:11.010434 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11009d550>]}
[0m17:16:11.017014 [info ] [Thread-2 (]: 5 of 5 OK loaded seed file main.entity ......................................... [[32mINSERT 1811[0m in 0.36s]
[0m17:16:11.029969 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.entity
[0m17:16:26.543468 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m17:16:26.545537 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: BEGIN
[0m17:16:26.545913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:26.555654 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m17:16:26.555882 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m17:16:26.556038 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.card_events"} */
truncate table "dev"."main"."card_events"
[0m17:16:26.584073 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m17:16:26.585173 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m17:16:26.585338 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: 
          COPY "dev"."main"."card_events" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/card_events.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:16:29.452334 [debug] [Thread-1 (]: SQL status: OK in 2.866 seconds
[0m17:16:29.459726 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.card_events"
[0m17:16:29.462416 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: COMMIT
[0m17:16:29.462775 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m17:16:29.462933 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: COMMIT
[0m17:16:29.551073 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m17:16:29.551891 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: Close
[0m17:16:29.563875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a77160-56b1-4553-ac65-5fb1a8a4ea5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101cd0f0>]}
[0m17:16:29.564354 [info ] [Thread-1 (]: 1 of 5 OK loaded seed file main.card_events .................................... [[32mINSERT 3499969[0m in 54.46s]
[0m17:16:29.564676 [debug] [Thread-1 (]: Finished running node seed.slash_analytics_take_home.card_events
[0m17:16:29.578539 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:29.578731 [debug] [MainThread]: On master: BEGIN
[0m17:16:29.578871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:29.583856 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:16:29.584040 [debug] [MainThread]: On master: COMMIT
[0m17:16:29.584171 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:29.584294 [debug] [MainThread]: On master: COMMIT
[0m17:16:29.584476 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:16:29.584598 [debug] [MainThread]: On master: Close
[0m17:16:29.586034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:29.586165 [debug] [MainThread]: Connection 'seed.slash_analytics_take_home.card_events' was properly closed.
[0m17:16:29.586269 [debug] [MainThread]: Connection 'seed.slash_analytics_take_home.entity' was properly closed.
[0m17:16:29.586475 [info ] [MainThread]: 
[0m17:16:29.586664 [info ] [MainThread]: Finished running 5 seeds in 0 hours 0 minutes and 54.58 seconds (54.58s).
[0m17:16:29.587347 [debug] [MainThread]: Command end result
[0m17:16:29.869539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:16:29.872350 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:16:29.876257 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m17:16:29.876431 [info ] [MainThread]: 
[0m17:16:29.876679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:29.876818 [info ] [MainThread]: 
[0m17:16:29.877258 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:16:29.878317 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 55.28615, "process_in_blocks": "0", "process_kernel_time": 20.73378, "process_mem_max_rss": "2794143744", "process_out_blocks": "0", "process_user_time": 32.648304}
[0m17:16:29.878541 [debug] [MainThread]: Command `dbt seed` succeeded at 17:16:29.878502 after 55.29 seconds
[0m17:16:29.878798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x32b67cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8e150>]}
[0m17:16:29.878948 [debug] [MainThread]: Flushing usage events
[0m17:16:30.182477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:37.863228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdfc50>]}


============================== 17:16:37.865858 | 06936c41-c13b-410f-b6cc-e3dfdd21bb55 ==============================
[0m17:16:37.865858 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:16:37.866168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select final', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:37.984726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd4b00>]}
[0m17:16:38.007185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6e030>]}
[0m17:16:38.008703 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:16:38.058338 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:16:38.124313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:38.124523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:38.146350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6a750>]}
[0m17:16:38.179842 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:16:38.180647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:16:38.192569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7fb60>]}
[0m17:16:38.192783 [info ] [MainThread]: Found 9 models, 5 seeds, 4 data tests, 424 macros
[0m17:16:38.192948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d54050>]}
[0m17:16:38.193752 [info ] [MainThread]: 
[0m17:16:38.193919 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:16:38.194046 [info ] [MainThread]: 
[0m17:16:38.194264 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:16:38.196210 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:16:38.231137 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:16:38.231341 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:16:38.231477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:38.239798 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:16:38.240758 [debug] [ThreadPool]: On list_dev: Close
[0m17:16:38.241799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:16:38.242187 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:16:38.244926 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:16:38.245076 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:16:38.245192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:38.249295 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:16:38.249866 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:16:38.249990 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:16:38.250170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:16:38.250286 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:16:38.250404 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:16:38.250615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:16:38.250971 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:16:38.251093 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:16:38.251197 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:16:38.251366 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:16:38.251486 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:16:38.253024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:16:38.255268 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:16:38.255401 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:16:38.255509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:38.259144 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:16:38.259300 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:16:38.259434 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:16:38.276237 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m17:16:38.277195 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:16:38.277952 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:16:38.278097 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:16:38.279998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109471640>]}
[0m17:16:38.280211 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:38.280330 [debug] [MainThread]: On master: BEGIN
[0m17:16:38.280439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:38.283933 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m17:16:38.284082 [debug] [MainThread]: On master: COMMIT
[0m17:16:38.284208 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:38.284315 [debug] [MainThread]: On master: COMMIT
[0m17:16:38.284478 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:16:38.284599 [debug] [MainThread]: On master: Close
[0m17:16:38.285847 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m17:16:38.286039 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m17:16:38.286254 [info ] [Thread-2 (]: 2 of 4 START sql table model main.final_cardtransactions ....................... [RUN]
[0m17:16:38.286478 [info ] [Thread-1 (]: 1 of 4 START sql table model main.final_cardevents ............................. [RUN]
[0m17:16:38.286728 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_cardtransactions'
[0m17:16:38.286904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m17:16:38.287060 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m17:16:38.287203 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m17:16:38.290330 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:38.291286 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m17:16:38.291935 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m17:16:38.292113 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m17:16:38.303556 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:16:38.304917 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:38.305097 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m17:16:38.305247 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m17:16:38.305386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:38.305518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:16:38.309348 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:16:38.309511 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:16:38.309668 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:16:38.309846 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m17:16:38.310005 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:38.310276 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m17:16:38.310727 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:38.314488 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:38.314657 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:16:38.315233 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m17:16:38.315535 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:38.315746 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    case 
        when ORIGINAL_CURRENCY_CODE = 'ILR' then 'ILS'
        when ORIGINAL_CURRENCY_CODE = 'ARY' then 'ARS'
        when ORIGINAL_CURRENCY_CODE = 'MXP' then 'MXN'
        when ORIGINAL_CURRENCY_CODE = 'CSJ' then 'CZK'
        when ORIGINAL_CURRENCY_CODE = 'VNC' then 'VND'
        when ORIGINAL_CURRENCY_CODE = 'PES' then 'PEN'
        else ORIGINAL_CURRENCY_CODE
    end as ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    CAST(TIMESTAMP AS DATE) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m17:16:38.315940 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:16:38.316197 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m17:16:39.012162 [debug] [Thread-1 (]: SQL status: OK in 0.696 seconds
[0m17:16:39.015109 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:16:39.015305 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m17:16:39.015970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:39.017189 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:16:39.017368 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m17:16:39.017677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:39.019999 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:16:39.020184 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m17:16:39.020627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:39.026243 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:16:39.026459 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:16:39.026636 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:16:39.473058 [debug] [Thread-2 (]: SQL status: OK in 1.157 seconds
[0m17:16:39.474661 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:39.474893 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions" rename to "final_cardtransactions__dbt_backup"
[0m17:16:39.475360 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:39.476631 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:39.476803 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions__dbt_tmp" rename to "final_cardtransactions"
[0m17:16:39.477132 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:39.478045 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:39.478215 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        CREATE INDEX IF NOT EXISTS idx_card_tx ON "dev"."main"."final_cardtransactions" (transaction_id)
      
[0m17:16:39.478699 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:39.479517 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:16:39.479727 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:39.479900 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:16:42.431597 [debug] [Thread-1 (]: SQL status: OK in 3.405 seconds
[0m17:16:42.434409 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:16:42.434603 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m17:16:42.986329 [debug] [Thread-2 (]: SQL status: OK in 3.506 seconds
[0m17:16:42.987458 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:16:42.987650 [debug] [Thread-1 (]: SQL status: OK in 0.553 seconds
[0m17:16:42.987844 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
drop table if exists "dev"."main"."final_cardtransactions__dbt_backup" cascade
[0m17:16:42.988972 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m17:16:42.993928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109147b90>]}
[0m17:16:42.994252 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 4.70s]
[0m17:16:42.994521 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m17:16:42.994699 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_currencyconv
[0m17:16:42.994893 [info ] [Thread-1 (]: 3 of 4 START sql table model main.final_currencyconv ........................... [RUN]
[0m17:16:42.995155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardevents, now model.slash_analytics_take_home.final_currencyconv)
[0m17:16:42.995335 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_currencyconv
[0m17:16:42.996468 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:16:42.999290 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_currencyconv
[0m17:16:43.005228 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:16:43.006320 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:16:43.006521 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: BEGIN
[0m17:16:43.006677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:43.010004 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:16:43.010408 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:16:43.010782 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */

  
    
    

    create  table
      "dev"."main"."final_currencyconv__dbt_tmp"
  
    as (
      select * from "dev"."main"."currency_conv"
    );
  
  
[0m17:16:43.549034 [debug] [Thread-2 (]: SQL status: OK in 0.560 seconds
[0m17:16:43.549856 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m17:16:43.550147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c2af0>]}
[0m17:16:43.550448 [info ] [Thread-2 (]: 2 of 4 OK created sql table model main.final_cardtransactions .................. [[32mOK[0m in 5.26s]
[0m17:16:43.550723 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m17:16:43.550913 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_entity
[0m17:16:43.551174 [info ] [Thread-2 (]: 4 of 4 START sql table model main.final_entity ................................. [RUN]
[0m17:16:43.551426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardtransactions, now model.slash_analytics_take_home.final_entity)
[0m17:16:43.551601 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m17:16:43.552792 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m17:16:43.555128 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m17:16:43.556707 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:16:43.556911 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m17:16:43.557077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:16:43.557503 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:43.557662 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:16:43.557833 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m17:16:43.558351 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:43.559021 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m17:16:43.560228 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:16:43.560503 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m17:16:43.563280 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:16:43.564483 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:16:43.564649 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m17:16:43.564962 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:43.566284 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:16:43.566460 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m17:16:43.566769 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:43.567636 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:16:43.567813 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m17:16:43.568180 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:43.568836 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:16:43.569002 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:16:43.569152 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:16:43.570783 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:16:43.571932 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:16:43.572112 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m17:16:43.572450 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:16:43.573073 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: Close
[0m17:16:43.573352 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095839d0>]}
[0m17:16:43.573666 [info ] [Thread-2 (]: 4 of 4 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.02s]
[0m17:16:43.573934 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m17:16:43.577260 [debug] [Thread-1 (]: SQL status: OK in 0.566 seconds
[0m17:16:43.578405 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:16:43.578557 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv__dbt_tmp" rename to "final_currencyconv"
[0m17:16:43.578803 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:43.579454 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m17:16:43.579606 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:16:43.579738 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m17:16:43.585123 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:16:43.585998 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:16:43.586151 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
drop table if exists "dev"."main"."final_currencyconv__dbt_backup" cascade
[0m17:16:43.586391 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:16:43.586921 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: Close
[0m17:16:43.626389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06936c41-c13b-410f-b6cc-e3dfdd21bb55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944eed0>]}
[0m17:16:43.626787 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.final_currencyconv ...................... [[32mOK[0m in 0.63s]
[0m17:16:43.627054 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_currencyconv
[0m17:16:43.627719 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:43.627859 [debug] [MainThread]: On master: BEGIN
[0m17:16:43.627972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:43.632494 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:16:43.632674 [debug] [MainThread]: On master: COMMIT
[0m17:16:43.632822 [debug] [MainThread]: Using duckdb connection "master"
[0m17:16:43.632947 [debug] [MainThread]: On master: COMMIT
[0m17:16:43.633275 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:16:43.633627 [debug] [MainThread]: On master: Close
[0m17:16:43.635043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:43.635198 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_currencyconv' was properly closed.
[0m17:16:43.635316 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m17:16:43.635512 [info ] [MainThread]: 
[0m17:16:43.635665 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m17:16:43.636128 [debug] [MainThread]: Command end result
[0m17:16:43.646822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:16:43.648016 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:16:43.650636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m17:16:43.650787 [info ] [MainThread]: 
[0m17:16:43.650958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:43.651091 [info ] [MainThread]: 
[0m17:16:43.651235 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:16:43.651524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.824243, "process_in_blocks": "0", "process_kernel_time": 3.333339, "process_mem_max_rss": "1119420416", "process_out_blocks": "0", "process_user_time": 13.450751}
[0m17:16:43.651713 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:43.651673 after 5.82 seconds
[0m17:16:43.651877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c219b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb6040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953c6b0>]}
[0m17:16:43.652027 [debug] [MainThread]: Flushing usage events
[0m17:16:43.818017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:55.497013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5bc50>]}


============================== 17:20:55.499458 | 274b2c5b-a2ef-4fc8-a7b5-4f86eb176d5a ==============================
[0m17:20:55.499458 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:20:55.499759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/prashulkumar/.dbt', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select final', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:55.593158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '274b2c5b-a2ef-4fc8-a7b5-4f86eb176d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715cb00>]}
[0m17:20:55.615243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '274b2c5b-a2ef-4fc8-a7b5-4f86eb176d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fea030>]}
[0m17:20:55.617478 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:20:55.665735 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:20:55.727142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:55.727454 [debug] [MainThread]: Partial parsing: updated file: slash_analytics_take_home://models/final/final_currencyconv.sql
[0m17:20:55.831838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '274b2c5b-a2ef-4fc8-a7b5-4f86eb176d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e2c50>]}
[0m17:20:55.863698 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:20:55.864533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:20:55.874672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '274b2c5b-a2ef-4fc8-a7b5-4f86eb176d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107366e40>]}
[0m17:20:55.874906 [info ] [MainThread]: Found 9 models, 5 seeds, 4 data tests, 424 macros
[0m17:20:55.875066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '274b2c5b-a2ef-4fc8-a7b5-4f86eb176d5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107692a50>]}
[0m17:20:55.875847 [info ] [MainThread]: 
[0m17:20:55.876013 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:20:55.876137 [info ] [MainThread]: 
[0m17:20:55.876354 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:20:55.878435 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:20:55.909282 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:20:55.909546 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:20:55.909712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:55.916855 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:20:55.917058 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:20:55.917452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:55.917606 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:20:55.917743 [info ] [MainThread]: 
[0m17:20:55.917896 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m17:20:55.918130 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.2.0/bin/duckdb (PID 45044) by user prashulkumar. See also https://duckdb.org/docs/connect/concurrency
[0m17:20:55.918494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4532315, "process_in_blocks": "0", "process_kernel_time": 0.144086, "process_mem_max_rss": "129286144", "process_out_blocks": "0", "process_user_time": 0.857947}
[0m17:20:55.918754 [debug] [MainThread]: Command `dbt run` failed at 17:20:55.918704 after 0.45 seconds
[0m17:20:55.918949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e556d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790c110>]}
[0m17:20:55.919114 [debug] [MainThread]: Flushing usage events
[0m17:20:56.203436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:07.477941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c552b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad3c50>]}


============================== 17:21:07.479869 | 963a0492-3c65-4923-8de2-27e82b3e3d21 ==============================
[0m17:21:07.479869 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:21:07.480195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select final', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:07.571969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc4b00>]}
[0m17:21:07.594401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b62030>]}
[0m17:21:07.595519 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:21:07.643936 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:21:07.704706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:21:07.704894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:21:07.726731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6a750>]}
[0m17:21:07.759077 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:21:07.759851 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:21:07.769784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d73b60>]}
[0m17:21:07.769997 [info ] [MainThread]: Found 9 models, 5 seeds, 4 data tests, 424 macros
[0m17:21:07.770167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c50050>]}
[0m17:21:07.770950 [info ] [MainThread]: 
[0m17:21:07.771114 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:21:07.771239 [info ] [MainThread]: 
[0m17:21:07.771451 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:21:07.773410 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:21:07.797027 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:21:07.797218 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:21:07.797368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:07.802347 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:21:07.803009 [debug] [ThreadPool]: On list_dev: Close
[0m17:21:07.804133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:21:07.804334 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:21:07.807072 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:21:07.807219 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:21:07.807338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:07.811382 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:21:07.812000 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:21:07.812125 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:21:07.812309 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:07.812424 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:21:07.812531 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:21:07.812727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:07.813064 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:21:07.813183 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:21:07.813286 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:21:07.813448 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:21:07.813564 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:21:07.815112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:21:07.817385 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:21:07.817549 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:21:07.817669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:07.821366 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:21:07.821504 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:21:07.821631 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:21:07.835624 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m17:21:07.836604 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:21:07.837384 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:21:07.837514 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:21:07.839499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109364fc0>]}
[0m17:21:07.839717 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:07.839844 [debug] [MainThread]: On master: BEGIN
[0m17:21:07.839953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:07.843603 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:21:07.843743 [debug] [MainThread]: On master: COMMIT
[0m17:21:07.843856 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:07.843961 [debug] [MainThread]: On master: COMMIT
[0m17:21:07.844124 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:07.844234 [debug] [MainThread]: On master: Close
[0m17:21:07.845547 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m17:21:07.845719 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m17:21:07.845953 [info ] [Thread-2 (]: 2 of 4 START sql table model main.final_cardtransactions ....................... [RUN]
[0m17:21:07.846213 [info ] [Thread-1 (]: 1 of 4 START sql table model main.final_cardevents ............................. [RUN]
[0m17:21:07.846447 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_cardtransactions'
[0m17:21:07.846614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m17:21:07.846768 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m17:21:07.846907 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m17:21:07.849995 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:07.850942 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m17:21:07.851341 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m17:21:07.851503 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m17:21:07.863060 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:07.864412 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:21:07.864588 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m17:21:07.864740 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m17:21:07.864891 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:21:07.865027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:07.868898 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:21:07.869070 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:07.869228 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:21:07.869399 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m17:21:07.869578 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:21:07.869775 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m17:21:07.870236 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:07.874065 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:07.874242 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:21:07.874822 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m17:21:07.875130 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:07.875336 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    case 
        when ORIGINAL_CURRENCY_CODE = 'ILR' then 'ILS'
        when ORIGINAL_CURRENCY_CODE = 'ARY' then 'ARS'
        when ORIGINAL_CURRENCY_CODE = 'MXP' then 'MXN'
        when ORIGINAL_CURRENCY_CODE = 'CSJ' then 'CZK'
        when ORIGINAL_CURRENCY_CODE = 'VNC' then 'VND'
        when ORIGINAL_CURRENCY_CODE = 'PES' then 'PEN'
        else ORIGINAL_CURRENCY_CODE
    end as ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    CAST(TIMESTAMP AS DATE) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m17:21:07.875527 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:21:07.875782 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m17:21:08.582987 [debug] [Thread-1 (]: SQL status: OK in 0.707 seconds
[0m17:21:08.586301 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:21:08.586497 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m17:21:08.586889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:08.588046 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:21:08.588203 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m17:21:08.588460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:08.590753 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:21:08.590927 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m17:21:08.591306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:08.596880 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:21:08.597061 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:21:08.597208 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:21:09.211514 [debug] [Thread-2 (]: SQL status: OK in 1.336 seconds
[0m17:21:09.213002 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:09.213197 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions" rename to "final_cardtransactions__dbt_backup"
[0m17:21:09.213572 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:09.214718 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:09.214880 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions__dbt_tmp" rename to "final_cardtransactions"
[0m17:21:09.215155 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:09.216036 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:09.216199 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        CREATE INDEX IF NOT EXISTS idx_card_tx ON "dev"."main"."final_cardtransactions" (transaction_id)
      
[0m17:21:09.216592 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:09.217328 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:21:09.217499 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:09.217651 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:21:11.789116 [debug] [Thread-1 (]: SQL status: OK in 3.192 seconds
[0m17:21:11.792411 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:21:11.792602 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m17:21:12.379265 [debug] [Thread-2 (]: SQL status: OK in 3.161 seconds
[0m17:21:12.380457 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:21:12.380653 [debug] [Thread-1 (]: SQL status: OK in 0.588 seconds
[0m17:21:12.380842 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
drop table if exists "dev"."main"."final_cardtransactions__dbt_backup" cascade
[0m17:21:12.382141 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m17:21:12.384408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109043b90>]}
[0m17:21:12.384866 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 4.54s]
[0m17:21:12.385167 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m17:21:12.385359 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_currencyconv
[0m17:21:12.385636 [info ] [Thread-1 (]: 3 of 4 START sql table model main.final_currencyconv ........................... [RUN]
[0m17:21:12.385872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardevents, now model.slash_analytics_take_home.final_currencyconv)
[0m17:21:12.386057 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_currencyconv
[0m17:21:12.387237 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:21:12.387611 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_currencyconv
[0m17:21:12.395743 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:21:12.396788 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:21:12.397173 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: BEGIN
[0m17:21:12.397525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:12.398213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:21:12.398615 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:21:12.398994 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */

  
    
    

    create  table
      "dev"."main"."final_currencyconv__dbt_tmp"
  
    as (
      select 
 CAST(conversion_dt AS DATE) as conversion_dt,source_currency,destination_currency,exchange_rate
 from "dev"."main"."currency_conv"
    );
  
  
[0m17:21:12.860076 [debug] [Thread-2 (]: SQL status: OK in 0.478 seconds
[0m17:21:12.864670 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m17:21:12.864993 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b64c0>]}
[0m17:21:12.865297 [info ] [Thread-2 (]: 2 of 4 OK created sql table model main.final_cardtransactions .................. [[32mOK[0m in 5.02s]
[0m17:21:12.865553 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m17:21:12.865731 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_entity
[0m17:21:12.865983 [info ] [Thread-2 (]: 4 of 4 START sql table model main.final_entity ................................. [RUN]
[0m17:21:12.866226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardtransactions, now model.slash_analytics_take_home.final_entity)
[0m17:21:12.866402 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m17:21:12.867576 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m17:21:12.867923 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m17:21:12.869379 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:21:12.869557 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m17:21:12.869712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:12.870043 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.870198 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:21:12.870354 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m17:21:12.870767 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.871496 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m17:21:12.871948 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:21:12.872418 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m17:21:12.877038 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:21:12.878332 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:21:12.878534 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m17:21:12.878874 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.879998 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:21:12.880152 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m17:21:12.880403 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.881241 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:21:12.881403 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m17:21:12.881775 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.882457 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:21:12.882646 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:21:12.882802 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:21:12.884302 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:21:12.885460 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:21:12.885639 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m17:21:12.885987 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.886546 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: Close
[0m17:21:12.886780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109477930>]}
[0m17:21:12.887045 [info ] [Thread-2 (]: 4 of 4 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.02s]
[0m17:21:12.887299 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m17:21:12.887504 [debug] [Thread-1 (]: SQL status: OK in 0.488 seconds
[0m17:21:12.888613 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:21:12.888766 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv" rename to "final_currencyconv__dbt_backup"
[0m17:21:12.889010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.890048 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:21:12.890190 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv__dbt_tmp" rename to "final_currencyconv"
[0m17:21:12.890418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.891101 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m17:21:12.891246 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:21:12.891370 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m17:21:12.897677 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m17:21:12.898802 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:21:12.898953 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
drop table if exists "dev"."main"."final_currencyconv__dbt_backup" cascade
[0m17:21:12.899252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:21:12.899777 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: Close
[0m17:21:12.943742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '963a0492-3c65-4923-8de2-27e82b3e3d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edb3d0>]}
[0m17:21:12.944115 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.final_currencyconv ...................... [[32mOK[0m in 0.56s]
[0m17:21:12.944396 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_currencyconv
[0m17:21:12.945169 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:12.945319 [debug] [MainThread]: On master: BEGIN
[0m17:21:12.945440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:12.949657 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:21:12.949821 [debug] [MainThread]: On master: COMMIT
[0m17:21:12.949950 [debug] [MainThread]: Using duckdb connection "master"
[0m17:21:12.950056 [debug] [MainThread]: On master: COMMIT
[0m17:21:12.950229 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:21:12.950344 [debug] [MainThread]: On master: Close
[0m17:21:12.951396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:12.951548 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_currencyconv' was properly closed.
[0m17:21:12.951657 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m17:21:12.951820 [info ] [MainThread]: 
[0m17:21:12.951977 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m17:21:12.952436 [debug] [MainThread]: Command end result
[0m17:21:12.961949 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:21:12.966879 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:21:12.969642 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m17:21:12.969788 [info ] [MainThread]: 
[0m17:21:12.969963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:12.970101 [info ] [MainThread]: 
[0m17:21:12.970279 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:21:12.970568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5215535, "process_in_blocks": "0", "process_kernel_time": 0.581484, "process_mem_max_rss": "1005436928", "process_out_blocks": "0", "process_user_time": 10.422332}
[0m17:21:12.970742 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:12.970700 after 5.52 seconds
[0m17:21:12.970927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b159b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bfda90>]}
[0m17:21:12.971080 [debug] [MainThread]: Flushing usage events
[0m17:21:13.144570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:38.612133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045192b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10615fc50>]}


============================== 17:22:38.614107 | 70ada617-6509-4ae9-bae0-5cbef4ba1175 ==============================
[0m17:22:38.614107 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:22:38.614405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:22:38.705275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106560b00>]}
[0m17:22:38.727433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106236030>]}
[0m17:22:38.728611 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:22:38.777026 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:22:38.818799 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:22:38.819054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ec350>]}
[0m17:22:39.344440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068833e0>]}
[0m17:22:39.377173 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:22:39.377958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:22:39.388454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062da350>]}
[0m17:22:39.388669 [info ] [MainThread]: Found 9 models, 4 seeds, 4 data tests, 424 macros
[0m17:22:39.388829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba60d0>]}
[0m17:22:39.389689 [info ] [MainThread]: 
[0m17:22:39.389852 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:22:39.389974 [info ] [MainThread]: 
[0m17:22:39.390182 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:22:39.392146 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:22:39.418023 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:22:39.418216 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:22:39.418346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:39.423451 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:22:39.424083 [debug] [ThreadPool]: On list_dev: Close
[0m17:22:39.425213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:22:39.425435 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:22:39.428152 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:22:39.428313 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:22:39.428442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:39.432349 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:22:39.432919 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:22:39.433047 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:22:39.433234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:22:39.433344 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:22:39.433453 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:22:39.433647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:22:39.433974 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:22:39.434088 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:22:39.434198 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:22:39.434359 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:22:39.434472 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:22:39.436023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:22:39.438541 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:22:39.438703 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:22:39.438821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:39.442520 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:22:39.442673 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:22:39.442803 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:22:39.457004 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m17:22:39.457628 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:22:39.458409 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:22:39.458549 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:22:39.460586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106977b90>]}
[0m17:22:39.460793 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:39.460913 [debug] [MainThread]: On master: BEGIN
[0m17:22:39.461019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:39.464547 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:22:39.464681 [debug] [MainThread]: On master: COMMIT
[0m17:22:39.464792 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:39.464897 [debug] [MainThread]: On master: COMMIT
[0m17:22:39.465079 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:22:39.465196 [debug] [MainThread]: On master: Close
[0m17:22:39.466466 [debug] [Thread-1 (]: Began running node seed.slash_analytics_take_home.card_events
[0m17:22:39.466634 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.card_transactions
[0m17:22:39.466843 [info ] [Thread-1 (]: 1 of 4 START seed file main.card_events ........................................ [RUN]
[0m17:22:39.467128 [info ] [Thread-2 (]: 2 of 4 START seed file main.card_transactions .................................. [RUN]
[0m17:22:39.467355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now seed.slash_analytics_take_home.card_events)
[0m17:22:39.467555 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.slash_analytics_take_home.card_transactions'
[0m17:22:39.467703 [debug] [Thread-1 (]: Began compiling node seed.slash_analytics_take_home.card_events
[0m17:22:39.467843 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.card_transactions
[0m17:22:39.467987 [debug] [Thread-1 (]: Began executing node seed.slash_analytics_take_home.card_events
[0m17:22:39.468129 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.card_transactions
[0m17:23:04.281522 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m17:23:04.289358 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: BEGIN
[0m17:23:04.295857 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:23:04.333623 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m17:23:04.340099 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m17:23:04.346560 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.card_transactions"} */
truncate table "dev"."main"."card_transactions"
[0m17:23:04.378606 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m17:23:04.398984 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m17:23:04.405462 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: 
          COPY "dev"."main"."card_transactions" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/card_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:23:05.908428 [debug] [Thread-2 (]: SQL status: OK in 1.496 seconds
[0m17:23:06.054408 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.card_transactions"
[0m17:23:06.111623 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: COMMIT
[0m17:23:06.119043 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.card_transactions"
[0m17:23:06.124462 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: COMMIT
[0m17:23:06.188796 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m17:23:06.196644 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.card_transactions: Close
[0m17:23:06.293383 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bae830>]}
[0m17:23:06.300247 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file main.card_transactions .............................. [[32mINSERT 909419[0m in 26.76s]
[0m17:23:06.312964 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.card_transactions
[0m17:23:06.321150 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.currency_conv
[0m17:23:06.321779 [info ] [Thread-2 (]: 3 of 4 START seed file main.currency_conv ...................................... [RUN]
[0m17:23:06.333837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.card_transactions, now seed.slash_analytics_take_home.currency_conv)
[0m17:23:06.340530 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.currency_conv
[0m17:23:06.347288 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.currency_conv
[0m17:23:12.158192 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency_conv"
[0m17:23:12.173038 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: BEGIN
[0m17:23:12.179561 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:23:12.215710 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m17:23:12.222177 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency_conv"
[0m17:23:12.228652 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.currency_conv"} */
truncate table "dev"."main"."currency_conv"
[0m17:23:12.255909 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m17:23:12.263301 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency_conv"
[0m17:23:12.269796 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: 
          COPY "dev"."main"."currency_conv" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/currency_conv.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:23:12.382210 [debug] [Thread-2 (]: SQL status: OK in 0.106 seconds
[0m17:23:12.389083 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.currency_conv"
[0m17:23:12.427075 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: COMMIT
[0m17:23:12.433551 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.currency_conv"
[0m17:23:12.439790 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: COMMIT
[0m17:23:12.470148 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m17:23:12.477020 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.currency_conv: Close
[0m17:23:12.516306 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f1e50>]}
[0m17:23:12.529334 [info ] [Thread-2 (]: 3 of 4 OK loaded seed file main.currency_conv .................................. [[32mINSERT 130685[0m in 6.18s]
[0m17:23:12.541255 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.currency_conv
[0m17:23:12.551189 [debug] [Thread-2 (]: Began running node seed.slash_analytics_take_home.entity
[0m17:23:12.564105 [info ] [Thread-2 (]: 4 of 4 START seed file main.entity ............................................. [RUN]
[0m17:23:12.576332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.slash_analytics_take_home.currency_conv, now seed.slash_analytics_take_home.entity)
[0m17:23:12.582859 [debug] [Thread-2 (]: Began compiling node seed.slash_analytics_take_home.entity
[0m17:23:12.589327 [debug] [Thread-2 (]: Began executing node seed.slash_analytics_take_home.entity
[0m17:23:12.643075 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m17:23:12.649572 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: BEGIN
[0m17:23:12.656037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:23:12.691732 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m17:23:12.698200 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m17:23:12.704466 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.entity"} */
truncate table "dev"."main"."entity"
[0m17:23:12.734588 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m17:23:12.741513 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m17:23:12.747949 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: 
          COPY "dev"."main"."entity" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/entity.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:23:12.815031 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m17:23:12.821391 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.entity"
[0m17:23:12.859669 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: COMMIT
[0m17:23:12.865373 [debug] [Thread-2 (]: Using duckdb connection "seed.slash_analytics_take_home.entity"
[0m17:23:12.871820 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: COMMIT
[0m17:23:12.902042 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m17:23:12.908530 [debug] [Thread-2 (]: On seed.slash_analytics_take_home.entity: Close
[0m17:23:12.947217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb16d0>]}
[0m17:23:12.953652 [info ] [Thread-2 (]: 4 of 4 OK loaded seed file main.entity ......................................... [[32mINSERT 1811[0m in 0.37s]
[0m17:23:12.966481 [debug] [Thread-2 (]: Finished running node seed.slash_analytics_take_home.entity
[0m17:23:29.302894 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m17:23:29.303757 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: BEGIN
[0m17:23:29.303946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:29.311850 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:23:29.312042 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m17:23:29.312201 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "seed.slash_analytics_take_home.card_events"} */
truncate table "dev"."main"."card_events"
[0m17:23:29.337995 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m17:23:29.341629 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m17:23:29.341839 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: 
          COPY "dev"."main"."card_events" FROM '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/seeds/card_events.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m17:23:31.780578 [debug] [Thread-1 (]: SQL status: OK in 2.438 seconds
[0m17:23:31.781719 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.slash_analytics_take_home.card_events"
[0m17:23:31.783592 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: COMMIT
[0m17:23:31.783773 [debug] [Thread-1 (]: Using duckdb connection "seed.slash_analytics_take_home.card_events"
[0m17:23:31.783919 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: COMMIT
[0m17:23:31.861618 [debug] [Thread-1 (]: SQL status: OK in 0.077 seconds
[0m17:23:31.865909 [debug] [Thread-1 (]: On seed.slash_analytics_take_home.card_events: Close
[0m17:23:31.895774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70ada617-6509-4ae9-bae0-5cbef4ba1175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7bc40>]}
[0m17:23:31.899346 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.card_events .................................... [[32mINSERT 3499969[0m in 52.43s]
[0m17:23:31.899703 [debug] [Thread-1 (]: Finished running node seed.slash_analytics_take_home.card_events
[0m17:23:31.915416 [debug] [MainThread]: Using duckdb connection "master"
[0m17:23:31.915619 [debug] [MainThread]: On master: BEGIN
[0m17:23:31.915740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:31.921382 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:23:31.921556 [debug] [MainThread]: On master: COMMIT
[0m17:23:31.921788 [debug] [MainThread]: Using duckdb connection "master"
[0m17:23:31.921938 [debug] [MainThread]: On master: COMMIT
[0m17:23:31.922167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:23:31.922298 [debug] [MainThread]: On master: Close
[0m17:23:31.923318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:31.923460 [debug] [MainThread]: Connection 'seed.slash_analytics_take_home.card_events' was properly closed.
[0m17:23:31.923585 [debug] [MainThread]: Connection 'seed.slash_analytics_take_home.entity' was properly closed.
[0m17:23:31.923801 [info ] [MainThread]: 
[0m17:23:31.924014 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 52.53 seconds (52.53s).
[0m17:23:31.924625 [debug] [MainThread]: Command end result
[0m17:23:32.229926 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:23:32.233746 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:23:32.240088 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m17:23:32.240293 [info ] [MainThread]: 
[0m17:23:32.240893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:32.241040 [info ] [MainThread]: 
[0m17:23:32.241614 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:23:32.242706 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 53.663307, "process_in_blocks": "0", "process_kernel_time": 19.418758, "process_mem_max_rss": "2695725056", "process_out_blocks": "0", "process_user_time": 31.054714}
[0m17:23:32.242985 [debug] [MainThread]: Command `dbt seed` succeeded at 17:23:32.242933 after 53.66 seconds
[0m17:23:32.243319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163e983b0>]}
[0m17:23:32.243502 [debug] [MainThread]: Flushing usage events
[0m17:23:32.493865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:38.496776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104753b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104753c50>]}


============================== 17:23:38.499333 | 0a373ec8-e152-43dc-b21d-765f7e6c57b0 ==============================
[0m17:23:38.499333 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:23:38.499641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select final', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:23:38.614521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104944b00>]}
[0m17:23:38.637032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e2030>]}
[0m17:23:38.638476 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:23:38.688073 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:23:38.754095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:23:38.754296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:23:38.776350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aea750>]}
[0m17:23:38.809529 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:23:38.810348 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:23:38.822134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f3b60>]}
[0m17:23:38.822362 [info ] [MainThread]: Found 9 models, 4 seeds, 4 data tests, 424 macros
[0m17:23:38.822528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c92b0>]}
[0m17:23:38.823331 [info ] [MainThread]: 
[0m17:23:38.823495 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:23:38.823620 [info ] [MainThread]: 
[0m17:23:38.823833 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:23:38.825806 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:23:38.861545 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:23:38.861741 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:23:38.861877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:38.870658 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:23:38.871650 [debug] [ThreadPool]: On list_dev: Close
[0m17:23:38.872770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:23:38.873173 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:23:38.875986 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:23:38.876130 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:23:38.876247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:38.880500 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:23:38.881081 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:23:38.881206 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:23:38.881385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:23:38.881501 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:23:38.881617 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:23:38.881986 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:23:38.882405 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:23:38.882547 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:23:38.882658 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:23:38.882828 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:23:38.882950 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:23:38.884436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:23:38.886756 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:23:38.886896 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:23:38.887011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:38.890543 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:23:38.890682 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:23:38.890819 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:23:38.907838 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m17:23:38.908794 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:23:38.909547 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:23:38.909676 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:23:38.911716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ded710>]}
[0m17:23:38.911920 [debug] [MainThread]: Using duckdb connection "master"
[0m17:23:38.912037 [debug] [MainThread]: On master: BEGIN
[0m17:23:38.912150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:38.915690 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:23:38.915835 [debug] [MainThread]: On master: COMMIT
[0m17:23:38.915959 [debug] [MainThread]: Using duckdb connection "master"
[0m17:23:38.916068 [debug] [MainThread]: On master: COMMIT
[0m17:23:38.916231 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:23:38.916353 [debug] [MainThread]: On master: Close
[0m17:23:38.917573 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m17:23:38.917765 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m17:23:38.917994 [info ] [Thread-2 (]: 2 of 4 START sql table model main.final_cardtransactions ....................... [RUN]
[0m17:23:38.918225 [info ] [Thread-1 (]: 1 of 4 START sql table model main.final_cardevents ............................. [RUN]
[0m17:23:38.918463 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_cardtransactions'
[0m17:23:38.918640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m17:23:38.918799 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m17:23:38.918942 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m17:23:38.922040 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:38.922986 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m17:23:38.923668 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m17:23:38.923858 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m17:23:38.935681 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:38.937018 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:23:38.937191 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m17:23:38.937336 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m17:23:38.937477 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:23:38.937613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:38.941659 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:23:38.941824 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:38.941979 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:23:38.942151 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m17:23:38.942301 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:23:38.942472 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m17:23:38.943113 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:23:38.946865 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:38.947031 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:23:38.947605 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m17:23:38.947939 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:38.948108 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:23:38.948280 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    case 
        when ORIGINAL_CURRENCY_CODE = 'ILR' then 'ILS'
        when ORIGINAL_CURRENCY_CODE = 'ARY' then 'ARS'
        when ORIGINAL_CURRENCY_CODE = 'MXP' then 'MXN'
        when ORIGINAL_CURRENCY_CODE = 'CSJ' then 'CZK'
        when ORIGINAL_CURRENCY_CODE = 'VNC' then 'VND'
        when ORIGINAL_CURRENCY_CODE = 'PES' then 'PEN'
        else ORIGINAL_CURRENCY_CODE
    end as ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    CAST(TIMESTAMP AS DATE) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m17:23:38.948469 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m17:23:39.642703 [debug] [Thread-1 (]: SQL status: OK in 0.694 seconds
[0m17:23:39.645719 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:23:39.645931 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m17:23:39.646545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:23:39.647730 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:23:39.647889 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m17:23:39.648151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:23:39.650398 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:23:39.650572 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m17:23:39.650964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:23:39.656657 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:23:39.656854 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:23:39.657007 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:23:40.074889 [debug] [Thread-2 (]: SQL status: OK in 1.126 seconds
[0m17:23:40.076359 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:40.076542 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions" rename to "final_cardtransactions__dbt_backup"
[0m17:23:40.076895 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:40.078022 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:40.078176 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions__dbt_tmp" rename to "final_cardtransactions"
[0m17:23:40.078441 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:40.079297 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:40.079452 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        CREATE INDEX IF NOT EXISTS idx_card_tx ON "dev"."main"."final_cardtransactions" (transaction_id)
      
[0m17:23:40.079836 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:40.080546 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:23:40.080714 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:40.080857 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:23:42.819549 [debug] [Thread-1 (]: SQL status: OK in 3.162 seconds
[0m17:23:42.826099 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:23:42.826290 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m17:23:43.395482 [debug] [Thread-2 (]: SQL status: OK in 3.314 seconds
[0m17:23:43.396904 [debug] [Thread-1 (]: SQL status: OK in 0.570 seconds
[0m17:23:43.400124 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:23:43.401238 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m17:23:43.401415 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
drop table if exists "dev"."main"."final_cardtransactions__dbt_backup" cascade
[0m17:23:43.409158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb77d0>]}
[0m17:23:43.409475 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 4.48s]
[0m17:23:43.409734 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m17:23:43.409920 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_currencyconv
[0m17:23:43.410192 [info ] [Thread-1 (]: 3 of 4 START sql table model main.final_currencyconv ........................... [RUN]
[0m17:23:43.410442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardevents, now model.slash_analytics_take_home.final_currencyconv)
[0m17:23:43.410616 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_currencyconv
[0m17:23:43.411727 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:23:43.412220 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_currencyconv
[0m17:23:43.415518 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:23:43.416094 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:23:43.417130 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: BEGIN
[0m17:23:43.417423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:43.418028 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:23:43.418660 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:23:43.419051 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */

  
    
    

    create  table
      "dev"."main"."final_currencyconv__dbt_tmp"
  
    as (
      select 
 CAST(conversion_dt AS DATE) as conversion_dt,source_currency,destination_currency,exchange_rate
 from "dev"."main"."currency_conv"
    );
  
  
[0m17:23:44.149489 [debug] [Thread-2 (]: SQL status: OK in 0.747 seconds
[0m17:23:44.150285 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m17:23:44.150601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cea4c0>]}
[0m17:23:44.150929 [info ] [Thread-2 (]: 2 of 4 OK created sql table model main.final_cardtransactions .................. [[32mOK[0m in 5.23s]
[0m17:23:44.151208 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m17:23:44.151386 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_entity
[0m17:23:44.151613 [info ] [Thread-2 (]: 4 of 4 START sql table model main.final_entity ................................. [RUN]
[0m17:23:44.151827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardtransactions, now model.slash_analytics_take_home.final_entity)
[0m17:23:44.151997 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m17:23:44.153123 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m17:23:44.153526 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m17:23:44.154999 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:23:44.155176 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m17:23:44.155377 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:23:44.155754 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.155932 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:23:44.156099 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m17:23:44.156440 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.157104 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m17:23:44.157477 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:23:44.157687 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m17:23:44.162438 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:23:44.163702 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:23:44.163872 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m17:23:44.164187 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.165344 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:23:44.165530 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m17:23:44.165832 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.166678 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:23:44.166861 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m17:23:44.167242 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.167887 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:23:44.168050 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:23:44.168203 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:23:44.169768 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:23:44.170880 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:23:44.171043 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m17:23:44.171362 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.171903 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: Close
[0m17:23:44.172149 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b00e10>]}
[0m17:23:44.172423 [info ] [Thread-2 (]: 4 of 4 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.02s]
[0m17:23:44.172656 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m17:23:44.183412 [debug] [Thread-1 (]: SQL status: OK in 0.764 seconds
[0m17:23:44.184486 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:23:44.184637 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv" rename to "final_currencyconv__dbt_backup"
[0m17:23:44.184903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.185945 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:23:44.186085 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv__dbt_tmp" rename to "final_currencyconv"
[0m17:23:44.186321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.186959 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m17:23:44.187096 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:23:44.187222 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m17:23:44.195959 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:23:44.197043 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:23:44.197192 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
drop table if exists "dev"."main"."final_currencyconv__dbt_backup" cascade
[0m17:23:44.197492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:23:44.198002 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: Close
[0m17:23:44.243006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a373ec8-e152-43dc-b21d-765f7e6c57b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b62d50>]}
[0m17:23:44.243377 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.final_currencyconv ...................... [[32mOK[0m in 0.83s]
[0m17:23:44.243652 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_currencyconv
[0m17:23:44.244284 [debug] [MainThread]: Using duckdb connection "master"
[0m17:23:44.244439 [debug] [MainThread]: On master: BEGIN
[0m17:23:44.244559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:44.248910 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:23:44.249054 [debug] [MainThread]: On master: COMMIT
[0m17:23:44.249170 [debug] [MainThread]: Using duckdb connection "master"
[0m17:23:44.249279 [debug] [MainThread]: On master: COMMIT
[0m17:23:44.249461 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:23:44.249576 [debug] [MainThread]: On master: Close
[0m17:23:44.250691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:44.250858 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_currencyconv' was properly closed.
[0m17:23:44.250972 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m17:23:44.251170 [info ] [MainThread]: 
[0m17:23:44.251362 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m17:23:44.251904 [debug] [MainThread]: Command end result
[0m17:23:44.262026 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:23:44.262809 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:23:44.265543 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m17:23:44.265706 [info ] [MainThread]: 
[0m17:23:44.265875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:44.266026 [info ] [MainThread]: 
[0m17:23:44.266178 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:23:44.266462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.804398, "process_in_blocks": "0", "process_kernel_time": 0.5976, "process_mem_max_rss": "1095614464", "process_out_blocks": "0", "process_user_time": 10.368091}
[0m17:23:44.266636 [debug] [MainThread]: Command `dbt run` succeeded at 17:23:44.266601 after 5.80 seconds
[0m17:23:44.266807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047959b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100816040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034a2930>]}
[0m17:23:44.266955 [debug] [MainThread]: Flushing usage events
[0m17:23:44.434007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:26:54.768456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0bc50>]}


============================== 17:26:54.771169 | 9d1dc5a8-d42c-4dc2-aed0-59904d05c88e ==============================
[0m17:26:54.771169 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:26:54.771481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select final', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:26:54.872621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d1dc5a8-d42c-4dc2-aed0-59904d05c88e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efcb00>]}
[0m17:26:54.895251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d1dc5a8-d42c-4dc2-aed0-59904d05c88e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9a030>]}
[0m17:26:54.896748 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:26:54.945829 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:26:55.012348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:26:55.012665 [debug] [MainThread]: Partial parsing: updated file: slash_analytics_take_home://models/final/final_currencyconv.sql
[0m17:26:55.119373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d1dc5a8-d42c-4dc2-aed0-59904d05c88e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107092c50>]}
[0m17:26:55.151154 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:26:55.151975 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:26:55.163574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d1dc5a8-d42c-4dc2-aed0-59904d05c88e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107116e40>]}
[0m17:26:55.163794 [info ] [MainThread]: Found 9 models, 4 seeds, 4 data tests, 424 macros
[0m17:26:55.163961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1dc5a8-d42c-4dc2-aed0-59904d05c88e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743a510>]}
[0m17:26:55.164730 [info ] [MainThread]: 
[0m17:26:55.164892 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:26:55.165015 [info ] [MainThread]: 
[0m17:26:55.165221 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:26:55.167253 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:26:55.203322 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:26:55.203525 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:26:55.203660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:55.211300 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:26:55.211487 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:26:55.211859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:55.211993 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m17:26:55.212118 [info ] [MainThread]: 
[0m17:26:55.212268 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m17:26:55.212484 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dev.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.2.0/bin/duckdb (PID 47804) by user prashulkumar. See also https://duckdb.org/docs/connect/concurrency
[0m17:26:55.212755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4753052, "process_in_blocks": "0", "process_kernel_time": 0.148668, "process_mem_max_rss": "130924544", "process_out_blocks": "0", "process_user_time": 0.856941}
[0m17:26:55.212936 [debug] [MainThread]: Command `dbt run` failed at 17:26:55.212899 after 0.48 seconds
[0m17:26:55.213096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107770110>]}
[0m17:26:55.213243 [debug] [MainThread]: Flushing usage events
[0m17:26:55.458139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:18.200374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087abb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087abc50>]}


============================== 17:27:18.202835 | cd4bb940-c348-4d04-bbcb-91f5fa497dbb ==============================
[0m17:27:18.202835 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:27:18.203147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:27:18.209939 [info ] [MainThread]: dbt version: 1.9.2
[0m17:27:18.210178 [info ] [MainThread]: python version: 3.13.2
[0m17:27:18.210503 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m17:27:18.210651 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m17:27:18.265470 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m17:27:18.265712 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m17:27:18.265869 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m17:27:18.267313 [info ] [MainThread]: adapter type: duckdb
[0m17:27:18.267501 [info ] [MainThread]: adapter version: 1.9.1
[0m17:27:18.306432 [info ] [MainThread]: Configuration:
[0m17:27:18.306676 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:27:18.306832 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:27:18.306970 [info ] [MainThread]: Required dependencies:
[0m17:27:18.307161 [debug] [MainThread]: Executing "git --help"
[0m17:27:18.316168 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:27:18.316605 [debug] [MainThread]: STDERR: "b''"
[0m17:27:18.316779 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:27:18.316940 [info ] [MainThread]: Connection:
[0m17:27:18.317087 [info ] [MainThread]:   database: dev
[0m17:27:18.317209 [info ] [MainThread]:   schema: main
[0m17:27:18.317382 [info ] [MainThread]:   path: dev.duckdb
[0m17:27:18.317605 [info ] [MainThread]:   config_options: None
[0m17:27:18.317724 [info ] [MainThread]:   extensions: None
[0m17:27:18.317841 [info ] [MainThread]:   settings: {}
[0m17:27:18.317951 [info ] [MainThread]:   external_root: .
[0m17:27:18.318061 [info ] [MainThread]:   use_credential_provider: None
[0m17:27:18.318173 [info ] [MainThread]:   attach: None
[0m17:27:18.318279 [info ] [MainThread]:   filesystems: None
[0m17:27:18.318386 [info ] [MainThread]:   remote: None
[0m17:27:18.318491 [info ] [MainThread]:   plugins: None
[0m17:27:18.318599 [info ] [MainThread]:   disable_transactions: False
[0m17:27:18.318907 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:27:18.364774 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m17:27:18.388124 [debug] [MainThread]: Using duckdb connection "debug"
[0m17:27:18.388308 [debug] [MainThread]: On debug: select 1 as id
[0m17:27:18.388434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:18.394407 [debug] [MainThread]: SQL status: OK in 0.006 seconds
[0m17:27:18.394869 [debug] [MainThread]: On debug: Close
[0m17:27:18.395756 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:27:18.395952 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:27:18.396291 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.22848283, "process_in_blocks": "0", "process_kernel_time": 0.126315, "process_mem_max_rss": "123535360", "process_out_blocks": "0", "process_user_time": 0.6421}
[0m17:27:18.396491 [debug] [MainThread]: Command `dbt debug` succeeded at 17:27:18.396448 after 0.23 seconds
[0m17:27:18.396636 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:27:18.396789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088338a0>]}
[0m17:27:18.396978 [debug] [MainThread]: Flushing usage events
[0m17:27:18.568430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:27.788318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c3c50>]}


============================== 17:27:27.790791 | b33cbd30-d842-4c79-bf7a-a7734b4e1009 ==============================
[0m17:27:27.790791 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:27:27.791098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/prashulkumar/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select final', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:27:27.889200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c4b00>]}
[0m17:27:27.911932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10929a030>]}
[0m17:27:27.913446 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:27:27.964322 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:27:28.027314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:28.027500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:28.050111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10954a750>]}
[0m17:27:28.084439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:27:28.085521 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:27:28.095782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109463b60>]}
[0m17:27:28.096009 [info ] [MainThread]: Found 9 models, 4 seeds, 4 data tests, 424 macros
[0m17:27:28.096176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093292b0>]}
[0m17:27:28.097004 [info ] [MainThread]: 
[0m17:27:28.097179 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m17:27:28.097308 [info ] [MainThread]: 
[0m17:27:28.097537 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:27:28.099508 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m17:27:28.123973 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m17:27:28.124168 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m17:27:28.124298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:28.130350 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m17:27:28.130975 [debug] [ThreadPool]: On list_dev: Close
[0m17:27:28.132074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m17:27:28.132276 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m17:27:28.135027 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:27:28.135183 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m17:27:28.135305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:28.139132 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:27:28.139694 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:27:28.139822 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m17:27:28.139999 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:27:28.140110 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:27:28.140217 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m17:27:28.140406 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:27:28.140732 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:27:28.140854 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m17:27:28.140956 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m17:27:28.141118 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:27:28.141230 [debug] [ThreadPool]: On create_dev_main: Close
[0m17:27:28.142653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m17:27:28.144913 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:27:28.145055 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m17:27:28.145169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:28.149028 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:27:28.149169 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m17:27:28.149294 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m17:27:28.163708 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m17:27:28.164686 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m17:27:28.165489 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m17:27:28.165632 [debug] [ThreadPool]: On list_dev_main: Close
[0m17:27:28.167687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8f1710>]}
[0m17:27:28.167901 [debug] [MainThread]: Using duckdb connection "master"
[0m17:27:28.168033 [debug] [MainThread]: On master: BEGIN
[0m17:27:28.168142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:28.171736 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:27:28.171880 [debug] [MainThread]: On master: COMMIT
[0m17:27:28.172003 [debug] [MainThread]: Using duckdb connection "master"
[0m17:27:28.172117 [debug] [MainThread]: On master: COMMIT
[0m17:27:28.172279 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:27:28.172392 [debug] [MainThread]: On master: Close
[0m17:27:28.173679 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m17:27:28.173871 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m17:27:28.174098 [info ] [Thread-2 (]: 2 of 4 START sql table model main.final_cardtransactions ....................... [RUN]
[0m17:27:28.174348 [info ] [Thread-1 (]: 1 of 4 START sql table model main.final_cardevents ............................. [RUN]
[0m17:27:28.174588 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_cardtransactions'
[0m17:27:28.174749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m17:27:28.174902 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m17:27:28.175040 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m17:27:28.178100 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:28.179035 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.180329 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m17:27:28.192094 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:28.192313 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m17:27:28.192490 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m17:27:28.193902 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.194086 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:27:28.194242 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m17:27:28.194420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:28.198412 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:27:28.198620 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:27:28.198808 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:28.198988 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.199149 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m17:27:28.199304 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m17:27:28.199640 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:28.203441 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:28.203624 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:27:28.204199 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.204687 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:28.204860 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.205032 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
)
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    case 
        when ORIGINAL_CURRENCY_CODE = 'ILR' then 'ILS'
        when ORIGINAL_CURRENCY_CODE = 'ARY' then 'ARS'
        when ORIGINAL_CURRENCY_CODE = 'MXP' then 'MXN'
        when ORIGINAL_CURRENCY_CODE = 'CSJ' then 'CZK'
        when ORIGINAL_CURRENCY_CODE = 'VNC' then 'VND'
        when ORIGINAL_CURRENCY_CODE = 'PES' then 'PEN'
        else ORIGINAL_CURRENCY_CODE
    end as ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    CAST(TIMESTAMP AS DATE) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null
    );
  
  
[0m17:27:28.205216 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m17:27:28.916407 [debug] [Thread-1 (]: SQL status: OK in 0.711 seconds
[0m17:27:28.919444 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.919654 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m17:27:28.920478 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:27:28.921690 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.921872 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m17:27:28.922217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:28.924642 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.924841 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m17:27:28.925239 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:28.930860 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:27:28.931333 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:27:28.931482 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m17:27:29.332252 [debug] [Thread-2 (]: SQL status: OK in 1.127 seconds
[0m17:27:29.334176 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:29.334406 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions" rename to "final_cardtransactions__dbt_backup"
[0m17:27:29.334892 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:29.336130 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:29.336300 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions__dbt_tmp" rename to "final_cardtransactions"
[0m17:27:29.336649 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:29.337581 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:29.337745 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        CREATE INDEX IF NOT EXISTS idx_card_tx ON "dev"."main"."final_cardtransactions" (transaction_id)
      
[0m17:27:29.338113 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:29.338779 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:27:29.338947 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:29.339102 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m17:27:32.660753 [debug] [Thread-1 (]: SQL status: OK in 3.729 seconds
[0m17:27:32.663592 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m17:27:32.663800 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m17:27:33.245556 [debug] [Thread-2 (]: SQL status: OK in 3.906 seconds
[0m17:27:33.246680 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m17:27:33.246865 [debug] [Thread-1 (]: SQL status: OK in 0.583 seconds
[0m17:27:33.247050 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
drop table if exists "dev"."main"."final_cardtransactions__dbt_backup" cascade
[0m17:27:33.248191 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m17:27:33.256111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5c7b90>]}
[0m17:27:33.256412 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 5.07s]
[0m17:27:33.256680 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m17:27:33.256864 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_currencyconv
[0m17:27:33.257145 [info ] [Thread-1 (]: 3 of 4 START sql table model main.final_currencyconv ........................... [RUN]
[0m17:27:33.257389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardevents, now model.slash_analytics_take_home.final_currencyconv)
[0m17:27:33.257563 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_currencyconv
[0m17:27:33.259984 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:27:33.260987 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_currencyconv
[0m17:27:33.266393 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_currencyconv"
[0m17:27:33.266819 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:27:33.266987 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: BEGIN
[0m17:27:33.267134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:33.267768 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:27:33.268191 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:27:33.268558 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */

  
    
    

    create  table
      "dev"."main"."final_currencyconv__dbt_tmp"
  
    as (
      select 
 cast(conversion_dt as date) exchange_rt_dt,source_currency,destination_currency,exchange_rate
 from "dev"."main"."currency_conv"
    );
  
  
[0m17:27:33.880657 [debug] [Thread-2 (]: SQL status: OK in 0.632 seconds
[0m17:27:33.882962 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m17:27:33.883302 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5be570>]}
[0m17:27:33.883636 [info ] [Thread-2 (]: 2 of 4 OK created sql table model main.final_cardtransactions .................. [[32mOK[0m in 5.71s]
[0m17:27:33.884007 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m17:27:33.884212 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_entity
[0m17:27:33.884466 [info ] [Thread-2 (]: 4 of 4 START sql table model main.final_entity ................................. [RUN]
[0m17:27:33.884696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_cardtransactions, now model.slash_analytics_take_home.final_entity)
[0m17:27:33.884861 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m17:27:33.886062 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m17:27:33.886420 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m17:27:33.887937 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:27:33.888115 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m17:27:33.888273 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:27:33.888613 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.888789 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:27:33.888951 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m17:27:33.889260 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.889914 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m17:27:33.890277 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:27:33.890527 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m17:27:33.892074 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:27:33.893297 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:27:33.893478 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m17:27:33.893795 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.894923 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:27:33.895090 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m17:27:33.895377 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.896243 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:27:33.896418 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m17:27:33.896876 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.897586 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:27:33.897766 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:27:33.897918 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m17:27:33.899458 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:27:33.900598 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m17:27:33.900759 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m17:27:33.901115 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.901733 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: Close
[0m17:27:33.902010 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad00e10>]}
[0m17:27:33.902307 [info ] [Thread-2 (]: 4 of 4 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.02s]
[0m17:27:33.902660 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m17:27:33.909674 [debug] [Thread-1 (]: SQL status: OK in 0.641 seconds
[0m17:27:33.910742 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:27:33.910887 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv" rename to "final_currencyconv__dbt_backup"
[0m17:27:33.911151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.912160 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:27:33.912307 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv__dbt_tmp" rename to "final_currencyconv"
[0m17:27:33.912628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.913308 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m17:27:33.913441 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:27:33.913563 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m17:27:33.922840 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:27:33.924010 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m17:27:33.924166 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
drop table if exists "dev"."main"."final_currencyconv__dbt_backup" cascade
[0m17:27:33.924503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:27:33.925066 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_currencyconv: Close
[0m17:27:33.965948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b33cbd30-d842-4c79-bf7a-a7734b4e1009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a46f5d0>]}
[0m17:27:33.966351 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main.final_currencyconv ...................... [[32mOK[0m in 0.71s]
[0m17:27:33.966612 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_currencyconv
[0m17:27:33.967241 [debug] [MainThread]: Using duckdb connection "master"
[0m17:27:33.967395 [debug] [MainThread]: On master: BEGIN
[0m17:27:33.967526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:27:33.971856 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:27:33.972020 [debug] [MainThread]: On master: COMMIT
[0m17:27:33.972142 [debug] [MainThread]: Using duckdb connection "master"
[0m17:27:33.972253 [debug] [MainThread]: On master: COMMIT
[0m17:27:33.972426 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:27:33.972541 [debug] [MainThread]: On master: Close
[0m17:27:33.973572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:33.973732 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_currencyconv' was properly closed.
[0m17:27:33.973940 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_entity' was properly closed.
[0m17:27:33.974133 [info ] [MainThread]: 
[0m17:27:33.974400 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m17:27:33.974989 [debug] [MainThread]: Command end result
[0m17:27:33.984967 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m17:27:33.988075 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m17:27:33.993433 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m17:27:33.993590 [info ] [MainThread]: 
[0m17:27:33.993776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:33.993923 [info ] [MainThread]: 
[0m17:27:33.994078 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:27:33.994372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.237121, "process_in_blocks": "0", "process_kernel_time": 3.52189, "process_mem_max_rss": "1005993984", "process_out_blocks": "0", "process_user_time": 13.551706}
[0m17:27:33.994539 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:33.994507 after 6.24 seconds
[0m17:27:33.994700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092059b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d6040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a7d10>]}
[0m17:27:33.994897 [debug] [MainThread]: Flushing usage events
[0m17:27:34.174761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:15.605144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104192b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285fc50>]}


============================== 18:32:15.607906 | ea891d28-eeb6-482d-a78f-481f0833c4bc ==============================
[0m18:32:15.607906 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:32:15.608257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:32:15.617361 [info ] [MainThread]: dbt version: 1.9.2
[0m18:32:15.617580 [info ] [MainThread]: python version: 3.13.2
[0m18:32:15.618035 [info ] [MainThread]: python path: /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/.venv/bin/python3
[0m18:32:15.618292 [info ] [MainThread]: os info: macOS-15.2-arm64-arm-64bit-Mach-O
[0m18:32:15.752930 [info ] [MainThread]: Using profiles dir at /Users/prashulkumar/.dbt
[0m18:32:15.753185 [info ] [MainThread]: Using profiles.yml file at /Users/prashulkumar/.dbt/profiles.yml
[0m18:32:15.753343 [info ] [MainThread]: Using dbt_project.yml file at /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/dbt_project.yml
[0m18:32:15.756151 [info ] [MainThread]: adapter type: duckdb
[0m18:32:15.756360 [info ] [MainThread]: adapter version: 1.9.1
[0m18:32:15.798110 [info ] [MainThread]: Configuration:
[0m18:32:15.798358 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:32:15.798513 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:32:15.798651 [info ] [MainThread]: Required dependencies:
[0m18:32:15.798853 [debug] [MainThread]: Executing "git --help"
[0m18:32:15.812358 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:32:15.812879 [debug] [MainThread]: STDERR: "b''"
[0m18:32:15.813068 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:32:15.813243 [info ] [MainThread]: Connection:
[0m18:32:15.813418 [info ] [MainThread]:   database: dev
[0m18:32:15.813564 [info ] [MainThread]:   schema: main
[0m18:32:15.813700 [info ] [MainThread]:   path: dev.duckdb
[0m18:32:15.813831 [info ] [MainThread]:   config_options: None
[0m18:32:15.813957 [info ] [MainThread]:   extensions: None
[0m18:32:15.814070 [info ] [MainThread]:   settings: {}
[0m18:32:15.814180 [info ] [MainThread]:   external_root: .
[0m18:32:15.814289 [info ] [MainThread]:   use_credential_provider: None
[0m18:32:15.814397 [info ] [MainThread]:   attach: None
[0m18:32:15.814508 [info ] [MainThread]:   filesystems: None
[0m18:32:15.814613 [info ] [MainThread]:   remote: None
[0m18:32:15.814722 [info ] [MainThread]:   plugins: None
[0m18:32:15.814831 [info ] [MainThread]:   disable_transactions: False
[0m18:32:15.815204 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:32:15.865712 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m18:32:15.896820 [debug] [MainThread]: Using duckdb connection "debug"
[0m18:32:15.897033 [debug] [MainThread]: On debug: select 1 as id
[0m18:32:15.897169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:15.912977 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m18:32:15.913477 [debug] [MainThread]: On debug: Close
[0m18:32:15.915314 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:32:15.915484 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:32:15.915853 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.34753168, "process_in_blocks": "0", "process_kernel_time": 0.193557, "process_mem_max_rss": "122208256", "process_out_blocks": "0", "process_user_time": 0.691253}
[0m18:32:15.916072 [debug] [MainThread]: Command `dbt debug` succeeded at 18:32:15.916019 after 0.35 seconds
[0m18:32:15.916231 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:32:15.916398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c7fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e78a0>]}
[0m18:32:15.916595 [debug] [MainThread]: Flushing usage events
[0m18:32:16.177080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:31.813943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079192b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155fc50>]}


============================== 18:33:31.816899 | 55f82b79-dca0-4a71-a661-c3c1453471bd ==============================
[0m18:33:31.816899 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:33:31.817217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/logs', 'profiles_dir': '/Users/prashulkumar/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select final', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:33:31.983108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111850b00>]}
[0m18:33:32.006746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f2030>]}
[0m18:33:32.008314 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m18:33:32.062237 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:33:32.106820 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:33:32.107079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae8350>]}
[0m18:33:32.666092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c7f3e0>]}
[0m18:33:32.700808 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m18:33:32.701972 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m18:33:32.713766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116d0210>]}
[0m18:33:32.713991 [info ] [MainThread]: Found 9 models, 4 seeds, 4 data tests, 424 macros
[0m18:33:32.714169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c018b0>]}
[0m18:33:32.715024 [info ] [MainThread]: 
[0m18:33:32.715213 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m18:33:32.715358 [info ] [MainThread]: 
[0m18:33:32.715595 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:33:32.717718 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:33:32.753831 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:33:32.754031 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:33:32.754165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:32.773227 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m18:33:32.774227 [debug] [ThreadPool]: On list_dev: Close
[0m18:33:32.775912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:33:32.776123 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:33:32.778968 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:33:32.779117 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:33:32.779236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:32.783777 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:33:32.784391 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:33:32.784522 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:33:32.784704 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:33:32.784822 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:33:32.784943 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:33:32.785550 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:33:32.785912 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:33:32.786036 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:33:32.786141 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:33:32.786304 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:33:32.786423 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:33:32.787913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:33:32.790725 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:33:32.790881 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:33:32.791006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:32.794836 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:33:32.794992 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:33:32.795130 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:33:32.811929 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:33:32.812624 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:33:32.813343 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:33:32.813488 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:33:32.815778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cf3890>]}
[0m18:33:32.815987 [debug] [MainThread]: Using duckdb connection "master"
[0m18:33:32.816110 [debug] [MainThread]: On master: BEGIN
[0m18:33:32.816220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:32.819912 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m18:33:32.820057 [debug] [MainThread]: On master: COMMIT
[0m18:33:32.820179 [debug] [MainThread]: Using duckdb connection "master"
[0m18:33:32.820291 [debug] [MainThread]: On master: COMMIT
[0m18:33:32.820454 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:33:32.820573 [debug] [MainThread]: On master: Close
[0m18:33:32.821842 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_currencyconv
[0m18:33:32.822036 [debug] [Thread-1 (]: Began running node model.slash_analytics_take_home.final_cardevents
[0m18:33:32.822265 [info ] [Thread-2 (]: 2 of 4 START sql table model main.final_currencyconv ........................... [RUN]
[0m18:33:32.822507 [info ] [Thread-1 (]: 1 of 4 START sql table model main.final_cardevents ............................. [RUN]
[0m18:33:32.822748 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.slash_analytics_take_home.final_currencyconv'
[0m18:33:32.822939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.slash_analytics_take_home.final_cardevents)
[0m18:33:32.823142 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_currencyconv
[0m18:33:32.823290 [debug] [Thread-1 (]: Began compiling node model.slash_analytics_take_home.final_cardevents
[0m18:33:32.826492 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_currencyconv"
[0m18:33:32.827437 [debug] [Thread-1 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardevents"
[0m18:33:32.828417 [debug] [Thread-1 (]: Began executing node model.slash_analytics_take_home.final_cardevents
[0m18:33:32.841125 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m18:33:32.841346 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_currencyconv
[0m18:33:32.841516 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: BEGIN
[0m18:33:32.846239 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_currencyconv"
[0m18:33:32.846424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:32.846779 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m18:33:32.846936 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_currencyconv: BEGIN
[0m18:33:32.847072 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:33:32.850803 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:33:32.851072 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m18:33:32.851232 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m18:33:32.851411 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        DROP INDEX IF EXISTS idx_card_events
      
[0m18:33:32.851624 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m18:33:32.852138 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */

  
    
    

    create  table
      "dev"."main"."final_currencyconv__dbt_tmp"
  
    as (
      select 
 cast(conversion_dt as date) exchange_rt_dt,source_currency,destination_currency,exchange_rate
 from "dev"."main"."currency_conv"
    );
  
  
[0m18:33:32.852571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:33:32.853343 [debug] [Thread-1 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardevents"
[0m18:33:32.853908 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m18:33:32.854127 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

  
    
    

    create  table
      "dev"."main"."final_cardevents__dbt_tmp"
  
    as (
      with staging as (
    select * from "dev"."main"."stg_cardevents"
)
select
    slash_account_id,
    card_event_id,
    card_id,
    case 
        when event_type like 'pending%' then
            replace(event_type, 'pending_', '')
        else
            event_type
    end as event_type,
    case
        when card_status like 'pending%' then
            REPLACE(card_status, 'pending_', '')
        ELSE
            card_status
    end as card_status,
    timestamp
from staging
where is_valid = 1
    );
  
  
[0m18:33:32.925411 [debug] [Thread-2 (]: SQL status: OK in 0.073 seconds
[0m18:33:32.929977 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m18:33:32.930678 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv" rename to "final_currencyconv__dbt_backup"
[0m18:33:32.932338 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:33:32.934997 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m18:33:32.935273 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
alter table "dev"."main"."final_currencyconv__dbt_tmp" rename to "final_currencyconv"
[0m18:33:32.936161 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:32.950241 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m18:33:32.950577 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m18:33:32.950804 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_currencyconv: COMMIT
[0m18:33:32.962954 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m18:33:32.969071 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_currencyconv"
[0m18:33:32.969377 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_currencyconv: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_currencyconv"} */
drop table if exists "dev"."main"."final_currencyconv__dbt_backup" cascade
[0m18:33:32.969929 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:32.971277 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_currencyconv: Close
[0m18:33:32.972861 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fb3e30>]}
[0m18:33:32.973202 [info ] [Thread-2 (]: 2 of 4 OK created sql table model main.final_currencyconv ...................... [[32mOK[0m in 0.15s]
[0m18:33:32.973459 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_currencyconv
[0m18:33:32.973638 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_entity
[0m18:33:32.973823 [info ] [Thread-2 (]: 3 of 4 START sql table model main.final_entity ................................. [RUN]
[0m18:33:32.974012 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_currencyconv, now model.slash_analytics_take_home.final_entity)
[0m18:33:32.974171 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_entity
[0m18:33:32.975283 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_entity"
[0m18:33:32.977202 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_entity
[0m18:33:32.982280 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m18:33:32.983052 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: BEGIN
[0m18:33:32.983728 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:32.985816 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:33:32.986081 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m18:33:32.986260 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        DROP INDEX IF EXISTS idx_entity_subaccount
      
[0m18:33:32.986624 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:32.987321 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_entity"
[0m18:33:32.987770 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m18:33:32.987961 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

  
    
    

    create  table
      "dev"."main"."final_entity__dbt_tmp"
  
    as (
      WITH cleaned_entity AS (
    SELECT 
        entity_id, 
        subaccount_id, 
        account_creation_date
    FROM "dev"."main"."stg_entity"
    WHERE is_valid = 1
)
SELECT * FROM cleaned_entity
    );
  
  
[0m18:33:32.990279 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:33:32.994589 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m18:33:32.995174 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity" rename to "final_entity__dbt_backup"
[0m18:33:32.996022 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:32.998412 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m18:33:32.998951 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
alter table "dev"."main"."final_entity__dbt_tmp" rename to "final_entity"
[0m18:33:33.000222 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:33.002143 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m18:33:33.002428 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */

        CREATE INDEX IF NOT EXISTS idx_entity_subaccount ON "dev"."main"."final_entity" (entity_id, subaccount_id)
      
[0m18:33:33.003020 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:33.004370 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m18:33:33.004542 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m18:33:33.004757 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: COMMIT
[0m18:33:33.007823 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:33:33.011245 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_entity"
[0m18:33:33.011763 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_entity"} */
drop table if exists "dev"."main"."final_entity__dbt_backup" cascade
[0m18:33:33.012562 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:33.013255 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_entity: Close
[0m18:33:33.013537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e2df0>]}
[0m18:33:33.013949 [info ] [Thread-2 (]: 3 of 4 OK created sql table model main.final_entity ............................ [[32mOK[0m in 0.04s]
[0m18:33:33.014291 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_entity
[0m18:33:33.014534 [debug] [Thread-2 (]: Began running node model.slash_analytics_take_home.final_cardtransactions
[0m18:33:33.014802 [info ] [Thread-2 (]: 4 of 4 START sql table model main.final_cardtransactions ....................... [RUN]
[0m18:33:33.015059 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.slash_analytics_take_home.final_entity, now model.slash_analytics_take_home.final_cardtransactions)
[0m18:33:33.015281 [debug] [Thread-2 (]: Began compiling node model.slash_analytics_take_home.final_cardtransactions
[0m18:33:33.017668 [debug] [Thread-2 (]: Writing injected SQL for node "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:33.018389 [debug] [Thread-2 (]: Began executing node model.slash_analytics_take_home.final_cardtransactions
[0m18:33:33.028550 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:33.029713 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: BEGIN
[0m18:33:33.030152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:33:33.031034 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:33:33.031419 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:33.031843 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        DROP INDEX IF EXISTS idx_card_tx
      
[0m18:33:33.032731 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:33.034231 [debug] [Thread-2 (]: Writing runtime sql for node "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:33.036577 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:33.037201 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

  
    
    

    create  table
      "dev"."main"."final_cardtransactions__dbt_tmp"
  
    as (
      with cleaned_data as (
    select *
    from "dev"."main"."stg_cardtransactions"
    where is_valid = 1
),
final_data as (
select 
    TRANSACTION_ID,
    SUBACCOUNT_ID,
    CARD_ID,
    ACCOUNT_TYPE,
    TRANSACTION_AMOUNT,
    case 
        when ORIGINAL_CURRENCY_CODE = 'ILR' then 'ILS'
        when ORIGINAL_CURRENCY_CODE = 'ARY' then 'ARS'
        when ORIGINAL_CURRENCY_CODE = 'MXP' then 'MXN'
        when ORIGINAL_CURRENCY_CODE = 'CSJ' then 'CZK'
        when ORIGINAL_CURRENCY_CODE = 'VNC' then 'VND'
        when ORIGINAL_CURRENCY_CODE = 'PES' then 'PEN'
        else ORIGINAL_CURRENCY_CODE
    end as ORIGINAL_CURRENCY_CODE,
    MERCHANT_DESCRIPTION,
    MERCHANT_CATEGORY_CODE,
    MERCHANT_COUNTRY,
    TIMESTAMP,
    CAST(TIMESTAMP AS DATE) as exchange_rt_dt,
from cleaned_data
where TRANSACTION_AMOUNT is not null)
select fd.*,fd.TRANSACTION_AMOUNT/ fc.exchange_rate as final_amount
from final_data fd left join "dev"."main"."final_currencyconv" fc
on fd.ORIGINAL_CURRENCY_CODE = fc.destination_currency and fd.exchange_rt_dt = fc.exchange_rt_dt
    );
  
  
[0m18:33:33.813276 [debug] [Thread-1 (]: SQL status: OK in 0.958 seconds
[0m18:33:33.823277 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m18:33:33.823661 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents" rename to "final_cardevents__dbt_backup"
[0m18:33:33.824294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:33.826800 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m18:33:33.827028 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
alter table "dev"."main"."final_cardevents__dbt_tmp" rename to "final_cardevents"
[0m18:33:33.827394 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:33.829890 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m18:33:33.830161 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */

        CREATE INDEX IF NOT EXISTS idx_card_events ON "dev"."main"."final_cardevents" (card_event_id)
      
[0m18:33:33.830842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:33:33.832665 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m18:33:33.833379 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m18:33:33.834046 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: COMMIT
[0m18:33:34.188264 [debug] [Thread-2 (]: SQL status: OK in 1.151 seconds
[0m18:33:34.190314 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:34.190515 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions" rename to "final_cardtransactions__dbt_backup"
[0m18:33:34.190883 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:34.192208 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:34.192382 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
alter table "dev"."main"."final_cardtransactions__dbt_tmp" rename to "final_cardtransactions"
[0m18:33:34.192723 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:34.193759 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:34.193921 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */

        CREATE INDEX IF NOT EXISTS idx_card_tx ON "dev"."main"."final_cardtransactions" (transaction_id)
      
[0m18:33:34.194342 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:33:34.195142 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m18:33:34.195295 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:34.195435 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: COMMIT
[0m18:33:37.424970 [debug] [Thread-1 (]: SQL status: OK in 3.588 seconds
[0m18:33:37.428743 [debug] [Thread-1 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardevents"
[0m18:33:37.429104 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardevents"} */
drop table if exists "dev"."main"."final_cardevents__dbt_backup" cascade
[0m18:33:38.010163 [debug] [Thread-2 (]: SQL status: OK in 3.814 seconds
[0m18:33:38.012046 [debug] [Thread-2 (]: Using duckdb connection "model.slash_analytics_take_home.final_cardtransactions"
[0m18:33:38.012263 [debug] [Thread-1 (]: SQL status: OK in 0.583 seconds
[0m18:33:38.012661 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "slash_analytics_take_home", "target_name": "dev", "node_id": "model.slash_analytics_take_home.final_cardtransactions"} */
drop table if exists "dev"."main"."final_cardtransactions__dbt_backup" cascade
[0m18:33:38.014067 [debug] [Thread-1 (]: On model.slash_analytics_take_home.final_cardevents: Close
[0m18:33:38.014888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122acfd0>]}
[0m18:33:38.015443 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.final_cardevents ........................ [[32mOK[0m in 5.19s]
[0m18:33:38.015743 [debug] [Thread-1 (]: Finished running node model.slash_analytics_take_home.final_cardevents
[0m18:33:38.755691 [debug] [Thread-2 (]: SQL status: OK in 0.741 seconds
[0m18:33:38.756787 [debug] [Thread-2 (]: On model.slash_analytics_take_home.final_cardtransactions: Close
[0m18:33:38.787443 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f82b79-dca0-4a71-a661-c3c1453471bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e825f0>]}
[0m18:33:38.787866 [info ] [Thread-2 (]: 4 of 4 OK created sql table model main.final_cardtransactions .................. [[32mOK[0m in 5.77s]
[0m18:33:38.788159 [debug] [Thread-2 (]: Finished running node model.slash_analytics_take_home.final_cardtransactions
[0m18:33:38.789308 [debug] [MainThread]: Using duckdb connection "master"
[0m18:33:38.789454 [debug] [MainThread]: On master: BEGIN
[0m18:33:38.789575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:38.794521 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m18:33:38.794704 [debug] [MainThread]: On master: COMMIT
[0m18:33:38.794835 [debug] [MainThread]: Using duckdb connection "master"
[0m18:33:38.794951 [debug] [MainThread]: On master: COMMIT
[0m18:33:38.795145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:33:38.795278 [debug] [MainThread]: On master: Close
[0m18:33:38.796344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:38.796479 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_cardevents' was properly closed.
[0m18:33:38.796589 [debug] [MainThread]: Connection 'model.slash_analytics_take_home.final_cardtransactions' was properly closed.
[0m18:33:38.796822 [info ] [MainThread]: 
[0m18:33:38.797002 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m18:33:38.797462 [debug] [MainThread]: Command end result
[0m18:33:38.809781 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/manifest.json
[0m18:33:38.811668 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/semantic_manifest.json
[0m18:33:38.815050 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/prashulkumar/Documents/Docs/Interview docs/Slash_takehome/slash-analytics-take-home/target/run_results.json
[0m18:33:38.815217 [info ] [MainThread]: 
[0m18:33:38.815409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:38.815547 [info ] [MainThread]: 
[0m18:33:38.815706 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:33:38.816183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.036938, "process_in_blocks": "0", "process_kernel_time": 0.894187, "process_mem_max_rss": "682983424", "process_out_blocks": "0", "process_user_time": 15.915838}
[0m18:33:38.816405 [debug] [MainThread]: Command `dbt run` succeeded at 18:33:38.816367 after 7.04 seconds
[0m18:33:38.816675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e36210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111573fb0>]}
[0m18:33:38.816845 [debug] [MainThread]: Flushing usage events
[0m18:33:39.055411 [debug] [MainThread]: An error was encountered while trying to flush usage events
